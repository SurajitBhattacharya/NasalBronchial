---
title: "InfantAdult."
output:
html_document: default
pdf_document: default
---
  
# 1. Invoking libraries and setting up the environment
```{r setup, include=TRUE} 
library(Seurat)
library(scales)
library(tidyverse)
library(cowplot)
library(sctransform)
library(pheatmap)
library(SeuratDisk)
library(leiden)
#library(slingshot)
#library(CellChat)
library(fgsea)
library(clusterProfiler)
library(scales)
library(viridis)
library(NMF)
library(circlize)
library(SCENIC)
library(sctransform)
library(ComplexHeatmap)
library(CellChat)
#library(sctransform)
 #library(DoubletFinder)
#library(logr)
#"CRCT1"
options(future.globals.maxSize= 8912896000)
```
```{r annotating.Funs} 
YoshidaBasalMarkers <- function(SeuratObj, Age_Range, outPath, res, pasfname){
    outPath <- outPath; pasfname <- pasfname; Age_Range <- Age_Range; res = res
    YoshidaBasalMarkers <- c("KRT5", "KRT15", "DLK2", "DAPL1", "NOTCH1", "MKI67", "TOP2A", "KRT6A", "KRT13")
    DefaultAssay(SeuratObj) <- "RNA"
    res1 <- paste("RNA_snn_res.", res, sep = "")
    Idents(SeuratObj) <- res1
    'for(ii in 1:length(YoshidaBasalMarkers)){
        print("Violin Plot")
        VPfname <- paste(pasfname, ".VP.YoshidaBasalMarkers.", YoshidaBasalMarkers[ii], ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
        #VPfname <- paste(pasfname, ".VP.YoshidaBasalMarkers.", YoshidaBasalMarkers[ii], ".res1_clusters.pdf", sep = "")
        pdf(file.path(outPath, VPfname), width = 11, height = 10)
        vln1 <- VlnPlot(SeuratObj, features = YoshidaBasalMarkers[ii], assay = "RNA", group.by = res1)
        #vln1 <- VlnPlot(SeuratObj, features = YoshidaBasalMarkers[ii], assay = "RNA", group.by = "res1")
        print(vln1)
        dev.off()
        print("Feature Plot")
        FPfname <- paste(pasfname, ".FP.YoshidaBasalMarkers.", YoshidaBasalMarkers[ii], ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
        #FPfname <- paste(pasfname, ".FP.YoshidaBasalMarkers.", YoshidaBasalMarkers[ii], ".res1_clusters.pdf", sep = "")
        pdf(file.path(outPath, FPfname), width = 11, height = 10)
        FP2 <- FeaturePlot(SeuratObj, features = YoshidaBasalMarkers[ii])
        print(FP2)
        dev.off()
    }'
    print("Yoshida_Basal")
    DPfname <- paste(pasfname, ".DP.YoshidaBasalMarkers", ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
    #DPfname <- paste(pasfname, ".DP.YoshidaBasalMarkers_clusters.res1.png", sep = "")
    pdf(file.path(outPath, DPfname), width = 22, height = 18)
    #YoshidaMarkers <- c(mitoticBasal1, mitoticBasal2)
    #DP <- DotPlot(SeuratObj, features = YoshidaMarkers, cols = c("blue", "red"), dot.scale = 8) + RotatedAxis()
    DP <- DotPlot(SeuratObj, features = YoshidaBasalMarkers, cols = c("blue", "red"), dot.scale = 25, assay = "RNA", group.by = res1) + RotatedAxis()
    #DP <- DotPlot(SeuratObj, features = YoshidaBasalMarkers, cols = c("blue", "red"), dot.scale = 25, assay = "RNA", group.by = "integrated_snn_res.0.9") + RotatedAxis()
    print(DP)
    dev.off()
    
}

YoshidaSecGobMarkers <- function(SeuratObj,Age_Range, outPath, res, pasfname){
    'Sec1 <- c("SERPINB3", "RARres0.3", "KRT8", "PIGR", "FGFR3", "ANPEP")
    Sec2 <- c("PI3", "KRT24", "KRT13", "BPIFA1", "SERPINB11", "SCGB1A1")'
    #outPath<- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida"
    outPath <- outPath; pasfname <- pasfname; Age_Range <- Age_Range; res = res
    YoshidaSecGobMarkers <- c("CAPN13", "RARRES1", "SCGB3A1", "SCGB1A1", "MUC5AC", "TFF1", "BPIFA2", "PLAU")
    DefaultAssay(SeuratObj) <- "RNA"
    res1 <- paste("RNA_snn_res.", res, sep = "")
    Idents(SeuratObj) <- res1
    'for(ii in 1:length(YoshidaSecGobMarkers)){
        print("Violin Plot")
        VPfname <- paste(pasfname, ".VP.YoshidaSecGobMarkers.", YoshidaSecGobMarkers[ii], ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
        #VPfname <- paste(pasfname, ".VP.YoshidaSecGobMarkers.", YoshidaSecGobMarkers[ii], ".res1_clusters.pdf", sep = "")
        pdf(file.path(outPath, VPfname), width = 11, height = 10)
        vln1 <- VlnPlot(SeuratObj, features = YoshidaSecGobMarkers[ii], assay = "RNA", group.by = res1)
        #vln1 <- VlnPlot(SeuratObj, features = YoshidaSecGobMarkers[ii], assay = "RNA", group.by = "res1")
        print(vln1)
        dev.off()
        print("Feature Plot")
        FPfname <- paste(pasfname, ".FP.YoshidaSecGobMarkers.", YoshidaSecGobMarkers[ii], ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
        #FPfname <- paste(pasfname, ".FP.YoshidaSecGobMarkers.", YoshidaSecGobMarkers[ii], ".res1_clusters.pdf", sep = "")
        pdf(file.path(outPath, FPfname), width = 11, height = 10)
        FP2 <- FeaturePlot(SeuratObj, features = YoshidaSecGobMarkers[ii])
        print(FP2)
        dev.off()
    }'
    print("Yoshida_SecGob")
    DPfname <- paste(pasfname, ".DP.YoshidaSecGobMarkers", ".", Age_Range, ".", res, "_clusters.mod.pdf", sep = "")
    #DPfname <- paste(pasfname, ".DP.YoshidaSecGobMarkers_clusters.res1.png", sep = "")
    pdf(file.path(outPath, DPfname), width = 22, height = 18)
    #YoshidaMarkers <- c(mitoticBasal1, mitoticBasal2)
    #DP <- DotPlot(SeuratObj, features = YoshidaMarkers, cols = c("blue", "red"), dot.scale = 8) + RotatedAxis()
    DP <- DotPlot(SeuratObj, features = YoshidaSecGobMarkers, cols = c("blue", "red"), dot.scale = 25, assay = "RNA", group.by = res1) + RotatedAxis()
    #DP <- DotPlot(SeuratObj, features = YoshidaSecGobMarkers, cols = c("blue", "red"), dot.scale = 25, assay = "RNA", group.by = "integrated_snn_res.0.9") + RotatedAxis()
    print(DP)
    dev.off()
    
}

YoshidaCilMarkers <- function(SeuratObj,Age_Range, outPath, res, pasfname){
    'Sec1 <- c("SERPINB3", "RARres0.3", "KRT8", "PIGR", "FGFR3", "ANPEP")
    Sec2 <- c("PI3", "KRT24", "KRT13", "BPIFA1", "SERPINB11", "SCGB1A1")'
    #outPath<- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida"
    outPath <- outPath; pasfname <- pasfname; Age_Range <- Age_Range; res = res
    YoshidaCilMarkers <- c("DEUP1", "FOXN4", "CDC20B", "PIFO","OMG", "CFAP54", "CCDC40")
    DefaultAssay(SeuratObj) <- "RNA"
    res1 <- paste("RNA_snn_res.", res, sep = "")
    Idents(SeuratObj) <- res1
    'for(ii in 1:length(YoshidaCilMarkers)){
        print("Violin Plot")
        VPfname <- paste(pasfname, ".VP.YoshidaCilMarkers.", YoshidaCilMarkers[ii], ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
        #VPfname <- paste(pasfname, ".VP.YoshidaCilMarkers.", YoshidaCilMarkers[ii], ".res1_clusters.pdf", sep = "")
        pdf(file.path(outPath, VPfname), width = 11, height = 10)
        vln1 <- VlnPlot(SeuratObj, features = YoshidaCilMarkers[ii], assay = "RNA", group.by = res1)
        #vln1 <- VlnPlot(SeuratObj, features = YoshidaCilMarkers[ii], assay = "RNA", group.by = "res1")
        print(vln1)
        dev.off()
        print("Feature Plot")
        FPfname <- paste(pasfname, ".FP.YoshidaCilMarkers.", YoshidaCilMarkers[ii], ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
        #FPfname <- paste(pasfname, ".FP.YoshidaCilMarkers.", YoshidaCilMarkers[ii], ".res1_clusters.pdf", sep = "")
        pdf(file.path(outPath, FPfname), width = 11, height = 10)
        FP2 <- FeaturePlot(SeuratObj, features = YoshidaCilMarkers[ii])
        print(FP2)
        dev.off()
    }'
    print("Yoshida_Ciliated")
    DPfname <- paste(pasfname, ".DP.YoshidaCilMarkers", ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
    #DPfname <- paste(pasfname, ".DP.YoshidaCilMarkers_clusters.res1.png", sep = "")
    pdf(file.path(outPath, DPfname), width = 22, height = 18)
    #YoshidaMarkers <- c(mitoticBasal1, mitoticBasal2)
    #DP <- DotPlot(SeuratObj, features = YoshidaMarkers, cols = c("blue", "red"), dot.scale = 8) + RotatedAxis()
    DP <- DotPlot(SeuratObj, features = YoshidaCilMarkers, cols = c("blue", "red"), dot.scale = 25, assay = "RNA", group.by = res1) + RotatedAxis()
    #DP <- DotPlot(SeuratObj, features = YoshidaCilMarkers, cols = c("blue", "red"), dot.scale = 25, assay = "RNA", group.by = "integrated_snn_res.0.9") + RotatedAxis()
    print(DP)
    dev.off()
}

YoshidaRareMarkers <- function(SeuratObj,Age_Range, outPath, res, pasfname){
    'Sec1 <- c("SERPINB3", "RARres0.3", "KRT8", "PIGR", "FGFR3", "ANPEP")
    Sec2 <- c("PI3", "KRT24", "KRT13", "BPIFA1", "SERPINB11", "SCGB1A1")'
    #outPath<- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida"
    outPath <- outPath; pasfname <- pasfname; Age_Range <- Age_Range; res = res
    YoshidaRareMarkers <- c("FOXI1", "ASCL3", "BMX", "RGS13", "BEX1", "PCSK1N", "PMEL")
    DefaultAssay(SeuratObj) <- "RNA"
    res1 <- paste("RNA_snn_res.", res, sep = "")
    Idents(SeuratObj) <- res1
    'for(ii in 1:length(YoshidaRareMarkers)){
        print("Violin Plot")
        VPfname <- paste(pasfname, ".VP.YoshidaRareMarkers.", YoshidaRareMarkers[ii], ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
        #VPfname <- paste(pasfname, ".VP.YoshidaRareMarkers.", YoshidaRareMarkers[ii], ".res1_clusters.pdf", sep = "")
        pdf(file.path(outPath, VPfname), width = 11, height = 10)
        vln1 <- VlnPlot(SeuratObj, features = YoshidaRareMarkers[ii], assay = "RNA", group.by = res1)
        #vln1 <- VlnPlot(SeuratObj, features = YoshidaRareMarkers[ii], assay = "RNA", group.by = "res1")
        print(vln1)
        dev.off()
        print("Feature Plot")
        FPfname <- paste(pasfname, ".FP.YoshidaRareMarkers.", YoshidaRareMarkers[ii], ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
        #FPfname <- paste(pasfname, ".FP.YoshidaRareMarkers.", YoshidaRareMarkers[ii], ".res1_clusters.pdf", sep = "")
        pdf(file.path(outPath, FPfname), width = 11, height = 10)
        FP2 <- FeaturePlot(SeuratObj, features = YoshidaRareMarkers[ii])
        print(FP2)
        dev.off()
    }'
    print("Yoshida_RareMarkers")
    DPfname <- paste(pasfname, ".DP.YoshidaRareMarkers", ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
    #DPfname <- paste(pasfname, ".DP.YoshidaRareMarkers_clusters.res1.png", sep = "")
    pdf(file.path(outPath, DPfname), width = 22, height = 18)
    #YoshidaMarkers <- c(mitoticBasal1, mitoticBasal2)
    #DP <- DotPlot(SeuratObj, features = YoshidaMarkers, cols = c("blue", "red"), dot.scale = 8) + RotatedAxis()
    DP <- DotPlot(SeuratObj, features = YoshidaRareMarkers, cols = c("blue", "red"), dot.scale = 25, assay = "RNA", group.by = res1) + RotatedAxis()
    #DP <- DotPlot(SeuratObj, features = YoshidaRareMarkers, cols = c("blue", "red"), dot.scale = 25, assay = "RNA", group.by = "integrated_snn_res.0.9") + RotatedAxis()
    print(DP)
    dev.off()
}
YoshidaTransEpiMarkers <- function(SeuratObj,Age_Range, outPath, res, pasfname){
    'Sec1 <- c("SERPINB3", "RARres0.3", "KRT8", "PIGR", "FGFR3", "ANPEP")
    Sec2 <- c("PI3", "KRT24", "KRT13", "BPIFA1", "SERPINB11", "SCGB1A1")'
    #outPath<- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida"
    outPath <- outPath; pasfname <- pasfname; Age_Range <- Age_Range; res = res
    YoshidaTransEpiMarkers <- c("FP671120.4", "FP236383.2", "HIST1H1E")
    DefaultAssay(SeuratObj) <- "RNA"
    res1 <- paste("RNA_snn_res.", res, sep = "")
    Idents(SeuratObj) <- res1
    'for(ii in 1:length(YoshidaTransEpiMarkers)){
        print("Violin Plot")
        VPfname <- paste(pasfname, ".VP.YoshidaTransEpiMarkers.", YoshidaTransEpiMarkers[ii], ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
        #VPfname <- paste(pasfname, ".VP.YoshidaTransEpiMarkers.", YoshidaTransEpiMarkers[ii], ".res1_clusters.pdf", sep = "")
        pdf(file.path(outPath, VPfname), width = 11, height = 10)
        vln1 <- VlnPlot(SeuratObj, features = YoshidaTransEpiMarkers[ii], assay = "RNA", group.by = res1)
        #vln1 <- VlnPlot(SeuratObj, features = YoshidaTransEpiMarkers[ii], assay = "RNA", group.by = "res1")
        print(vln1)
        dev.off()
        print("Feature Plot")
        FPfname <- paste(pasfname, ".FP.YoshidaTransEpiMarkers.", YoshidaTransEpiMarkers[ii], ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
        #FPfname <- paste(pasfname, ".FP.YoshidaTransEpiMarkers.", YoshidaTransEpiMarkers[ii], ".res1_clusters.pdf", sep = "")
        pdf(file.path(outPath, FPfname), width = 11, height = 10)
        FP2 <- FeaturePlot(SeuratObj, features = YoshidaTransEpiMarkers[ii])
        print(FP2)
        dev.off()
    }'
    print("Yoshida_TransEpi")
    DPfname <- paste(pasfname, ".DP.YoshidaTransEpiMarkers", ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
    #DPfname <- paste(pasfname, ".DP.YoshidaTransEpiMarkers_clusters.res1.png", sep = "")
    pdf(file.path(outPath, DPfname), width = 22, height = 18)
    #YoshidaMarkers <- c(mitoticBasal1, mitoticBasal2)
    #DP <- DotPlot(SeuratObj, features = YoshidaMarkers, cols = c("blue", "red"), dot.scale = 8) + RotatedAxis()
    DP <- DotPlot(SeuratObj, features = YoshidaTransEpiMarkers, cols = c("blue", "red"), dot.scale = 25, assay = "RNA", group.by = res1) + RotatedAxis()
    #DP <- DotPlot(SeuratObj, features = YoshidaTransEpiMarkers, cols = c("blue", "red"), dot.scale = 25, assay = "RNA", group.by = "integrated_snn_res.0.9") + RotatedAxis()
    print(DP)
    dev.off()
}
YoshidaImmuneMarkers.BCells <- function(SeuratObj,Age_Range, outPath, res, pasfname){
    'Sec1 <- c("SERPINB3", "RARres0.3", "KRT8", "PIGR", "FGFR3", "ANPEP")
    Sec2 <- c("PI3", "KRT24", "KRT13", "BPIFA1", "SERPINB11", "SCGB1A1")'
    #outPath<- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida"
    outPath <- outPath; pasfname <- pasfname; Age_Range <- Age_Range; res = res
    #YoshidaImmuneMarkers <- c("CD3D", "CCR7", "LEF1", "CD4", "FOXP3", "CTLA4", "CCR4", "FRMD4B", "CD40LG", "CD8A", "DBN1", "HELB", "GZMK", "EOMES", "TRGV2", "TRDV1", "GNLY", "NCAM1", "TBX21", "KLRF1", "KRT81", "PCDH9",  )
    YoshidaImmuneMarkers <- c("MS4A1",  "MKI67", "MCM2", "FCER2", "COL19A1", "CD27", "FCRL5", "FCRL4", "FCRL3", "CAMK1")
    DefaultAssay(SeuratObj) <- "RNA"
    res1 <- paste("RNA_snn_res.", res, sep = "")
    Idents(SeuratObj) <- res1
    'for(ii in 1:length(YoshidaImmuneMarkers)){
        print("Violin Plot")
        VPfname <- paste(pasfname, ".VP.YoshidaImmuneMarkers_BCells.", YoshidaImmuneMarkers[ii], ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
        #VPfname <- paste(pasfname, ".VP.YoshidaImmuneMarkers.", YoshidaImmuneMarkers[ii], ".res1_clusters.pdf", sep = "")
        pdf(file.path(outPath, VPfname), width = 11, height = 10)
        vln1 <- VlnPlot(SeuratObj, features = YoshidaImmuneMarkers[ii], assay = "RNA", group.by = res1)
        #vln1 <- VlnPlot(SeuratObj, features = YoshidaImmuneMarkers[ii], assay = "RNA", group.by = "res1")
        print(vln1)
        dev.off()
        print("Feature Plot")
        FPfname <- paste(pasfname, ".FP.YoshidaImmuneMarkers_Cells.", YoshidaImmuneMarkers[ii], ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
        #FPfname <- paste(pasfname, ".FP.YoshidaImmuneMarkers.", YoshidaImmuneMarkers[ii], ".res1_clusters.pdf", sep = "")
        pdf(file.path(outPath, FPfname), width = 11, height = 10)
        FP2 <- FeaturePlot(SeuratObj, features = YoshidaImmuneMarkers[ii])
        print(FP2)
        dev.off()
    }'
    print("Yoshida_BCells")
    DPfname <- paste(pasfname, ".DP.YoshidaImmuneMarkers_BCells", ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
    #DPfname <- paste(pasfname, ".DP.YoshidaImmuneMarkers_clusters.res1.png", sep = "")
    pdf(file.path(outPath, DPfname), width = 22, height = 18)
    #YoshidaMarkers <- c(mitoticBasal1, mitoticBasal2)
    #DP <- DotPlot(SeuratObj, features = YoshidaMarkers, cols = c("blue", "red"), dot.scale = 8) + RotatedAxis()
    DP <- DotPlot(SeuratObj, features = YoshidaImmuneMarkers, cols = c("blue", "red"), dot.scale = 25, assay = "RNA", group.by = res1) + RotatedAxis()
    #DP <- DotPlot(SeuratObj, features = YoshidaImmuneMarkers, cols = c("blue", "red"), dot.scale = 25, assay = "RNA", group.by = "integrated_snn_res.0.9") + RotatedAxis()
    print(DP)
    dev.off()
}

YoshidaImmuneMarkers.TCells <- function(SeuratObj,Age_Range, outPath, res, pasfname){
    'Sec1 <- c("SERPINB3", "RARres0.3", "KRT8", "PIGR", "FGFR3", "ANPEP")
    Sec2 <- c("PI3", "KRT24", "KRT13", "BPIFA1", "SERPINB11", "SCGB1A1")'
    #outPath<- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida"
    outPath <- outPath; pasfname <- pasfname; Age_Range <- Age_Range; res = res
    YoshidaImmuneMarkers <- c("CD3D", "CCR7", "LEF1", "CD4", "FOXP3", "CTLA4", "CCR4", "FRMD4B", "CD40LG", "CD8A", "DBN1", "HELB", "GZMK", "EOMES", "TRGV2", "TRDV1", "GNLY", "NCAM1", "TBX21", "KLRF1", "KRT81", "PCDH9")
    #YoshidaImmuneMarkers <- c("MS4A1",  "MKI67", "MCM2", "FCER2", "COL19A1", "CD27", "FCRL5", "FCRL4", "FCRL3", "CAMK1")
    DefaultAssay(SeuratObj) <- "RNA"
    res1 <- paste("RNA_snn_res.", res, sep = "")
    Idents(SeuratObj) <- res1
    'for(ii in 1:length(YoshidaImmuneMarkers)){
        print("Violin Plot")
        VPfname <- paste(pasfname, ".VP.YoshidaImmuneMarkers_TCells.", YoshidaImmuneMarkers[ii], ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
        #VPfname <- paste(pasfname, ".VP.YoshidaImmuneMarkers.", YoshidaImmuneMarkers[ii], ".res1_clusters.pdf", sep = "")
        pdf(file.path(outPath, VPfname), width = 11, height = 10)
        vln1 <- VlnPlot(SeuratObj, features = YoshidaImmuneMarkers[ii], assay = "RNA", group.by = res1)
        #vln1 <- VlnPlot(SeuratObj, features = YoshidaImmuneMarkers[ii], assay = "RNA", group.by = "res1")
        print(vln1)
        dev.off()
        print("Feature Plot")
        FPfname <- paste(pasfname, ".FP.YoshidaImmuneMarkers_TCells.", YoshidaImmuneMarkers[ii], ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
        #FPfname <- paste(pasfname, ".FP.YoshidaImmuneMarkers.", YoshidaImmuneMarkers[ii], ".res1_clusters.pdf", sep = "")
        pdf(file.path(outPath, FPfname), width = 11, height = 10)
        FP2 <- FeaturePlot(SeuratObj, features = YoshidaImmuneMarkers[ii])
        print(FP2)
        dev.off()
    }'
    print("Yoshida_TCells")
    DPfname <- paste(pasfname, ".DP.YoshidaImmuneMarkers_TCells", ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
    #DPfname <- paste(pasfname, ".DP.YoshidaImmuneMarkers_clusters.res1.png", sep = "")
    pdf(file.path(outPath, DPfname), width = 22, height = 18)
    #YoshidaMarkers <- c(mitoticBasal1, mitoticBasal2)
    #DP <- DotPlot(SeuratObj, features = YoshidaMarkers, cols = c("blue", "red"), dot.scale = 8) + RotatedAxis()
    DP <- DotPlot(SeuratObj, features = YoshidaImmuneMarkers, cols = c("blue", "red"), dot.scale = 25, assay = "RNA", group.by = res1) + RotatedAxis()
    #DP <- DotPlot(SeuratObj, features = YoshidaImmuneMarkers, cols = c("blue", "red"), dot.scale = 25, assay = "RNA", group.by = "integrated_snn_res.0.9") + RotatedAxis()
    print(DP)
    dev.off()
}
```

### Figure 3 Yoshida Bronchi and Nasal
```{r WorkingonData}
inPath <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida"
YoshRef.comb <- readRDS(file.path(inPath, "Yosh.immune.clust.InfantAdult.mod.AllSamples.AllLocations.rds"))
```

### All Samples

```{r AllAgeGroup_IFNScore} 
IFN.Core <- c("IFIT3", "OAS1", "IFIT2", "BST2", "IFIT1", "EPSTI1", "MX2", "UBE2L6", "OASL", "RSAD2", "SAMD9L", "LAP3", "NMI", "CXCL11", "IFI44L", "GBP4", "USP18", "LGALS3BP", "IFITM3", "CMPK2", "XAF1", "SAMHD1", "PARP9", "C1R", "IFI44", "BATF2", "RTP4", "HCP5", "IFITM1", "C1S", "IFI35", "MX1", "B2M", "IFI6", "OAS2", "DUOX2", "DDX58", "HERC5", "CXCL10", "PLSCR1", "DDX60L", "DUOXA2", "NT5C3A", "CD68", "IFIH1", "OAS3", "MMP13", "TRIM22", "ACE2", "BTN3A3", "IFI27", "HSH2D", "PARP14", "HERC6", "TRIM69", "STAT1", "ISG15", "ETV7", "IDO1", "H2BC21", "IRF7", "SCARA3", "H2AC6", "TAPBPL", "DTX3L", "TRANK1", "TDRD7", "PPM1K", "APOL6", "DDX60", "SP110", "GBP1", "LGALS9", "SHFL", "ZSCAN31", "LY6E", "SLC2A12", "KLHDC7B", "LAMP3", "PARP12", "CFH", "APOL4", "CFB", "CLTRN", "TENT5A", "TAP1", "SAMD9", "RNF213", "KLHDC7B-DT", "TRIM5", "ENSG00000288587", "PSMB8", "APOL1", "BTN3A2", "HELZ2", "BISPR", "STAT2", "PNPT1", "TTLL11", "H2BC4", "PLEKHH1", "APOBEC3G", "UBA7", "POF1B", "PATL2", "C1orf116", "ZNFX1", "CTSC", "STS", "HLA-A", "TRIM14", "SP100", "ENSG00000282988", "NEURL3", "TRIM21", "MUC15", "EIF2AK2", "CMTR1", "HLA-C", "LRATD1", "HLA-B", "ADAR", "PSMB9", "TNFSF10", "TRIM38", "IFIT5", "HLA-F", "GBP3", "EPGN", "PARP10", "PDZD2", "DHX58", "RBM43", "UNC93B1", "BTC", "C15orf48", "ARL14", "SERPING1", "SIDT1", "SP140L", "PLAAT4", "ENSG00000288825", "H2BC5", "PHF11", "MYD88", "IRF9", "NAPA", "C4orf33", "SIRPB2", "PCGF5", "TMEM229B", "SLC15A3", "IFI16", "BTN3A1", "TMEM140", "PML", "ERAP1", "ISG20", "TNFSF13", "ZCCHC2", "IL15RA", "FBXO6", "SCARB2")
IFN.Lambda <- c("ENSG00000272821", "EPHA4", "CXCL17", "NR2F2", "H2BC12", "STX19", "GALNT5", "CHMP5", "TOR1B", "ADGRF1", "ZNF766", "TAPBP", "AKR1B10", "MUC20", "GPRC5A", "SYTL5", "H4C8", "LOC100507516", "SIX1", "METTL7A", "LNCAROD", "ANKUB1", "LINC01559", "CTSO", "CCDC194", "ARRDC3", "SYNPO2", "IL36RN", "TLR3", "SLC6A14", "TRIM16", "DKK1", "ATP10B", "PLAAT2", "ID3", "LIPA", "GBP6")
IFN.Beta <- c("PLEKHA4", "AIM2", "GBP5", "TREX1", "NUB1", "APOL3", "SECTM1", "SCO2", "RABGAP1L", "CFLAR", "JADE2", "XRN1", "APOL2", "DNAJA1", "THEMIS2", "IL22RA1", "MASTL", "GMPR", "CNP", "NR1D1", "ZC3HAV1", "ENSG00000197536", "VEGFC", "TAP2", "CASP1", "CD74", "LMO2", "B3GNT7", "ODF3B", "CHROMR", "RIMS2", "BCL2L13", "GTPBP1", "ENSG00000225101", "PDIA6", "IFI30", "CCND3")
IFN.Alpha <- c("MX1", "ISG15", "OAS1", "IFIT3", "IFI44", "IFI35", "IRF7", "RSAD2", "IFI44L", "IFITM1", "IFI27", "IRF9", "OASL", "EIF2AK2", "IFIT2", "CXCL10", "TAP1", "SP110", "DDX60", "UBE2L6", "USP18", "PSMB8", "IFIH1", "BST2", "LGALS3BP", "ADAR", "ISG20", "GBP2", "IRF1", "PLSCR1", "PSMB9", "HERC6", "SAMD9", "CMPK2", "IFITM3", "RTP4", "STAT2", "SAMD9L", "LY6E", "IFITM2", "HELZ2", "CXCL11", "TRIM21", "PARP14", "TRIM26", "PARP12", "NMI", "RNF31", "HLA-C", "CASP1", "TRIM14", "TDRD7", "DHX58", "PARP9", "PNPT1", "TRIM25", "PSME1", "WARS1", "EPSTI1", "UBA7", "PSME2", "B2M", "TRIM5", "C1S", "LAP3", "LAMP3", "GBP4", "NCOA7", "TMEM140", "CD74", "GMPR", "PSMA3", "PROCR", "IL7", "IFI30", "IRF2", "CSF1", "IL15", "CNP", "TENT5A", "IL4R", "CMTR1", "CD47", "LPAR6", "MOV10", "CASP8", "TXNIP", "SLC25A28", "SELL", "TRAFD1", "BATF2", "RIPK2", "CCRL2", "NUB1", "OGFR", "MVB12A", "ELF1")
IFN.Gamma <- c("STAT1", "ISG15", "IFIT1", "MX1", "IFIT3", "IFI35", "IRF7", "IFIT2", "OAS2", "TAP1", "EIF2AK2", "RSAD2", "MX2", "IRF1", "OAS3", "TNFSF10", "IRF9", "CXCL10", "IFI44", "BST2", "XAF1", "SP110", "OASL", "PSMB8", "IFI44L", "IFITM3", "DDX60", "LGALS3BP", "GBP4", "IRF8", "PSMB9", "PML", "IFIH1", "UBE2L6", "IFI27", "ADAR", "LY6E", "STAT2", "CXCL9", "IL10RA", "PLA2G4A", "TRIM21", "USP18", "PTGS2", "EPSTI1", "C1S", "DDX58", "IL15", "NLRC5", "NMI", "IDO1", "PSMB10", "CXCL11", "ITGB7", "SAMHD1", "HERC6", "CMPK2", "SAMD9L", "RTP4", "PTPN2", "PARP14", "TNFAIP2", "IFITM2", "PLSCR1", "SOCS1", "CASP1", "ICAM1", "WARS1", "PSME1", "ISG20", "IRF2", "TRIM14", "FCGR1A", "MARCHF1", "SOCS3", "JAK2", "HLA-DMA", "PARP12", "TNFAIP6", "TRIM26", "VCAM1", "CD274", "CIITA", "NAMPT", "SELP", "GPR18", "FPR1", "HELZ2", "PSME2", "SERPING1", "CCL5", "RNF31", "SOD2", "TRIM25", "LAP3", "PSMA3", "RNF213", "PELI1", "CFB", "CD86", "TXNIP", "HLA-DQA1", "GCH1", "PNP", "CCL7", "PTPN6", "SPPL2A", "IL4R", "PNPT1", "DHX58", "BTG1", "CASP8", "IFI30", "CCL2", "FGL2", "CASP7", "SECTM1", "IL15RA", "CD40", "TRAFD1", "HLA-DRB1", "GBP6", "LCP2", "HLA-G", "MT2A", "RIPK1", "KLRK1", "UPP1", "PSMB2", "TDRD7", "HIF1A", "EIF4E3", "VAMP8", "PFKP", "CD38", "ZBP1", "BANK1", "TOR1B", "RBCK1", "PDE4B", "MVP", "IL7", "BPGM", "CMTR1", "AUTS2", "B2M", "RIPK2", "CD69", "MYD88", "PSMA2", "PIM1", "NOD1", "CFH", "TAPBP", "SLC25A28", "PTPN1", "TNFAIP3", "SSPN", "NUP93", "MTHFD2", "CDKN1A", "IRF4", "NFKB1", "BATF2", "HLA-B", "LATS2", "IRF5", "SLAMF7", "ISOC1", "P2RY14", "STAT3", "NCOA3", "HLA-A", "IL6", "GZMA", "IFNAR2", "CD74", "RAPGEF6", "CASP4", "FAS", "OGFR", "ARL4A", "SRI", "LYSMD2", "CSF2RB", "ST3GAL5", "C1R", "CASP3", "CMKLR1", "NFKBIA", "METTL7B", "ST8SIA4", "XCL1", "IL2RB", "VAMP5", "IL18BP", "ZNFX1", "ARID5B", "APOL6", "STAT4")

#YoshRef.Epithelial.Infant.annotated <- subset(YoshRef.Epithelial.annotated, subset = Age_donor == "Young_infant")

IFN.Core <-  IFN.Core[!IFN.Core %in% c("HCP5", "H2BC21", "H2AC6", "SHFL", "KLHDC7B-DT", "ENSG00000288587", "H2BC4", "ENSG00000282988", "LRATD1", "PLAAT4", "ENSG00000288825", "H2BC5")]
IFN.Core <- list(IFN.Core)
###YoshRef_Infant Mod Score
YoshRef.comb.modScore3 <- AddModuleScore(YoshRef.comb, features = IFN.Core, assay = "RNA", name = "IFN.Core",  ctrl = 200)
###IFN.Lambda
IFN.Lambda <-  IFN.Lambda[!IFN.Lambda %in% c("ENSG00000272821", "H2BC12", "H4C8", "LOC100507516", "LNCAROD", "PLAAT2")]
IFN.Lambda <- list(IFN.Lambda)
YoshRef.comb.modScore3 <- AddModuleScore(YoshRef.comb.modScore3, features = IFN.Lambda, assay = "RNA", name = "IFN.Lambda")
###IFN.Beta
#immg1 <-  immg1[!immg1 %in% c("HCP5", "BISPR", "CLCA3P", "KLHDC7B-DT", "PSMB8-AS1", "GBP1P1", "LOC100507516")]
IFN.Beta <-  IFN.Beta[!IFN.Beta %in% c("ENSG00000197536", "CHROMR", "ENSG00000225101")]
IFN.Beta <- list(IFN.Beta)
YoshRef.comb.modScore3 <- AddModuleScore(YoshRef.comb.modScore3, features = IFN.Beta, assay = "RNA", name = "IFN.Beta")
###InterferonAlpha
#immg1 <-  immg1[!immg1 %in% c("HCP5", "BISPR", "CLCA3P", "KLHDC7B-DT", "PSMB8-AS1", "GBP1P1", "LOC100507516")]
IFN.Alpha <-  IFN.Alpha[!IFN.Alpha %in% c("WARS1")]
IFN.Alpha <- list(IFN.Alpha)
YoshRef.comb.modScore3 <- AddModuleScore(YoshRef.comb.modScore3, features = IFN.Alpha, assay = "RNA", name = "IFN.Alpha")
#Gamma
#immg2 <- immg2[!immg2 %in% c("CXCL9", "TRIM40", "IRG1", "C1orf68", "USP41", "MMP25-AS1",  "CARD17", "LRCH2", "RARRES3", "IL1RL1", "RXFP1", "IFNK", "IL36B", "HRASLS2", "TMEM27", "LCE1F", "HEPHL1", "TNFRSF9", "VNN3","ZPLD1", "MEP1B", "TNFAIP6")]
IFN.Gamma <-  IFN.Gamma[!IFN.Gamma %in% c("WARS1", "MARCHF1")]
IFN.Gamma <- list(IFN.Gamma)
YoshRef.comb.modScore3 <- AddModuleScore(YoshRef.comb.modScore3, features = IFN.Gamma, assay = "RNA", name = "IFN.Gamma")
```

```{r IFN.Core}

# +   scale_color_distiller(palette = "RdYlBu") +
Idents(YoshRef.comb.modScore3) <- "Sample_location"
pas9 <- "YoshRef.comb.modScore3.legend.IFN.Core.Sample_location.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8)))  
print(p1)
dev.off()
pas10 <- "YoshRef.comb.modScore3.nolegend.IFN.Core.Sample_location.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) 
print(p2)
dev.off()
###majorAnnot
#
loc_plot <- c("Nose" = "darkblue", "Bronchi" = "cadetblue1",  "Trachea" = "cornflowerblue") 
YoshRef.comb.modScore3@meta.data$Sample_location = factor(YoshRef.comb.modScore3@meta.data$Sample_location, levels = c("Nose", "Bronchi",  "Trachea"))
VPfname <- "YoshRef_Epithelial.VP.IFN.Core.SampLoc.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.comb.modScore3, features = "IFN.Core1", group.by = "Sample_location", cols = loc_plot) +
   theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 30), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
RPfname <- "YoshRef_Epithelial.RP.IFN.Core.SampLoc.png"
png(file.path(outPath.Epithelial.Yoshida, RPfname), width = 12, height = 8, units = "in", res = 600)
rdg1 <- RidgePlot(YoshRef.comb.modScore3, features = "IFN.Core1", group.by = "Sample_location", cols = loc_plot) +
   theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 30), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(rdg1)
dev.off()
```

```{r annotating.callFun} 
#metaDat <- SeuratObj@meta.data[!duplicated(SeuratObj@meta.data[,c("seurat_clusters", "Cell_type_annotation_level1", "Cell_type_annotation_level2")]),]
inPath <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida"
YoshRef.comb <- readRDS(file.path(inPath, "Yosh.immune.clust.InfantAdult.mod.AllSamples.AllLocations.rds"))
outPath = inPath 
outPath.Epithelial.Yoshida <- file.path(outPath, "YoshRef.control.norm.leiden", "YoshRef.control.norm.leiden.AllSamples")
dir.create(file.path(outPath.Epithelial.Yoshida))
#YoshRef.comb <- readRDS(file.path(inPath,paste("Yosh.immune.clust.InfantAdult.mod.res3.rds")))
#YoshRef.comb <- merged.immune.UMAP
#res=c(0.1,0.2,0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2)
#res=c( 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2)
#res=c(1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2, 2.5, 3, 4, 5)
#YoshRef.comb <- FindClusters(YoshRef.comb,resolution=res, algorithm = 4, method = "igraph")

#res=c(0.1,0.2,0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1,)
#res=c(1, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8)
#res=c(2.4, 2.5)
#res=c(1)
for(i in 1:length(res)){
res1 <- paste("RNA_snn_res.", res[i],sep = "")
outPath.Epithelial.Yoshida.res <- file.path(outPath.Epithelial.Yoshida, paste("Resolution.", res[i], sep = ""))
dir.create(outPath.Epithelial.Yoshida.res)
print(res1)
Idents(YoshRef.comb) <- as.character(res1)
clust <- unique(Idents(YoshRef.comb))
print(clust)
YoshidaBasalMarkers(YoshRef.comb, "AllSamples", outPath.Epithelial.Yoshida.res, res[i], "YoshRef.control.AllSamples")
YoshidaSecGobMarkers(YoshRef.comb, "AllSamples", outPath.Epithelial.Yoshida.res, res[i], "YoshRef.control.AllSamples")
YoshidaCilMarkers(YoshRef.comb, "AllSamples", outPath.Epithelial.Yoshida.res, res[i], "YoshRef.control.AllSamples")
YoshidaRareMarkers(YoshRef.comb, "AllSamples", outPath.Epithelial.Yoshida.res, res[i], "YoshRef.control.AllSamples")
YoshidaTransEpiMarkers(YoshRef.comb, "AllSamples", outPath.Epithelial.Yoshida.res, res[i],"YoshRef.control.AllSamples")
YoshidaImmuneMarkers.BCells(YoshRef.comb, "AllSamples", outPath.Epithelial.Yoshida.res, res[i], "YoshRef.control.AllSamples")
YoshidaImmuneMarkers.TCells(YoshRef.comb, "AllSamples", outPath.Epithelial.Yoshida.res, res[i], "YoshRef.control.AllSamples")
Idents(YoshRef.comb) <- res1
DefaultAssay(YoshRef.comb) <- "RNA"
countRNA <- GetAssayData(object = YoshRef.comb, layer = "data")
genes <- rownames(countRNA)
mtGenes.loc <- grep("^MT-", genes)
mtGenes <- genes[mtGenes.loc]
rplGenes.loc <- grep("^MRPL", genes)
rplGenes <- genes[rplGenes.loc]
rpsGenes.loc <- grep("^MRPS", genes)
rpsGenes <- genes[rpsGenes.loc]
RPLGenes <- c("RP1L1","RPL10","RPL10A","RPL11","RPL12","RPL13","RPL13A","RPL14","RPL15","RPL17","RPL17-C18orf32","RPL18","RPL18A","RPL19","RPL21","RPL22","RPL22L1","RPL23","RPL23A","RPL24","RPL26","RPL26L1","RPL27","RPL27A","RPL28","RPL29","RPL3","RPL30","RPL31","RPL32","RPL34","RPL35","RPL35A","RPL36","RPL36A","RPL36AL","RPL37","RPL37A","RPL38","RPL39","RPL39L","RPL3L","RPL4","RPL41","RPL5","RPL6","RPL7","RPL7A","RPL7L1","RPL8","RPL9","RPLP0","RPLP1","RPLP2","RPS10","RPS10-NUDT3","RPS11","RPS12","RPS13","RPS14","RPS15","RPS15A","RPS16","RPS17","RPS18","RPS19","RPS19BP1","RPS2","RPS20","RPS21","RPS23","RPS24","RPS25","RPS26","RPS27","RPS27A","RPS27AP5","RPS27L","RPS28","RPS29","RPS3","RPS3A","RPS4X","RPS4Y1","RPS5","RPS6","RPS6KA1","RPS6KA2","RPS6KA3","RPS6KA4","RPS6KA5","RPS6KA6","RPS6KB1","RPS6KB2","RPS6KC1","RPS6KL1","RPS7","RPS8","RPS9")
RPL_RT.Genes <- c(RPLGenes, mtGenes, rpsGenes, rplGenes)
genes.RPL_RT.rem <- genes[!(genes %in% (RPL_RT.Genes))]
allMarkers <- FindAllMarkers(YoshRef.comb,  logfc.threshold=0.25,  test.use="wilcox", assay="RNA", features = genes.RPL_RT.rem, only.pos= TRUE)
write.csv(allMarkers, file.path(outPath.Epithelial.Yoshida.res, paste("YoshRef_AllSamples.norm.Markers.", res[i] ,".AllMarkers.mod.csv")))
dataSamp <- data.frame(table(Idents(YoshRef.comb)))
write.table(dataSamp , file.path(outPath.Epithelial.Yoshida.res, paste("YoshRef_AllSamples.norm.NumverofCells.", res[i] ,".AllMarkers.mod.csv")), row.names = FALSE)
}
```

## IFN.Core
Nose.modScore3 <- subset(YoshRef.comb.modScore3, subset = Sample_location == "Nose")
Bronchi.modScore3 <- subset(YoshRef.comb.modScore3, subset = Sample_location == "Bronchi")
Trachea.modScore3 <- subset(YoshRef.comb.modScore3, subset = Sample_location == "Trachea")
Nose.IFN.Core.notExpressed <- length((Nose.modScore3@meta.data$IFN.Core1[Nose.modScore3@meta.data$IFN.Core1 <= 0]))
Nose.IFN.Core.Expressed <- length((Nose.modScore3@meta.data$IFN.Core1[Nose.modScore3@meta.data$IFN.Core1 > 0]))
Trachea.IFN.Core.notExpressed <- length((Trachea.modScore3@meta.data$IFN.Core1[Trachea.modScore3@meta.data$IFN.Core1 <= 0]))
Trachea.IFN.Core.Expressed <- length((Trachea.modScore3@meta.data$IFN.Core1[Trachea.modScore3@meta.data$IFN.Core1 > 0]))
Bronchi.IFN.Core.notExpressed <- length((Bronchi.modScore3@meta.data$IFN.Core1[Bronchi.modScore3@meta.data$IFN.Core1 <= 0]))
Bronchi.IFN.Core.Expressed <- length((Bronchi.modScore3@meta.data$IFN.Core1[Bronchi.modScore3@meta.data$IFN.Core1 > 0]))

Nose.IFN.Core.notExpressed; Nose.IFN.Core.Expressed
Trachea.IFN.Core.notExpressed; Trachea.IFN.Core.Expressed
Bronchi.IFN.Core.notExpressed; Bronchi.IFN.Core.Expressed




### Major Annotation
```{r annotating_major} 
#outpath.Yosh = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida"
#YoshRef.control.norm.Epithelial.norm.Cluster
#res1 <- "RNA_snn_res.0.8"
YoshRef.comb.modScore3  <- YoshRef.comb
YoshRef.comb.modScore3 <- YoshRef.comb
Idents(YoshRef.comb.modScore3) <- "RNA_snn_res.1"
YoshRef.comb.modScore3 <- subset(YoshRef.comb.modScore3, subset = Age_donor != "Eldly")
YoshRef.comb.modScore3@meta.data$Age_donor <- gsub("Young_infant", "Infant", YoshRef.comb.modScore3@meta.data$Age_donor)
YoshRef.control.norm.Epithelial.ids.major <- c("1" = "SecGob", "2" = "Basal", "3" = "Ciliated", "4" = "SecGob", "5" = "Transitional Epithelium", "6" = "SecGob", "7" = "Ciliated", "8" = "SecGob", "9" = "Immune", "10" = "Basal", "11" = "Immune", "12" = "Ciliated", "13" = "Squamous", "14" = "SecGob", "15" = "Immune", "16" = "Transitional Epithelium", "17" = "Ciliated", "18" = "SecGob", "19" = "Basal", "20" = "Immune", "21" = "Immune", "22" = "Immune", "23" = "Immune", "24" = "Basal", "25" = "Basal", "26" = "RareCells", "27" = "Ciliated", "28" = "Immune", "29" = "Immune", "30" = "Immune", "31" = "Immune")
Idents(YoshRef.comb.modScore3) <- "RNA_snn_res.1"
names(YoshRef.control.norm.Epithelial.ids.major) <- levels(YoshRef.comb.modScore3)
YoshRef.comb.modScore3.annotated <- RenameIdents(YoshRef.comb.modScore3, YoshRef.control.norm.Epithelial.ids.major)
YoshRef.comb.modScore3.annotated@meta.data$majorAnnot <- Idents(YoshRef.comb.modScore3.annotated)
```

### Minor Annotation
```{r annotating_minor}
#outpath.Yosh = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida"
YoshRef.control.norm.Epithelial.ids.minor <- c("1" = "Goblet2_BPIFA2", "2" = "Basal2", "3" = "Ciliated1", "4" = "Secreatory", "5" = "TransitionalEpithelium2", "6" = "Goblet1", "7" = "Ciliated1", "8" = "Secreatory", "9" = "Bcells", "10" = "Basal1", "11" = "Tcells", "12" = "Ciliated1", "13" = "Squamous", "14" = "Club", "15" = "B Cycling", "16" = "TransitionalEpithelium2", "17" = "Ciliated2", "18" = "Secreatory", "19" = "Hillock", "20" = "Tcells", "21" = "MAC", "22" = "MAC", "23" = "B Cycling", "24" = "CyclingHillock", "25" = "Hillock", "26" = "Ionocytes", "27" = "Deuterosome", "28" = "PlasmaCells", "29" = "Mast Cells", "30" = "MAC", "31" = "fDC")
Idents(YoshRef.comb.modScore3.annotated) <- "RNA_snn_res.1"
names(YoshRef.control.norm.Epithelial.ids.minor) <- levels(YoshRef.comb.modScore3.annotated)
YoshRef.comb.modScore3.annotated <- RenameIdents(YoshRef.comb.modScore3.annotated, YoshRef.control.norm.Epithelial.ids.minor)
YoshRef.comb.modScore3.annotated@meta.data$minorAnnot <- Idents(YoshRef.comb.modScore3.annotated)
saveRDS(YoshRef.comb.modScore3.annotated, file.path(outPath.Epithelial.Yoshida,paste("YoshRef.control.norm.AllSamplesres1.annotated_Mod.rds")))
#YoshRef.comb.modScore3.annotated <- readRDS(file.path(outPath.Epithelial.Yoshida,paste("YoshRef.control.norm.AllSamplesres1.annotated.rds")))
```

### PseudoBulk. All Cells

```{r AllCells.wImmune}
outPath.Epithelial.Yoshida = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
YoshRef.comb.modScore3 <- readRDS(file.path(outPath.Epithelial.Yoshida,paste("YoshRef.control.norm.AllSamplesres1.annotated.rds")))
YoshRef.comb <- YoshRef.comb.modScore3
#YoshRef.comb@meta.data$Samp.loc <- ifelse(YoshRef.comb@meta.data$Sample_location %in% c("Bronchi", "Trachea"), "Bronchi_Trachea", "Nose")
Idents(YoshRef.comb) <- "Samp.loc"
DefaultAssay(YoshRef.comb) <- "RNA"
countRNA <- GetAssayData(object = YoshRef.comb, layer = "data")
genes <- rownames(countRNA)
mtGenes.loc <- grep("^MT-", genes)
mtGenes <- genes[mtGenes.loc]
rplGenes.loc <- grep("^MRPL", genes)
rplGenes <- genes[rplGenes.loc]
rpsGenes.loc <- grep("^MRPS", genes)
rpsGenes <- genes[rpsGenes.loc]
RPLGenes <- c("RP1L1","RPL10","RPL10A","RPL11","RPL12","RPL13","RPL13A","RPL14","RPL15","RPL17","RPL17-C18orf32","RPL18","RPL18A","RPL19","RPL21","RPL22","RPL22L1","RPL23","RPL23A","RPL24","RPL26","RPL26L1","RPL27","RPL27A","RPL28","RPL29","RPL3","RPL30","RPL31","RPL32","RPL34","RPL35","RPL35A","RPL36","RPL36A","RPL36AL","RPL37","RPL37A","RPL38","RPL39","RPL39L","RPL3L","RPL4","RPL41","RPL5","RPL6","RPL7","RPL7A","RPL7L1","RPL8","RPL9","RPLP0","RPLP1","RPLP2","RPS10","RPS10-NUDT3","RPS11","RPS12","RPS13","RPS14","RPS15","RPS15A","RPS16","RPS17","RPS18","RPS19","RPS19BP1","RPS2","RPS20","RPS21","RPS23","RPS24","RPS25","RPS26","RPS27","RPS27A","RPS27AP5","RPS27L","RPS28","RPS29","RPS3","RPS3A","RPS4X","RPS4Y1","RPS5","RPS6","RPS6KA1","RPS6KA2","RPS6KA3","RPS6KA4","RPS6KA5","RPS6KA6","RPS6KB1","RPS6KB2","RPS6KC1","RPS6KL1","RPS7","RPS8","RPS9")
RPL_RT.Genes <- c(RPLGenes, mtGenes, rpsGenes, rplGenes)
genes.RPL_RT.rem <- genes[!(genes %in% (RPL_RT.Genes))]
pseudo_YoshRef <- AggregateExpression(YoshRef.comb, 
    assays = "RNA", 
    return.seurat = T,
    group.by = c("donor",  "Samp.loc"))
	
allMarkers <- FindMarkers(pseudo_YoshRef, 
    logfc.threshold=0.25, 
    ident.1 = "Nasal", 
    ident.2 = "Bronchial", 
    test.use="wilcox.limma",
    assay="RNA",
    group.by = "Samp.loc",
    features = genes.RPL_RT.rem)
write.csv(allMarkers, file.path(outPath.Epithelial.Yoshida, paste("Nasal_vs_Bronchi_Trachea.AllMarkers.mod.csv")))
```


### PseudoBulk. All Cells.wo Immune

```{r AllCells.woImmune}
#outPath.Epithelial.Yoshida = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
#YoshRef.comb.modScore3 <- readRDS(file.path(outPath.Epithelial.Yoshida,paste("YoshRef.control.norm.AllSamplesres1.annotated.rds")))
#YoshRef.comb <- YoshRef.comb.modScore3
#YoshRef.comb <- YoshRef.comb.modScore3.annotated
YoshRef.comb@meta.data$Samp.loc <- ifelse(YoshRef.comb@meta.data$Sample_location %in% c("Bronchi", "Trachea"), "Bronchial", "Nasal")
YoshRef.comb.woImmune <- subset(YoshRef.comb, 
    subset = majorAnnot %in% c("Basal", 
                            "SecGob",
                            "Ciliated",
                            "RareCells")
                            & Age_donor != "Eldly" )
YoshRef.comb.woImmune@meta.data$Samp.loc <- ifelse(YoshRef.comb.woImmune$Sample_location %in% c("Bronchi", "Trachea"), "Bronchial", "Nasal")
#YoshRef.comb@meta.data$Samp.loc <- ifelse(YoshRef.comb@meta.data$Sample_location %in% c("Bronchi", "Trachea"), "Bronchi_Trachea", "Nose")

Idents(YoshRef.comb.woImmune) <- "Samp.loc"
DefaultAssay(YoshRef.comb.woImmune) <- "RNA"
countRNA <- GetAssayData(object = YoshRef.comb.woImmune, layer = "data")
genes <- rownames(countRNA)
mtGenes.loc <- grep("^MT-", genes)
mtGenes <- genes[mtGenes.loc]
rplGenes.loc <- grep("^MRPL", genes)
rplGenes <- genes[rplGenes.loc]
rpsGenes.loc <- grep("^MRPS", genes)
rpsGenes <- genes[rpsGenes.loc]
RPLGenes <- c("RP1L1","RPL10","RPL10A","RPL11","RPL12","RPL13","RPL13A","RPL14","RPL15","RPL17","RPL17-C18orf32","RPL18","RPL18A","RPL19","RPL21","RPL22","RPL22L1","RPL23","RPL23A","RPL24","RPL26","RPL26L1","RPL27","RPL27A","RPL28","RPL29","RPL3","RPL30","RPL31","RPL32","RPL34","RPL35","RPL35A","RPL36","RPL36A","RPL36AL","RPL37","RPL37A","RPL38","RPL39","RPL39L","RPL3L","RPL4","RPL41","RPL5","RPL6","RPL7","RPL7A","RPL7L1","RPL8","RPL9","RPLP0","RPLP1","RPLP2","RPS10","RPS10-NUDT3","RPS11","RPS12","RPS13","RPS14","RPS15","RPS15A","RPS16","RPS17","RPS18","RPS19","RPS19BP1","RPS2","RPS20","RPS21","RPS23","RPS24","RPS25","RPS26","RPS27","RPS27A","RPS27AP5","RPS27L","RPS28","RPS29","RPS3","RPS3A","RPS4X","RPS4Y1","RPS5","RPS6","RPS6KA1","RPS6KA2","RPS6KA3","RPS6KA4","RPS6KA5","RPS6KA6","RPS6KB1","RPS6KB2","RPS6KC1","RPS6KL1","RPS7","RPS8","RPS9")
RPL_RT.Genes <- c(RPLGenes, mtGenes, rpsGenes, rplGenes)
genes.RPL_RT.rem <- genes[!(genes %in% (RPL_RT.Genes))]
allMarkers <- FindMarkers(YoshRef.comb.woImmune, 
    logfc.threshold=0, 
    ident.1 = "Nose", 
    ident.2 = "Bronchi", 
    test.use="wilcox",
    assay="RNA",
    group.by = "Samp.loc",
    features = genes.RPL_RT.rem)
write.csv(allMarkers, file.path(outPath.Epithelial.Yoshida.res, paste("Nasal_vs_Bronchi_Trachea.AllMarkers.woImmune.mod.csv")))
```
### Sample Visualization
```{r SampleVisualization}
outPath.Epithelial.Yoshida = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
YoshRef.comb.modScore3 <- readRDS(file.path(outPath.Epithelial.Yoshida,paste("YoshRef.control.norm.AllSamplesres1.annotated.rds")))
YoshRef.comb <- YoshRef.comb.modScore3
YoshRef.comb@meta.data$Samp.loc <- ifelse(YoshRef.comb@meta.data$Sample_location %in% c("Bronchi", "Trachea"), "Bronchi", "Nose")
YoshRef.comb <- subset(YoshRef.comb, subset = majorAnnot %in% c("Basal", "SecGob", "Ciliated", "RareCells") & 
    Age_donor != "Eldly" & Age_donor != "Adult")
YoshRef.comb@meta.data$majorAnnot <- factor(YoshRef.comb@meta.data$majorAnnot, 
    levels = c("Basal", "SecGob", "Ciliated", "RareCells"))
majorCols <- c("Basal" = "red", "SecGob" = "purple", "Ciliated" = "olivedrab1", "RareCells" = "magenta")
#YoshRef.comb <- YoshRef.comb.woImmune
plotAnnot <- DimPlot(YoshRef.comb, group.by = "majorAnnot", raster = FALSE, order = TRUE) + ggtitle("Airway Epithelium")
plotAnnot <- plotAnnot + scale_color_manual(values = majorCols)

# Remove x and y axis text, ticks, and lines, and enlarge plot title
plotAnnot <- plotAnnot + theme(
  axis.text.x = element_blank(),
  axis.text.y = element_blank(),
  axis.ticks.x = element_blank(),
  axis.ticks.y = element_blank(),
  axis.line.x = element_blank(),
  axis.line.y = element_blank(),
  axis.title.x = element_blank(),
  axis.title.y = element_blank(),
  plot.title = element_text(size = 20, face = "bold"),
  legend.text = element_text(size = 14, face = "bold"),   # Enlarge legend text
  legend.title = element_text(size = 16, face = "bold")   # Enlarge legend title
)


# Save the plot
output_file_clusters <- file.path(outPath.Epithelial.Yoshida, "DimPlot.EpithelialCells.Bronchi_Nasal.wLegend.mod.png")
ggsave(filename = output_file_clusters, plot = plotAnnot, width = 6, height = 4, dpi = 600)

plotAnnot <- plotAnnot + scale_color_manual(values = majorCols)

# Remove x and y axis text, ticks, and lines, and enlarge plot title
plotAnnot <- plotAnnot + theme(
  axis.text.x = element_blank(),
  axis.text.y = element_blank(),
  axis.ticks.x = element_blank(),
  axis.ticks.y = element_blank(),
  axis.line.x = element_blank(),
  axis.line.y = element_blank(),
  axis.title.x = element_blank(),
  axis.title.y = element_blank(),
  plot.title = element_text(size = 20, face = "bold"),
  legend.text = element_text(size = 0, face = "bold"),   # Enlarge legend text
  legend.title = element_text(size = 0, face = "bold")   # Enlarge legend title
)


# Save the plot
output_file_clusters <- file.path(outPath.Epithelial.Yoshida, "DimPlot.EpithelialCells.Bronchi_Nasal.woLegend.png")
ggsave(filename = output_file_clusters, plot = plotAnnot, width = 6, height = 4, dpi = 600)
```


```{r SampleVisualization}
'outPath.Epithelial.Yoshida = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
YoshRef.comb.modScore3 <- readRDS(file.path(outPath.Epithelial.Yoshida,paste("YoshRef.control.norm.AllSamplesres1.annotated.rds")))
YoshRef.comb <- YoshRef.comb.modScore3
YoshRef.comb@meta.data$Samp.loc <- ifelse(YoshRef.comb@meta.data$Sample_location %in% c("Bronchi", "Trachea"), "Bronchi", "Nose")
YoshRef.comb <- subset(YoshRef.comb, subset = majorAnnot %in% c("Basal", "SecGob", "Ciliated", "RareCells") & 
    Age_donor != "Eldly" & Age_donor != "Adult")
YoshRef.comb@meta.data$majorAnnot <- factor(YoshRef.comb@meta.data$majorAnnot, 
    levels = c("Basal", "SecGob", "Ciliated", "RareCells"))
majorCols <- c("Basal" = "red", "SecGob" = "purple", "Ciliated" = "olivedrab1", "RareCells" = "magenta")'
sampCols <- c("Nose" = "coral1", "Bronchi" = "blue")
plotAnnot <- DimPlot(YoshRef.comb, group.by = "Samp.loc", raster = FALSE, order = TRUE) + ggtitle("Airway Epithelium")
plotAnnot <- plotAnnot + scale_color_manual(values = sampCols)

# Remove x and y axis text, ticks, and lines, and enlarge plot title
plotAnnot <- plotAnnot + theme(
  axis.text.x = element_blank(),
  axis.text.y = element_blank(),
  axis.ticks.x = element_blank(),
  axis.ticks.y = element_blank(),
  axis.line.x = element_blank(),
  axis.line.y = element_blank(),
  axis.title.x = element_blank(),
  axis.title.y = element_blank(),
  plot.title = element_text(size = 20, face = "bold"),
  legend.text = element_text(size = 14, face = "bold"),   # Enlarge legend text
  legend.title = element_text(size = 16, face = "bold")   # Enlarge legend title
)


# Save the plot
output_file_clusters <- file.path(outPath.Epithelial.Yoshida, "DimPlot.EpithelialCells.Samp.loc.wLegend.png")
ggsave(filename = output_file_clusters, plot = plotAnnot, width = 6, height = 4, dpi = 600)

plotAnnot <- plotAnnot + scale_color_manual(values = sampCols)

# Remove x and y axis text, ticks, and lines, and enlarge plot title
plotAnnot <- plotAnnot + theme(
  axis.text.x = element_blank(),
  axis.text.y = element_blank(),
  axis.ticks.x = element_blank(),
  axis.ticks.y = element_blank(),
  axis.line.x = element_blank(),
  axis.line.y = element_blank(),
  axis.title.x = element_blank(),
  axis.title.y = element_blank(),
  plot.title = element_text(size = 20, face = "bold"),
  legend.text = element_text(size = 0, face = "bold"),   # Enlarge legend text
  legend.title = element_text(size = 0, face = "bold")   # Enlarge legend title
)


# Save the plot
output_file_clusters <- file.path(outPath.Epithelial.Yoshida, "DimPlot.EpithelialCells.Samp.loc.woLegend.png")
ggsave(filename = output_file_clusters, plot = plotAnnot, width = 6, height = 4, dpi = 600)
```

```{r CalculatingNumberofSamples}
dat <- YoshRef.comb.woImmune@meta.data[!duplicated(YoshRef.comb.woImmune@meta.data[,c("donor", "Samp.loc")]),]
dat1 <- data.frame(Donor = dat$donor, Location = dat$Samp.loc, AgeGroup = dat$Age_bin)
write.csv(dat1, file.path(outPath.Epithelial.Yoshida, 
    "NumberofSamples.csv"), row.names = FALSE)
```
```{r NumberofCells}
YoshRef.comb.woImmune.Neonate.Nose <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Neonate" & Samp.loc == "Nose")
YoshRef.comb.woImmune.Neonate.Bronchi <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Neonate" & Samp.loc == "Bronchi")
YoshRef.comb.woImmune.Infant.Nose <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Infant" & Samp.loc == "Nose")
YoshRef.comb.woImmune.Infant.Bronchi <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Infant" & Samp.loc == "Bronchi")
YoshRef.comb.woImmune.YC.Nose <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Young child" & Samp.loc == "Nose")
YoshRef.comb.woImmune.YC.Bronchi <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Young child" & Samp.loc == "Bronchi")
YoshRef.comb.woImmune.Child.Nose <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Child" & Samp.loc == "Nose")
YoshRef.comb.woImmune.Child.Bronchi <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Child" & Samp.loc == "Bronchi")
YoshRef.comb.woImmune.Adolescent.Nose <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Adolescent" & Samp.loc == "Nose")
YoshRef.comb.woImmune.Adolescent.Bronchi <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Adolescent" & Samp.loc == "Bronchi")
YoshRef.comb.woImmune.Bronchi <- subset(YoshRef.comb.woImmune, 
    subset = Samp.loc == "Bronchi")
YoshRef.comb.woImmune.Nose <- subset(YoshRef.comb.woImmune, 
    subset = Samp.loc == "Nose")
```

### Cell Percentage _ Figure 1f
```{r Percentage_composition}
#YoshRef.comb <- YoshRef.comb.woImmune
Idents(YoshRef.comb) <- "majorAnnot"
#YoshRef.comb@active.ident = factor(YoshRef.comb@active.ident, 
    #labels = c("Basal", "SecGob", "Ciliated", "RareCells"))
#YoshRef.comb@meta.data$Samp.loc = factor(YoshRef.comb@meta.data$Samp.loc, 
    #labels = c("Nose", "Bronchi"))
pt <- data.frame(t(table(YoshRef.comb@meta.data$Samp.loc, Idents(YoshRef.comb))))
pt1 <- data.frame(t(table(YoshRef.comb@meta.data$Samp.loc)))
dat <- full_join(pt, pt1, by = "Var2")
dat.percentofSamples_SampLoc_cellType <- data.frame(celltype = dat$Var1.x, SampleLocation = dat$Var2, NumberofCells_Condition = dat$Freq.x, 
NumberofCells_celltype = dat$Freq.y)
dat.percentofSamples_SampLoc_cellType$PercentofCells_per_SampLoc = round(((dat.percentofSamples_SampLoc_cellType$NumberofCells_Condition/dat.percentofSamples_SampLoc_cellType$NumberofCells_celltype)*100),2)
write.csv(dat.percentofSamples_SampLoc_cellType, file.path(outPath.Epithelial.Yoshida, 
    "YoshRef.Epithelial_Nasal.CellPercentage.csv"))
cols_plot = c(
    "Nasal" = "coral1", 
    "Bronchial" = "blue")
#BabyvsAdult.ALI.INF.repl1<- BabyvsAdult.ALI.INF.repl
dat.percentofSamples_SampLoc_cellType$SampleLocation <- factor(
    dat.percentofSamples_SampLoc_cellType$SampleLocation, 
    levels = c("Bronchial", "Nasal"))
dat.percentofSamples_SampLoc_cellType$celltype <- factor(
    dat.percentofSamples_SampLoc_cellType$celltype, 
    levels = c("Basal", "SecGob", "Ciliated", "RareCells"))
#pdf(file.path(outpath, "BabyvsAdult.ALI.INF_annotated_replicates.celltype.pdf"), width = 11, height = 9)
#pdf(file.path(outPath.BCells.Immune.Yoshida, "YoshRef.BCells.Immune.majorCellType.pdf"), width = 18, height = 16)
#outPath.BCells.Immune.Yoshida = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/Results/0.3.RNAAssay/Results/0.3.RNAAssay.Figures"

plt.barplot <- ggplot(dat.percentofSamples_SampLoc_cellType, 
    aes(x = celltype, y = PercentofCells_per_SampLoc, fill = SampleLocation)) + 
    labs(title = "", x = "Cell types", y = "% of Cells") + 
    geom_bar(stat="identity", position=position_dodge()) + 
    scale_fill_manual(values= cols_plot) +
    theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold",),
        axis.text.x = element_text(size = 14, face = "bold",),
        axis.text.y = element_text(size = 14,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelial.Yoshida, 
    "YoshRef.Nose_Bronchi.majorCellType.Percentage.barPlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 7, height = 4, dpi = 600)

plot.stack <- ggplot(dat.percentofSamples_SampLoc_cellType, 
    aes(x = celltype, y = PercentofCells_per_SampLoc, fill = SampleLocation)) +
    geom_bar(stat = "identity", position = "stack") +
    scale_fill_manual(values= cols_plot) +
    labs(title = "",
        x = "Cell types",
        y = "% of Cells") +
    theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) 

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.Epithelial.Yoshida, 
    "YoshRef.Nose_Bronchi.majorCellType.Percentage.StackPlot.png")

ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)
plot.stack <- ggplot(dat.percentofSamples_SampLoc_cellType, 
    aes(x = celltype, y = PercentofCells_per_SampLoc, fill = SampleLocation)) +
    geom_bar(stat = "identity", position = "stack") +
    scale_fill_manual(values= cols_plot) +
    labs(title = "",
        x = "Cell types",
        y = "% of Cells") +
    theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.Epithelial.Yoshida, 
    "YoshRef.Nose_Bronchi.majorCellType.Percentage.StackPlot.coordFlip.png")
ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)

```


####Volcano plot- No Genes

```{r, fig.width=12, fig.height=10}

allMarkers$GeneSymbol <- rownames(allMarkers)
#res.SE_vs_SM_nopadj$GeneID <- datFinal$geneID
output_file_immune_cell <- file.path(outPath.Epithelial.Yoshida, 
    "YoshRef.Nose_Bronchi.VP.png")
evp <- EnhancedVolcano(allMarkers, 
    lab = "", 
    x = 'avg_log2FC', 
    y = 'p_val_adj', 
    pointSize = 6,  
    pCutoff = 0.00000146, 
    xlim = c((min(allMarkers$avg_log2FC)-0.5), 
    (max(allMarkers$avg_log2FC)+0.5)), 
    titleLabSize = 20, 
    subtitleLabSize = 18, 
    captionLabSize = 20, 
    axisLabSize = 28)
ggsave(filename = output_file_immune_cell, plot = evp, width = 11, height = 8, dpi = 600)

```
#### Bronchi
### Annotated Immune Cells- by Age_bin: Infant _ Figure 1e
```{r}
outPath.BCells.woImmune.Yoshida <- outPath.Epithelial.Yoshida
YoshRef.Epi.woImmune.Infant <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Infant")
plot_woImmune_cell <- DimPlot(YoshRef.Epi.woImmune.Infant, group.by = "majorAnnot", raster = FALSE) + ggtitle("woImmune Cells")

# Get unique woImmune cell types
woImmune_cell_types <- unique(YoshRef.Epi.woImmune.Infant$majorAnnot)
majorCols <- c("Basal" = "red", 
    "SecGob" = "purple", 
    "Ciliated" = "olivedrab1", 
    "RareCells" = "magenta")

# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use custom_colors here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 14),   # Enlarge legend text
    legend.title = element_text(size = 16)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Infant.Bronchi.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use custom_colors here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 0),   # Enlarge legend text
    legend.title = element_text(size = 0)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Infant.noLegend.Bronchi.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
```

 
### Annotated Immune Cells- by Age_bin: Infant _ Figure 1e
```{r}
outPath.BCells.woImmune.Yoshida <- outPath.Epithelial.Yoshida
YoshRef.Epi.woImmune.Neonate <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Neonate")
plot_woImmune_cell <- DimPlot(YoshRef.Epi.woImmune.Neonate, group.by = "majorAnnot", raster = FALSE) + ggtitle("woImmune Cells")

# Get unique woImmune cell types
woImmune_cell_types <- unique(YoshRef.Epi.woImmune.Neonate$majorAnnot)
majorCols <- c("Basal" = "red", 
    "SecGob" = "purple", 
    "Ciliated" = "olivedrab1", 
    "RareCells" = "magenta")

# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use custom_colors here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 14),   # Enlarge legend text
    legend.title = element_text(size = 16)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Neonate.Bronchi.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use custom_colors here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 0),   # Enlarge legend text
    legend.title = element_text(size = 0)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Neonate.noLegend.Bronchi.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
```

### Annotated woImmune Cells- by Age_bin: Young child _ Figure 1e
```{r}
YoshRef.Epi.woImmune.YC <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Young child")
plot_woImmune_cell <- DimPlot(YoshRef.Epi.woImmune.YC, group.by = "majorAnnot", raster = FALSE) + ggtitle("woImmune Cells")

# Get unique woImmune cell types
woImmune_cell_types <- unique(YoshRef.Epi.woImmune.YC$majorAnnot)

# Define the custom color palette
majorCols <- c("Basal" = "red", 
    "SecGob" = "purple", 
    "Ciliated" = "olivedrab1", 
    "RareCells" = "magenta")

# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use majorCols here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 14),   # Enlarge legend text
    legend.title = element_text(size = 16)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Young_child.Bronchi.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use majorCols here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 0),   # Enlarge legend text
    legend.title = element_text(size = 0)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Young_child.noLegend.Bronchi.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
```
  
### Annotated woImmune Cells- by Age_bin: Child _ Figure 1e
```{r}
YoshRef.Epi.woImmune.Child <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Child")
plot_woImmune_cell <- DimPlot(YoshRef.Epi.woImmune.Child, group.by = "majorAnnot", raster = FALSE) + ggtitle("woImmune Cells")

# Get unique woImmune cell types
woImmune_cell_types <- unique(YoshRef.Epi.woImmune.Child$majorAnnot)

# Define the custom color palette
majorCols <- c("Basal" = "red", 
    "SecGob" = "purple", 
    "Ciliated" = "olivedrab1", 
    "RareCells" = "magenta")


# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use majorCols here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 14),   # Enlarge legend text
    legend.title = element_text(size = 16)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Child.Bronchi.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use majorCols here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 0),   # Enlarge legend text
    legend.title = element_text(size = 0)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Child.noLegend.Bronchi.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
```

### Annotated woImmune Cells- by Age_bin: Adolescent _ Figure 1e
```{r}
YoshRef.Epi.woImmune.Adolescent <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Adolescent")
plot_woImmune_cell <- DimPlot(YoshRef.Epi.woImmune.Adolescent, group.by = "majorAnnot", raster = FALSE) + ggtitle("woImmune Cells")

# Get unique woImmune cell types
woImmune_cell_types <- unique(YoshRef.Epi.woImmune.Adolescent$majorAnnot)

# Define the custom color palette
majorCols <- c("Basal" = "red", 
    "SecGob" = "purple", 
    "Ciliated" = "olivedrab1", 
    "RareCells" = "magenta")


# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use majorCols here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 14),   # Enlarge legend text
    legend.title = element_text(size = 16)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Adolescent.Bronchi.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use majorCols here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 0),   # Enlarge legend text
    legend.title = element_text(size = 0)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Adolescent.noLegend.Bronchi.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
```

#### Nose
### Annotated Immune Cells- by Age_bin: Infant _ Figure 1e
```{r}
outPath.BCells.woImmune.Yoshida <- outPath.Epithelial.Yoshida
YoshRef.Epi.woImmune.Infant <- subset(YoshRef.comb.woImmune.Nose, subset = Age_donor == "Infant")
plot_woImmune_cell <- DimPlot(YoshRef.Epi.woImmune.Infant, group.by = "majorAnnot", raster = FALSE) + ggtitle("woImmune Cells")

# Get unique woImmune cell types
woImmune_cell_types <- unique(YoshRef.Epi.woImmune.Infant$majorAnnot)
majorCols <- c("Basal" = "red", 
    "SecGob" = "purple", 
    "Ciliated" = "olivedrab1", 
    "RareCells" = "magenta")

# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use custom_colors here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 14),   # Enlarge legend text
    legend.title = element_text(size = 16)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Infant.Nose.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use custom_colors here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 0),   # Enlarge legend text
    legend.title = element_text(size = 0)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Infant.noLegend.Nose.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
```

 
### Annotated Immune Cells- by Age_bin: Infant _ Figure 1e
```{r}
outPath.BCells.woImmune.Yoshida <- outPath.Epithelial.Yoshida
YoshRef.Epi.woImmune.Neonate <- subset(YoshRef.comb.woImmune.Nose, subset = Age_donor == "Neonate")
plot_woImmune_cell <- DimPlot(YoshRef.Epi.woImmune.Neonate, group.by = "majorAnnot", raster = FALSE) + ggtitle("woImmune Cells")

# Get unique woImmune cell types
woImmune_cell_types <- unique(YoshRef.Epi.woImmune.Neonate$majorAnnot)
majorCols <- c("Basal" = "red", 
    "SecGob" = "purple", 
    "Ciliated" = "olivedrab1", 
    "RareCells" = "magenta")

# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use custom_colors here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 14),   # Enlarge legend text
    legend.title = element_text(size = 16)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Neonate.Nose.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use custom_colors here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 0),   # Enlarge legend text
    legend.title = element_text(size = 0)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Neonate.noLegend.Nose.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
```

### Annotated woImmune Cells- by Age_bin: Young child _ Figure 1e
```{r}
YoshRef.Epi.woImmune.YC <- subset(YoshRef.comb.woImmune.Nose, subset = Age_donor == "Young child")
plot_woImmune_cell <- DimPlot(YoshRef.Epi.woImmune.YC, group.by = "majorAnnot", raster = FALSE) + ggtitle("woImmune Cells")

# Get unique woImmune cell types
woImmune_cell_types <- unique(YoshRef.Epi.woImmune.YC$majorAnnot)

# Define the custom color palette
majorCols <- c("Basal" = "red", 
    "SecGob" = "purple", 
    "Ciliated" = "olivedrab1", 
    "RareCells" = "magenta")

# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use majorCols here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 14),   # Enlarge legend text
    legend.title = element_text(size = 16)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Young_child.Nose.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use majorCols here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 0),   # Enlarge legend text
    legend.title = element_text(size = 0)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Young_child.noLegend.Nose.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
```
  
### Annotated woImmune Cells- by Age_bin: Child _ Figure 1e
```{r}
YoshRef.Epi.woImmune.Child <- subset(YoshRef.comb.woImmune.Nose, subset = Age_donor == "Child")
plot_woImmune_cell <- DimPlot(YoshRef.Epi.woImmune.Child, group.by = "majorAnnot", raster = FALSE) + ggtitle("woImmune Cells")

# Get unique woImmune cell types
woImmune_cell_types <- unique(YoshRef.Epi.woImmune.Child$majorAnnot)

# Define the custom color palette
majorCols <- c("Basal" = "red", 
    "SecGob" = "purple", 
    "Ciliated" = "olivedrab1", 
    "RareCells" = "magenta")


# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use majorCols here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 14),   # Enlarge legend text
    legend.title = element_text(size = 16)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Child.Nose.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use majorCols here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 0),   # Enlarge legend text
    legend.title = element_text(size = 0)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Child.noLegend.Nose.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
```
### Annotated woImmune Cells- by Age_bin: Adolescent _ Figure 1e
```{r}
YoshRef.Epi.woImmune.Adolescent <- subset(YoshRef.comb.woImmune.Nose, subset = Age_donor == "Adolescent")
plot_woImmune_cell <- DimPlot(YoshRef.Epi.woImmune.Adolescent, group.by = "majorAnnot", raster = FALSE) + ggtitle("woImmune Cells")

# Get unique woImmune cell types
woImmune_cell_types <- unique(YoshRef.Epi.woImmune.Adolescent$majorAnnot)

# Define the custom color palette
majorCols <- c("Basal" = "red", 
    "SecGob" = "purple", 
    "Ciliated" = "olivedrab1", 
    "RareCells" = "magenta")


# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use majorCols here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 14),   # Enlarge legend text
    legend.title = element_text(size = 16)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Adolescent.Nose.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use majorCols here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 0),   # Enlarge legend text
    legend.title = element_text(size = 0)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Adolescent.noLegend.Nose.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
```

### Cell Percentage _ Figure 1f
```{r Percentage_composition}
#YoshRef.comb <- YoshRef.comb.modScore3
Idents(YoshRef.comb) <- "majorAnnot"
YoshRef.comb@meta.data$sampleLoc_ageDonor <- paste(YoshRef.comb@meta.data$Samp.loc, 
    "_", YoshRef.comb@meta.data$Age_donor, sep = "")

'YoshRef.comb@active.ident = factor(YoshRef.comb@active.ident, 
    labels = c("Basal", "SecGob", "Ciliated", "RareCells"))
YoshRef.comb@meta.data$Samp.loc = factor(YoshRef.comb@meta.data$Samp.loc, 
    labels = c("Nose", "Bronchi"))'
pt <- data.frame(t(table(YoshRef.comb@meta.data$sampleLoc_ageDonor, Idents(YoshRef.comb))))
pt1 <- data.frame(t(table(YoshRef.comb@meta.data$sampleLoc_ageDonor)))
dat <- full_join(pt, pt1, by = "Var2")
dat.percentofSamples_SampLoc_cellType <- data.frame(celltype = dat$Var1.x, SampleLocation_AgeGroup = dat$Var2, NumberofCells_Condition = dat$Freq.x, NumberofCells_celltype = dat$Freq.y)
dat.percentofSamples_SampLoc_cellType$PercentofCells_per_SampLoc = round(((dat.percentofSamples_SampLoc_cellType$NumberofCells_Condition/dat.percentofSamples_SampLoc_cellType$NumberofCells_celltype)*100),2)
write.csv(dat.percentofSamples_SampLoc_cellType, file.path(outPath.Epithelial.Yoshida, "YoshRef.NasalBronchial.CellPercentage.csv"))

cols_plot = c(
    "Bronchi_Adolescent" = "dodgerblue", 
    "Bronchi_Child" = "deepskyblue", 
    "Bronchi_Infant" = "dodgerblue4", 
    "Bronchi_Neonate" = "lightblue1",
    "Bronchi_Young child" = "midnightblue", 
    "Nose_Adolescent" = "firebrick", 
    "Nose_Child" = "brown4",
    "Nose_Infant" = "coral2", 
    "Nose_Neonate" = "indianred3", 
    "Nose_Young child" = "violetred1"
)
dat.percentofSamples_SampLoc_cellType$SampleLocation_AgeGroup <- factor(
    dat.percentofSamples_SampLoc_cellType$SampleLocation_AgeGroup,
    levels = c("Bronchi_Neonate", "Nose_Neonate",
    "Bronchi_Infant", "Nose_Infant",
    "Bronchi_Young child", "Nose_Young child",
    "Bronchi_Child", "Nose_Child", 
    "Bronchi_Adolescent", "Nose_Adolescent"
))
#BabyvsAdult.ALI.INF.repl1<- BabyvsAdult.ALI.INF.repl
#dat.percentofSamples_AgeRange_cellType$AgeRange <- factor(dat.percentofSamples_AgeRange_cellType$AgeRange, levels = c("Infant", "Young child",  "Child", "Adolescent"))
#pdf(file.path(outpath, "BabyvsAdult.ALI.INF_annotated_replicates.celltype.pdf"), width = 11, height = 9)
#pdf(file.path(outPath.BCells.Immune.Yoshida, "YoshRef.BCells.Immune.majorCellType.pdf"), width = 18, height = 16)
#outPath.BCells.Immune.Yoshida = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/Results/0.3.RNAAssay/Results/0.3.RNAAssay.Figures"
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(dat.percentofSamples_SampLoc_cellType, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation_AgeGroup)) + 
    labs(title = "", x = "SampleLocation AgeGroup", y = "% of Cells") + 
    geom_bar(stat="identity", position=position_dodge()) + 
    scale_fill_manual(values= cols_plot) +
    theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold",),
        axis.text.x = element_text(size = 14, face = "bold",),
        axis.text.y = element_text(size = 14,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.barPlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 7, height = 4, dpi = 600)

plot.stack <- ggplot(dat.percentofSamples_SampLoc_cellType, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation_AgeGroup)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values= cols_plot) +
  labs(title = "",
       x = "SampleLocation AgeGroup",
       y = "% of Cells") +
  theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) 

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.stackplot.png")
ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)
plot.stack <- ggplot(dat.percentofSamples_SampLoc_cellType, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation_AgeGroup)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values= cols_plot) +
  labs(title = "",
       x = "SampleLocation AgeGroup",
       y = "% of Cells") +
  theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.stackPlot.co_ordFlip.png")
ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)
```
### Cell Percentage _ Figure 1f
```{r Percentage_composition.preprocess}
sampInfo <- dat.percentofSamples_SampLoc_cellType
st <- strsplit(as.character(sampInfo$SampleLocation_AgeGroup), split = "_")
sampInfo$SampleLocation <- sapply(st, "[[", 1)
sampInfo$AgeGroup <- sapply(st, "[[", 2)
```
```{r Percentage_composition.Neonate}
sampInfo.Neonate <- sampInfo[which(sampInfo$AgeGroup == "Neonate"),]
sampInfo.Neonate$celltype <- factor(sampInfo.Neonate$celltype,
    levels = c("Basal", "SecGob", "Ciliated", "RareCells"))
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(sampInfo.Neonate, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation)) + 
    labs(title = "", x = "SampleLocation", y = "% of Cells") + 
    geom_bar(stat="identity", position=position_dodge()) + 
    scale_fill_manual(values= cols_plot) +
    theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold",),
        axis.text.x = element_text(size = 14, face = "bold",),
        axis.text.y = element_text(size = 14,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.Neonate.barPlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 7, height = 4, dpi = 600)

plot.stack <- ggplot(sampInfo.Neonate, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values= cols_plot) +
  labs(title = "",
       x = "SampleLocation AgeGroup",
       y = "% of Cells") +
  theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) 

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.Neonate.stackplot.png")
ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)

pplot.stack <- ggplot(sampInfo.Neonate, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values= cols_plot) +
  labs(title = "",
       x = "SampleLocation AgeGroup",
       y = "% of Cells") +
  theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.Neonate.stackPlot.co_ordFlip.png")
ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)
```


```{r Percentage_composition.Infant}
sampInfo.Infant <- sampInfo[which(sampInfo$AgeGroup == "Infant"),]
sampInfo.Infant$celltype <- factor(sampInfo.Infant$celltype,
    levels = c("Basal", "SecGob", "Ciliated", "RareCells"))
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(sampInfo.Infant, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation)) + 
    labs(title = "", x = "SampleLocation", y = "% of Cells") + 
    geom_bar(stat="identity", position=position_dodge()) + 
    scale_fill_manual(values= cols_plot) +
    theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold",),
        axis.text.x = element_text(size = 14, face = "bold",),
        axis.text.y = element_text(size = 14,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.Infant.barPlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 7, height = 4, dpi = 600)

plot.stack <- ggplot(sampInfo.Infant, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values= cols_plot) +
  labs(title = "",
       x = "SampleLocation AgeGroup",
       y = "% of Cells") +
  theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) 

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.Infant.stackplot.png")
ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)

pplot.stack <- ggplot(sampInfo.Infant, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values= cols_plot) +
  labs(title = "",
       x = "SampleLocation AgeGroup",
       y = "% of Cells") +
  theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.Infant.stackPlot.co_ordFlip.png")
ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)
```

```{r Percentage_composition.YC}
sampInfo.YC <- sampInfo[which(sampInfo$AgeGroup == "Young child"),]
sampInfo.YC$celltype <- factor(sampInfo.YC$celltype,
    levels = c("Basal", "SecGob", "Ciliated", "RareCells"))
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(sampInfo.YC, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation)) + 
    labs(title = "", x = "SampleLocation", y = "% of Cells") + 
    geom_bar(stat="identity", position=position_dodge()) + 
    scale_fill_manual(values= cols_plot) +
    theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold",),
        axis.text.x = element_text(size = 14, face = "bold",),
        axis.text.y = element_text(size = 14,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.YC.barPlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 7, height = 4, dpi = 600)

plot.stack <- ggplot(sampInfo.YC, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values= cols_plot) +
  labs(title = "",
       x = "SampleLocation AgeGroup",
       y = "% of Cells") +
  theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) 

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.YC.stackplot.png")
ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)

pplot.stack <- ggplot(sampInfo.YC, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values= cols_plot) +
  labs(title = "",
       x = "SampleLocation AgeGroup",
       y = "% of Cells") +
  theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.YC.stackPlot.co_ordFlip.png")
ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)
```


```{r Percentage_composition.Child}
sampInfo.Child <- sampInfo[which(sampInfo$AgeGroup == "Child"),]
sampInfo.Child$celltype <- factor(sampInfo.Child$celltype,
    levels = c("Basal", "SecGob", "Ciliated", "RareCells"))
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(sampInfo.Child, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation)) + 
    labs(title = "", x = "SampleLocation", y = "% of Cells") + 
    geom_bar(stat="identity", position=position_dodge()) + 
    scale_fill_manual(values= cols_plot) +
    theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold",),
        axis.text.x = element_text(size = 14, face = "bold",),
        axis.text.y = element_text(size = 14,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.Child.barPlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 7, height = 4, dpi = 600)

plot.stack <- ggplot(sampInfo.Child, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values= cols_plot) +
  labs(title = "",
       x = "SampleLocation AgeGroup",
       y = "% of Cells") +
  theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) 

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.Child.stackplot.png")
ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)

pplot.stack <- ggplot(sampInfo.Child, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values= cols_plot) +
  labs(title = "",
       x = "SampleLocation AgeGroup",
       y = "% of Cells") +
  theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.Child.stackPlot.co_ordFlip.png")
ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)
```

```{r Percentage_composition.Adolescent}
sampInfo.Adolescent <- sampInfo[which(sampInfo$AgeGroup == "Adolescent"),]
sampInfo.Adolescent$celltype <- factor(sampInfo.Adolescent$celltype,
    levels = c("Basal", "SecGob", "Ciliated", "RareCells"))
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(sampInfo.Adolescent, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation)) + 
    labs(title = "", x = "SampleLocation", y = "% of Cells") + 
    geom_bar(stat="identity", position=position_dodge()) + 
    scale_fill_manual(values= cols_plot) +
    theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold",),
        axis.text.x = element_text(size = 14, face = "bold",),
        axis.text.y = element_text(size = 14,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.Adolescent.barPlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 7, height = 4, dpi = 600)

plot.stack <- ggplot(sampInfo.Adolescent, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values= cols_plot) +
  labs(title = "",
       x = "SampleLocation AgeGroup",
       y = "% of Cells") +
  theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) 

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.Adolescent.stackplot.png")
ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)

pplot.stack <- ggplot(sampInfo.Adolescent, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values= cols_plot) +
  labs(title = "",
       x = "SampleLocation AgeGroup",
       y = "% of Cells") +
  theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.Adolescent.stackPlot.co_ordFlip.png")
ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)
```
```{r Percentage_composition.SecGob}
sampInfo.SecGob <- sampInfo[which(sampInfo$celltype == "SecGob"),]
sampInfo.SecGob$AgeGroup <- factor(sampInfo.SecGob$AgeGroup,
    levels = c("Neonate", "Infant", "Young child", "Child", "Adolescent"))
sampInfo.SecGob$SampleLocation <- factor(sampInfo.SecGob$SampleLocation,
    levels = c("Nasal", "Bronchial"))
cols_plot = c(
    "Nasal" = "coral1", 
    "Bronchial" = "blue")
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(sampInfo.SecGob, aes(x = AgeGroup, 
    y = PercentofCells_per_SampLoc, group = SampleLocation, color = SampleLocation)) + 
    geom_line(aes(group = SampleLocation), linewidth = 2) + 
	geom_point(aes(group = SampleLocation), size = 5) +
    ylab("% cells per Location") +
	theme(axis.title.x = element_text(size = 30, face = "bold"),
        axis.title.y = element_text(size = 30, face = "bold",),
        axis.text.x = element_text(size = 25, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 25,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 20, face = "bold")) 
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.SecGob.linePlot1.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 14, height = 7, dpi = 600)
```

```{r Percentage_composition.Ciliated}
sampInfo.Ciliated <- sampInfo[which(sampInfo$celltype == "Ciliated"),]
sampInfo.Ciliated$AgeGroup <- factor(sampInfo.Ciliated$AgeGroup,
    levels = c("Neonate", "Infant", "Young child", "Child", "Adolescent"))
sampInfo.Ciliated$SampleLocation <- factor(sampInfo.Ciliated$SampleLocation,
    levels = c("Nasal", "Bronchial"))
cols_plot = c(
    "Nasal" = "coral1", 
    "Bronchial" = "blue")
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(sampInfo.Ciliated, aes(x = AgeGroup, 
    y = PercentofCells_per_SampLoc, group = SampleLocation, color = SampleLocation)) + 
    ylab("% cells per Location") +
    geom_line(aes(group = SampleLocation), linewidth = 2) + 
	geom_point(aes(group = SampleLocation), size = 5) +
	theme(axis.title.x = element_text(size = 30, face = "bold"),
        axis.title.y = element_text(size = 30, face = "bold",),
        axis.text.x = element_text(size = 25, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 25,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 20, face = "bold")) 
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.Ciliated.linePlot1.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 14, height = 7, dpi = 600)
```
```{r Percentage_composition.Basal}
sampInfo.Basal <- sampInfo[which(sampInfo$celltype == "Basal"),]
sampInfo.Basal$AgeGroup <- factor(sampInfo.Basal$AgeGroup,
    levels = c("Neonate", "Infant", "Young child", "Child", "Adolescent"))
sampInfo.Basal$SampleLocation <- factor(sampInfo.Basal$SampleLocation,
    levels = c("Nasal", "Bronchial"))
cols_plot = c(
    "Nasal" = "coral1", 
    "Bronchial" = "blue")
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(sampInfo.Basal, aes(x = AgeGroup, 
    y = PercentofCells_per_SampLoc, group = SampleLocation, color = SampleLocation)) + 
    geom_line(aes(group = SampleLocation), linewidth = 2) + 
	ylab("% cells per Location") +
	geom_point(aes(group = SampleLocation), size = 5) +
    theme(axis.title.x = element_text(size = 30, face = "bold"),
        axis.title.y = element_text(size = 30, face = "bold",),
        axis.text.x = element_text(size = 25, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 25,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 20, face = "bold")) 
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.Basal.linePlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 14, height = 7, dpi = 600)
```

```{r Ratio_composition.Basal}
sampInfo.ratio <- read.csv("/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples/SampInfo.Ratio.SecGob_vs_Ciliated.csv")

sampInfo.ratio$AgeGroup <- factor(sampInfo.ratio$AgeGroup,
    levels = c("Neonate", "Infant", "Young child", "Child", "Adolescent"))
sampInfo.ratio$SampleLocation <- factor(sampInfo.ratio$SampleLocation,
    levels = c("Nasal", "Bronchial"))
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(sampInfo.ratio, aes(x = AgeGroup, 
    y = Ratio.SecGob_Ciliated, group = SampleLocation, color = SampleLocation)) + 
    geom_line(aes(group = SampleLocation), linewidth = 2) + 
	geom_point(aes(group = SampleLocation), size = 5) +
	xlab("Age Group") + ylab("SecGob/Ciliated") +
    theme(axis.title.x = element_text(size = 30, face = "bold"),
        axis.title.y = element_text(size = 30, face = "bold",),
        axis.text.x = element_text(size = 25, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 25,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 20, face = "bold"))  
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.SecGobCiliatedRatio.linePlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 14, height = 7, dpi = 600)
```
### Cell Percentage _ Figure 1f
```{r Percentage_composition}
#YoshRef.comb <- YoshRef.comb.modScore3
Idents(YoshRef.comb) <- "majorAnnot"
YoshRef.comb@meta.data$sampleLoc_ageDonor <- paste(YoshRef.comb@meta.data$Samp.loc, 
    "_", YoshRef.comb@meta.data$Age_donor, sep = "")

'YoshRef.comb@active.ident = factor(YoshRef.comb@active.ident, 
    labels = c("Basal", "SecGob", "Ciliated", "RareCells"))
YoshRef.comb@meta.data$Samp.loc = factor(YoshRef.comb@meta.data$Samp.loc, 
    labels = c("Nose", "Bronchi"))'
pt <- data.frame(t(table(YoshRef.comb@meta.data$sampleLoc_ageDonor, Idents(YoshRef.comb))))
pt1 <- data.frame(t(table(YoshRef.comb@meta.data$sampleLoc_ageDonor)))
dat <- full_join(pt, pt1, by = "Var2")
dat.percentofSamples_SampLoc_cellType <- data.frame(celltype = dat$Var1.x, SampleLocation_AgeGroup = dat$Var2, NumberofCells_Condition = dat$Freq.x, NumberofCells_celltype = dat$Freq.y)
dat.percentofSamples_SampLoc_cellType$PercentofCells_per_SampLoc = round(((dat.percentofSamples_SampLoc_cellType$NumberofCells_Condition/dat.percentofSamples_SampLoc_cellType$NumberofCells_celltype)*100),2)
write.csv(dat.percentofSamples_SampLoc_cellType, file.path(outPath.Epithelial.Yoshida, "YoshRef.NasalBronchial.CellPercentage.csv"))
cols_plot = c(
    "Bronchi_Adolescent" = "dodgerblue", 
    "Bronchi_Child" = "deepskyblue", 
    "Bronchi_Infant" = "dodgerblue4", 
    "Bronchi_Neonate" = "lightblue1",
    "Bronchi_Young child" = "midnightblue", 
    "Nose_Adolescent" = "firebrick", 
    "Nose_Child" = "brown4",
    "Nose_Infant" = "coral2", 
    "Nose_Neonate" = "indianred3", 
    "Nose_Young child" = "violetred1"
)
dat.percentofSamples_SampLoc_cellType$SampleLocation_AgeGroup <- factor(
    dat.percentofSamples_SampLoc_cellType$SampleLocation_AgeGroup,
    levels = c("Bronchi_Neonate", "Nose_Neonate",
    "Bronchi_Infant", "Nose_Infant",
    "Bronchi_Young child", "Nose_Young child",
    "Bronchi_Child", "Nose_Child", 
    "Bronchi_Adolescent", "Nose_Adolescent"
))
#BabyvsAdult.ALI.INF.repl1<- BabyvsAdult.ALI.INF.repl
#dat.percentofSamples_AgeRange_cellType$AgeRange <- factor(dat.percentofSamples_AgeRange_cellType$AgeRange, levels = c("Infant", "Young child",  "Child", "Adolescent"))
#pdf(file.path(outpath, "BabyvsAdult.ALI.INF_annotated_replicates.celltype.pdf"), width = 11, height = 9)
#pdf(file.path(outPath.BCells.Immune.Yoshida, "YoshRef.BCells.Immune.majorCellType.pdf"), width = 18, height = 16)
#outPath.BCells.Immune.Yoshida = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/Results/0.3.RNAAssay/Results/0.3.RNAAssay.Figures"
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(dat.percentofSamples_SampLoc_cellType, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation_AgeGroup)) + 
    labs(title = "", x = "SampleLocation AgeGroup", y = "% of Cells") + 
    geom_bar(stat="identity", position=position_dodge()) + 
    scale_fill_manual(values= cols_plot) +
    theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold",),
        axis.text.x = element_text(size = 14, face = "bold",),
        axis.text.y = element_text(size = 14,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.barPlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 7, height = 4, dpi = 600)

plot.stack <- ggplot(dat.percentofSamples_SampLoc_cellType, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation_AgeGroup)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values= cols_plot) +
  labs(title = "",
       x = "SampleLocation AgeGroup",
       y = "% of Cells") +
  theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) 

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.stackplot.png")
ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)
plot.stack <- ggplot(dat.percentofSamples_SampLoc_cellType, aes(x = celltype, 
    y = PercentofCells_per_SampLoc, fill = SampleLocation_AgeGroup)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values= cols_plot) +
  labs(title = "",
       x = "SampleLocation AgeGroup",
       y = "% of Cells") +
  theme(axis.title.x = element_text(size = 20, face = "bold"),
        axis.title.y = element_text(size = 20, face = "bold"),
        axis.text.x = element_text(size = 14, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 14, face = "bold")) + coord_flip()

# Print the plot
print(plot.stack)

# Save the plot to the specified directory using the plot object directly
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.majorCellType.stackPlot.co_ordFlip.png")
ggsave(filename = output_file_immune_cell, plot = plot.stack, width = 7, height = 4, dpi = 600)
```
```{r}
# Specify the markers

# Specify the markers
'markers <- c("MS4A1", "FCER2", "COL19A1", "CD27", "CD38", "FCRL3", "FCRL4",
                         "FCRL5",  "CAMK1", "MKI67", "AICDA", "MCM2",
                         "CHPF", "IGHG1", "IGKC", "IGLC2", "PAX5")'
Bronchial = c("MARCO", "FABP4", "SFTA3", "NKX2-1")
YoshRef.comb.Bronchi <- subset(YoshRef.comb, Samp.loc == "Bronchi")
# Create the dot plot
#dot_plot <- DotPlot(YoshRef.BCells.woImmune.norm.Cluster, features = markers, group.by =  "majorAnnot.woImmune") + 
  
DP <- DotPlot(YoshRef.comb.Bronchi, features = Bronchial, group.by =  "majorAnnot", assay = "RNA",  dot.scale = 10) +scale_color_gradient(low = "grey", high = "blue")  + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1, size = 20, face = "bold"), 
        axis.text.y = element_text(size = 20, face = "bold"), 
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.title = element_text(size = 24, face = "bold"),
        legend.text = element_text(size = 20, face = "bold"))

# Print the dot plot
print(DP)

# Save the dot plot
output_dir <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
if (!dir.exists(output_dir)) {
  dir.create(output_dir, recursive = TRUE)
}
ggsave(filename = file.path(output_dir, "Bronchial_Cell_Markers_DotPlot.png"), plot = DP, width = 12, height = 6, dpi = 600)

VP <- VlnPlot(YoshRef.comb.Bronchi, features = Bronchial, group.by =  "majorAnnot", split.by = "Samp.loc", assay = "RNA", split.plot = TRUE) +scale_color_gradient(low = "grey", high = "blue")  + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1, size = 20, face = "bold"), 
        axis.text.y = element_text(size = 20, face = "bold"), 
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.title = element_text(size = 24, face = "bold"),
        legend.text = element_text(size = 20, face = "bold"))

# Print the dot plot
print(VP)

# Save the dot plot
output_dir <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
if (!dir.exists(output_dir)) {
  dir.create(output_dir, recursive = TRUE)
}
ggsave(filename = file.path(output_dir, "Bronchial_Cell_Markers_VlnPlot.png"), plot = VP, width = 12, height = 6, dpi = 600)

```


```{r}
# Specify the markers

# Specify the markers
'markers <- c("MS4A1", "FCER2", "COL19A1", "CD27", "CD38", "FCRL3", "FCRL4",
                         "FCRL5",  "CAMK1", "MKI67", "AICDA", "MCM2",
                         "CHPF", "IGHG1", "IGKC", "IGLC2", "PAX5")'
Nasal = c("FOXG1", "PAX7", "OTX2", "SIX3", "SP8", "PAX3")
YoshRef.comb.Nose <- subset(YoshRef.comb, Samp.loc == "Nose")
# Create the dot plot
#dot_plot <- DotPlot(YoshRef.BCells.woImmune.norm.Cluster, features = markers, group.by =  "majorAnnot.woImmune") + 
  
DP <- DotPlot(YoshRef.comb.Nose, features = Nasal, group.by =  "majorAnnot", assay = "RNA",  dot.scale = 10) +scale_color_gradient(low = "grey", high = "blue")  + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1, size = 20, face = "bold"), 
        axis.text.y = element_text(size = 20, face = "bold"), 
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.title = element_text(size = 24, face = "bold"),
        legend.text = element_text(size = 20, face = "bold"))

# Print the dot plot
print(DP)

# Save the dot plot
output_dir <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
if (!dir.exists(output_dir)) {
  dir.create(output_dir, recursive = TRUE)
}
ggsave(filename = file.path(output_dir, "Nasal_Cell_Markers_DotPlot.png"), plot = DP, width = 12, height = 6, dpi = 600)

VP <- VlnPlot(YoshRef.comb.Nose, features = Nasal, group.by =  "majorAnnot", split.by = "Samp.loc", assay = "RNA", split.plot = TRUE) +scale_color_gradient(low = "grey", high = "blue")  + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1, size = 20, face = "bold"), 
        axis.text.y = element_text(size = 20, face = "bold"), 
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.title = element_text(size = 24, face = "bold"),
        legend.text = element_text(size = 20, face = "bold"))

# Print the dot plot
print(VP)

# Save the dot plot
output_dir <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
if (!dir.exists(output_dir)) {
  dir.create(output_dir, recursive = TRUE)
}
ggsave(filename = file.path(output_dir, "Nasal_Cell_Markers_VlnPlot.png"), plot = VP, width = 12, height = 6, dpi = 600)

```


```{r Infant_GobNetwork} 
'YoshRef.Epi.woImmune.Neonate.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Neonate")
YoshRef.Epi.woImmune.Infant.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Infant")
YoshRef.Epi.woImmune.YC.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Young child")
YoshRef.Epi.woImmune.Child.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Child")
YoshRef.Epi.woImmune.Adolescent.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Adolescent")'
GobNetwork.Core <- c("NKX2-1", "FOXA2", "SPDEF", "FOXA3", "MUC5AC")
GobNetwork.Core <- list(GobNetwork.Core)
###Nose
YoshRef.Neonate.Nose.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Neonate.Nose, features = GobNetwork.Core, assay = "RNA", name = "GobNetwork")
YoshRef.Infant.Nose.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Infant.Nose, features = GobNetwork.Core, assay = "RNA", name = "GobNetwork")
YoshRef.YC.Nose.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.YC.Nose, features = GobNetwork.Core, assay = "RNA", name = "GobNetwork")
YoshRef.Child.Nose.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Child.Nose, features = GobNetwork.Core, assay = "RNA", name = "GobNetwork")
YoshRef.Adolescent.Nose.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Adolescent.Nose, features = GobNetwork.Core, assay = "RNA", name = "GobNetwork")
###Bronchi
YoshRef.Neonate.Bronchi.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Neonate.Bronchi, features = GobNetwork.Core, assay = "RNA", name = "GobNetwork")
YoshRef.Infant.Bronchi.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Infant.Bronchi, features = GobNetwork.Core, assay = "RNA", name = "GobNetwork")
YoshRef.YC.Bronchi.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.YC.Bronchi, features = GobNetwork.Core, assay = "RNA", name = "GobNetwork")
YoshRef.Child.Bronchi.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Child.Bronchi, features = GobNetwork.Core, assay = "RNA", name = "GobNetwork")
YoshRef.Adolescent.Bronchi.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Adolescent.Bronchi, features = GobNetwork.Core, assay = "RNA", name = "GobNetwork")
```

```{r Nose_Neonate}

#majorCols <- c("Basal" = "red", "SecGob" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
maxScore = max(c(YoshRef.Neonate.Nose.modScore3@meta.data$GobNetwork,  YoshRef.Infant.Nose.modScore3@meta.data$GobNetwork, YoshRef.YC.Nose.modScore3@meta.data$GobNetwork, YoshRef.Child.Nose.modScore3@meta.data$GobNetwork, YoshRef.Adolescent.Nose.modScore3@meta.data$GobNetwork)); minScore = min(c(YoshRef.Neonate.Nose.modScore3@meta.data$GobNetwork,  YoshRef.Infant.Nose.modScore3@meta.data$GobNetwork, YoshRef.YC.Nose.modScore3@meta.data$GobNetwork, YoshRef.Child.Nose.modScore3@meta.data$GobNetwork, YoshRef.Adolescent.Nose.modScore3@meta.data$GobNetwork))
# +   scale_color_distiller(palette = "RdYlBu") +
majorCols <- c("Basal" = "red", 
    "SecGob" = "purple", 
    "Ciliated" = "olivedrab1", 
    "RareCells" = "magenta")


Idents(YoshRef.Neonate.Nose.modScore3) <- "majorAnnot"
pas9 <- "YoshRef.Neonate.Nose.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Neonate.Nose.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef.Neonate.Nose.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.Neonate.Nose.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
#
YoshRef.Neonate.Nose <- YoshRef.Neonate.Nose.modScore3
YoshRef.Neonate.Nose@active.ident <- factor(YoshRef.Neonate.Nose@active.ident, levels =c("Basal", "SecGob", "Ciliated", "RareCells"))
VPfname <- "YoshRef_Neonate.VP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.Neonate.Nose, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) +
  theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
RPfname <- "YoshRef_Neonate.RP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, RPfname), width = 11, height = 10, units = "in", res = 600)
rdg1 <- RidgePlot(YoshRef.Neonate.Nose.modScore3, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) + 
  scale_x_discrete(labels = c("Basal", "SecGob", "Ciliated", "RareCells")) +
 theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(rdg1)
dev.off()
```

```{r Nose_Infant}

Idents(YoshRef.Infant.Nose.modScore3) <- "majorAnnot"
pas9 <- "YoshRef.Infant.Nose.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Infant.Nose.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef.Infant.Nose.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.Infant.Nose.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
#
YoshRef.Infant.Nose <- YoshRef.Infant.Nose.modScore3
YoshRef.Infant.Nose@active.ident <- factor(YoshRef.Infant.Nose@active.ident, levels =c("Basal", "SecGob", "Ciliated", "RareCells"))
VPfname <- "YoshRef_Infant.VP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.Infant.Nose, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) +
  theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
RPfname <- "YoshRef_Infant.RP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, RPfname), width = 11, height = 10, units = "in", res = 600)
rdg1 <- RidgePlot(YoshRef.Infant.Nose.modScore3, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) + 
  scale_x_discrete(labels = c("Basal", "SecGob", "Ciliated", "RareCells")) +
 theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(rdg1)
dev.off()
```
```{r Basal_YC}

Idents(YoshRef.YC.Nose.modScore3) <- "majorAnnot"
pas9 <- "YoshRef.YC.Nose.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.YC.Nose.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef.YC.Nose.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.YC.Nose.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
#
YoshRef.YC.Nose <- YoshRef.YC.Nose.modScore3
YoshRef.YC.Nose@active.ident <- factor(YoshRef.YC.Nose@active.ident, levels =c("Basal", "SecGob", "Ciliated", "RareCells"))
VPfname <- "YoshRef_YC.VP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.YC.Nose, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) +
  theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
RPfname <- "YoshRef_YC.RP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, RPfname), width = 11, height = 10, units = "in", res = 600)
rdg1 <- RidgePlot(YoshRef.YC.Nose.modScore3, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) + 
  scale_x_discrete(labels = c("Basal", "SecGob", "Ciliated", "RareCells")) +
 theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(rdg1)
dev.off()
```

```{r Nose_Child}

Idents(YoshRef.Child.Nose.modScore3) <- "majorAnnot"
pas9 <- "YoshRef.Child.Nose.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Child.Nose.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef.Child.Nose.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.Child.Nose.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
#
YoshRef.Child.Nose <- YoshRef.Child.Nose.modScore3
YoshRef.Child.Nose@active.ident <- factor(YoshRef.Child.Nose@active.ident, levels =c("Basal", "SecGob", "Ciliated", "RareCells"))
VPfname <- "YoshRef_Child.VP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.Child.Nose, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) +
  theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
RPfname <- "YoshRef_Child.RP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, RPfname), width = 11, height = 10, units = "in", res = 600)
rdg1 <- RidgePlot(YoshRef.Child.Nose.modScore3, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) + 
  scale_x_discrete(labels = c("Basal", "SecGob", "Ciliated", "RareCells")) +
 theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(rdg1)
dev.off()
```


```{r Nose_Adolescent}

Idents(YoshRef.Adolescent.Nose.modScore3) <- "majorAnnot"
pas9 <- "YoshRef.Adolescent.Nose.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Adolescent.Nose.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef.Adolescent.Nose.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.Adolescent.Nose.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
#
YoshRef.Adolescent.Nose <- YoshRef.Adolescent.Nose.modScore3
YoshRef.Adolescent.Nose@active.ident <- factor(YoshRef.Adolescent.Nose@active.ident, levels =c("Basal", "SecGob", "Ciliated", "RareCells")
VPfname <- "YoshRef_Adolescent.VP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.Adolescent.Nose, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) +
  theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
RPfname <- "YoshRef_Adolescent.RP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, RPfname), width = 11, height = 10, units = "in", res = 600)
rdg1 <- RidgePlot(YoshRef.Adolescent.Nose.modScore3, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) + 
  scale_x_discrete(labels = c("Basal", "SecGob", "Ciliated", "RareCells")) +
 theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(rdg1)
dev.off()
```



```{r Bronchi_Neonate}

#majorCols <- c("Basal" = "red", "SecGob" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
maxScore = max(c(YoshRef.Neonate.Bronchi.modScore3@meta.data$GobNetwork,  YoshRef.Infant.Bronchi.modScore3@meta.data$GobNetwork, YoshRef.YC.Bronchi.modScore3@meta.data$GobNetwork, YoshRef.Child.Bronchi.modScore3@meta.data$GobNetwork, YoshRef.Adolescent.Bronchi.modScore3@meta.data$GobNetwork)); minScore = min(c(YoshRef.Neonate.Bronchi.modScore3@meta.data$GobNetwork,  YoshRef.Infant.Bronchi.modScore3@meta.data$GobNetwork, YoshRef.YC.Bronchi.modScore3@meta.data$GobNetwork, YoshRef.Child.Bronchi.modScore3@meta.data$GobNetwork, YoshRef.Adolescent.Bronchi.modScore3@meta.data$GobNetwork))
# +   scale_color_distiller(palette = "RdYlBu") +
majorCols <- c("Basal" = "red", 
    "SecGob" = "purple", 
    "Ciliated" = "olivedrab1", 
    "RareCells" = "magenta")


Idents(YoshRef.Neonate.Bronchi.modScore3) <- "majorAnnot"
pas9 <- "YoshRef.Neonate.Bronchi.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Neonate.Bronchi.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef.Neonate.Bronchi.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.Neonate.Bronchi.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
#
YoshRef.Neonate.Bronchi <- YoshRef.Neonate.Bronchi.modScore3
YoshRef.Neonate.Bronchi@active.ident <- factor(YoshRef.Neonate.Bronchi@active.ident, levels =c("Basal", "SecGob", "Ciliated", "RareCells"))
VPfname <- "YoshRef_Neonate.VP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.Neonate.Bronchi, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) +
  theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
RPfname <- "YoshRef_Neonate.RP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, RPfname), width = 11, height = 10, units = "in", res = 600)
rdg1 <- RidgePlot(YoshRef.Neonate.Bronchi.modScore3, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) + 
  scale_x_discrete(labels = c("Basal", "SecGob", "Ciliated", "RareCells")) +
 theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(rdg1)
dev.off()
```

```{r Bronchi_Infant}

Idents(YoshRef.Infant.Bronchi.modScore3) <- "majorAnnot"
pas9 <- "YoshRef.Infant.Bronchi.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Infant.Bronchi.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef.Infant.Bronchi.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.Infant.Bronchi.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
#
YoshRef.Infant.Bronchi <- YoshRef.Infant.Bronchi.modScore3
YoshRef.Infant.Bronchi@active.ident <- factor(YoshRef.Infant.Bronchi@active.ident, levels =c("Basal", "SecGob", "Ciliated", "RareCells"))
VPfname <- "YoshRef_Infant.VP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.Infant.Bronchi, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) +
  theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
RPfname <- "YoshRef_Infant.RP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, RPfname), width = 11, height = 10, units = "in", res = 600)
rdg1 <- RidgePlot(YoshRef.Infant.Bronchi.modScore3, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) + 
  scale_x_discrete(labels = c("Basal", "SecGob", "Ciliated", "RareCells")) +
 theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(rdg1)
dev.off()
```
```{r Basal_YC}

Idents(YoshRef.YC.Bronchi.modScore3) <- "majorAnnot"
pas9 <- "YoshRef.YC.Bronchi.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.YC.Bronchi.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef.YC.Bronchi.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.YC.Bronchi.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
#
YoshRef.YC.Bronchi <- YoshRef.YC.Bronchi.modScore3
YoshRef.YC.Bronchi@active.ident <- factor(YoshRef.YC.Bronchi@active.ident, levels =c("Basal", "SecGob", "Ciliated", "RareCells"))
VPfname <- "YoshRef_YC.VP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.YC.Bronchi, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) +
  theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
RPfname <- "YoshRef_YC.RP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, RPfname), width = 11, height = 10, units = "in", res = 600)
rdg1 <- RidgePlot(YoshRef.YC.Bronchi.modScore3, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) + 
  scale_x_discrete(labels = c("Basal", "SecGob", "Ciliated", "RareCells")) +
 theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(rdg1)
dev.off()
```

```{r Bronchi_Child}

Idents(YoshRef.Child.Bronchi.modScore3) <- "majorAnnot"
pas9 <- "YoshRef.Child.Bronchi.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Child.Bronchi.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef.Child.Bronchi.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.Child.Bronchi.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
#
YoshRef.Child.Bronchi <- YoshRef.Child.Bronchi.modScore3
YoshRef.Child.Bronchi@active.ident <- factor(YoshRef.Child.Bronchi@active.ident, levels =c("Basal", "SecGob", "Ciliated", "RareCells"))
VPfname <- "YoshRef_Child.VP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.Child.Bronchi, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) +
  theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
RPfname <- "YoshRef_Child.RP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, RPfname), width = 11, height = 10, units = "in", res = 600)
rdg1 <- RidgePlot(YoshRef.Child.Bronchi.modScore3, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) + 
  scale_x_discrete(labels = c("Basal", "SecGob", "Ciliated", "RareCells")) +
 theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(rdg1)
dev.off()
```


```{r Bronchi_Adolescent}

Idents(YoshRef.Adolescent.Bronchi.modScore3) <- "majorAnnot"
pas9 <- "YoshRef.Adolescent.Bronchi.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Adolescent.Bronchi.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef.Adolescent.Bronchi.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.Adolescent.Bronchi.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
#
YoshRef.Adolescent.Bronchi <- YoshRef.Adolescent.Bronchi.modScore3
YoshRef.Adolescent.Bronchi@active.ident <- factor(YoshRef.Adolescent.Bronchi@active.ident, levels =c("Basal", "SecGob", "Ciliated", "RareCells")
VPfname <- "YoshRef_Adolescent.VP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.Adolescent.Bronchi, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) +
  theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
RPfname <- "YoshRef_Adolescent.RP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, RPfname), width = 11, height = 10, units = "in", res = 600)
rdg1 <- RidgePlot(YoshRef.Adolescent.Bronchi.modScore3, features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) + 
  scale_x_discrete(labels = c("Basal", "SecGob", "Ciliated", "RareCells")) +
 theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(rdg1)
dev.off()
```
#### Infant_GobNetwork
```{r Infant_GobNetwork} 
'YoshRef.Epi.woImmune.Neonate.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Neonate")
YoshRef.Epi.woImmune.Infant.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Infant")
YoshRef.Epi.woImmune.YC.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Young child")
YoshRef.Epi.woImmune.Child.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Child")
YoshRef.Epi.woImmune.Adolescent.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Adolescent")'
GobNetwork.Core <- c("NKX2-1", "FOXA2", "SPDEF", "FOXA3", "MUC5AC")
GobNetwork.Core <- list(GobNetwork.Core)
###Nose
YoshRef.comb.modScore3 <- AddModuleScore(YoshRef.comb.woImmune, features = GobNetwork.Core, assay = "RNA", name = "GobNetwork")
```

```{r Nasal_Bronchi}

Idents(YoshRef.comb.modScore3) <- "Age_donor"
pas9 <- "YoshRef.Nasal.Bronchi.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3 , reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) 
print(p1)
dev.off()
pas10 <- "YoshRef.Nasal.Bronchi.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3 , reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0)))
print(p2)
dev.off()
###majorAnnot
#
cols_plot = c(
    "Nasal" = "coral1", 
    "Bronchial" = "blue")
#YoshRef.Adolescent.Bronchi <- YoshRef.comb.modScore3 

'YoshRef.comb.modScore3@active.ident <- factor(YoshRef.comb.modScore3@active.ident, 
    levels =c("Neonate", "Infant", "Young child", "Child", "Adolescent"))'

Idents(YoshRef.comb.modScore3) <- "Samp.loc"
YoshRef.Neonate.Nose@active.ident <- factor(YoshRef.Neonate.Nose@active.ident, levels =c("Basal", "SecGob", "Ciliated", "RareCells"))
VPfname <- "YoshRef_Adolescent.VP.IFN.GobNetwork.majorAnnot1.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.comb.modScore3, features = "GobNetwork1", 
    group.by = "Age_bin", split.by = "Samp.loc", cols = cols_plot,
	pt.size = 0.5) + ylab ("GobNetwork Score") +
    theme(axis.title = element_text(face="bold", family = "sans", size = 32), 
    axis.text  = element_text(face="bold", family = "sans", size = 30), 
    legend.text  = element_text(face="bold", family = "sans", size = 12))
print(vln1)
dev.off()
'RPfname <- "YoshRef_Adolescent.RP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, RPfname), width = 11, height = 10, units = "in", res = 600)
rdg1 <- RidgePlot(YoshRef.comb.modScore3 , features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) + 
  scale_x_discrete(labels = c("Basal", "SecGob", "Ciliated", "RareCells")) +
 theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(rdg1)
dev.off()'
```

```{r Nasal_Bronchi}
YoshRef.Nasal.comb.modScore3 <- subset(YoshRef.comb.modScore3, subset = Samp.loc == "Nasal")
YoshRef.Bronchial.comb.modScore3 <- subset(YoshRef.comb.modScore3, subset = Samp.loc == "Bronchial")

maxScore = max(c(YoshRef.Nasal.comb.modScore3@meta.data$GobNetwork1, YoshRef.Bronchial.comb.modScore3@meta.data$GobNetwork1)); minScore = min(c(YoshRef.Nasal.comb.modScore3@meta.data$GobNetwork1, YoshRef.Bronchial.comb.modScore3@meta.data$GobNetwork1))
Idents(YoshRef.comb.modScore3) <- "Age_donor"
pas9 <- "YoshRef.Nasal.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =14, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Nasal.comb.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8)))  + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p1)
dev.off()
pas10 <- "YoshRef.Nasal.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =14, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.Nasal.comb.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0)))  + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()


Idents(YoshRef.comb.modScore3) <- "Age_donor"
pas9 <- "YoshRef.Bronchial.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =14, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Bronchial.comb.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8)))  + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p1)
dev.off()
pas10 <- "YoshRef.Bronchial.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =14, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.Bronchial.comb.modScore3, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0)))  + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot


###majorAnnot
#
cols_plot = c(
    "Nasal" = "coral1", 
    "Bronchial" = "blue")
#YoshRef.Adolescent.Bronchi <- YoshRef.comb.modScore3 

'YoshRef.comb.modScore3@active.ident <- factor(YoshRef.comb.modScore3@active.ident, 
    levels =c("Neonate", "Infant", "Young child", "Child", "Adolescent"))'

Idents(YoshRef.comb.modScore3) <- "Samp.loc"
YoshRef.Neonate.Nose@active.ident <- factor(YoshRef.Neonate.Nose@active.ident, levels =c("Basal", "SecGob", "Ciliated", "RareCells"))
VPfname <- "YoshRef_Adolescent.VP.IFN.GobNetwork.majorAnnot1.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.comb.modScore3, features = "GobNetwork1", 
    group.by = "Age_bin", split.by = "Samp.loc", cols = cols_plot,
	pt.size = 0.5) + ylab ("GobNetwork Score") +
    theme(axis.title = element_text(face="bold", family = "sans", size = 32), 
    axis.text  = element_text(face="bold", family = "sans", size = 30), 
    legend.text  = element_text(face="bold", family = "sans", size = 12))
print(vln1)
dev.off()
'RPfname <- "YoshRef_Adolescent.RP.IFN.GobNetwork.majorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, RPfname), width = 11, height = 10, units = "in", res = 600)
rdg1 <- RidgePlot(YoshRef.comb.modScore3 , features = "GobNetwork1", group.by = "majorAnnot", cols = majorCols) + 
  scale_x_discrete(labels = c("Basal", "SecGob", "Ciliated", "RareCells")) +
 theme(axis.title = element_text(face="bold", family = "sans", size = 25), axis.text  = element_text(face="bold", family = "sans", size = 25), legend.text  = element_text(face="bold", family = "sans", size = 8))
print(rdg1)
dev.off()'
```




# 4. Gene Set Enrichment Analysis
### PseudoBulk. All Cells

```{r AllCells.wImmune}
outPath.Epithelial.Yoshida = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
YoshRef.comb.modScore3 <- readRDS(file.path(outPath.Epithelial.Yoshida,paste("YoshRef.control.norm.AllSamplesres1.annotated.rds")))
YoshRef.comb <- YoshRef.comb.modScore3
#YoshRef.comb@meta.data$Samp.loc <- ifelse(YoshRef.comb@meta.data$Sample_location %in% c("Bronchi", "Trachea"), "Bronchi_Trachea", "Nose")
Idents(YoshRef.comb) <- "Samp.loc"
DefaultAssay(YoshRef.comb) <- "RNA"
countRNA <- GetAssayData(object = YoshRef.comb, layer = "data")
genes <- rownames(countRNA)
mtGenes.loc <- grep("^MT-", genes)
mtGenes <- genes[mtGenes.loc]
rplGenes.loc <- grep("^MRPL", genes)
rplGenes <- genes[rplGenes.loc]
rpsGenes.loc <- grep("^MRPS", genes)
rpsGenes <- genes[rpsGenes.loc]
RPLGenes <- c("RP1L1","RPL10","RPL10A","RPL11","RPL12","RPL13","RPL13A","RPL14","RPL15","RPL17","RPL17-C18orf32","RPL18","RPL18A","RPL19","RPL21","RPL22","RPL22L1","RPL23","RPL23A","RPL24","RPL26","RPL26L1","RPL27","RPL27A","RPL28","RPL29","RPL3","RPL30","RPL31","RPL32","RPL34","RPL35","RPL35A","RPL36","RPL36A","RPL36AL","RPL37","RPL37A","RPL38","RPL39","RPL39L","RPL3L","RPL4","RPL41","RPL5","RPL6","RPL7","RPL7A","RPL7L1","RPL8","RPL9","RPLP0","RPLP1","RPLP2","RPS10","RPS10-NUDT3","RPS11","RPS12","RPS13","RPS14","RPS15","RPS15A","RPS16","RPS17","RPS18","RPS19","RPS19BP1","RPS2","RPS20","RPS21","RPS23","RPS24","RPS25","RPS26","RPS27","RPS27A","RPS27AP5","RPS27L","RPS28","RPS29","RPS3","RPS3A","RPS4X","RPS4Y1","RPS5","RPS6","RPS6KA1","RPS6KA2","RPS6KA3","RPS6KA4","RPS6KA5","RPS6KA6","RPS6KB1","RPS6KB2","RPS6KC1","RPS6KL1","RPS7","RPS8","RPS9")
RPL_RT.Genes <- c(RPLGenes, mtGenes, rpsGenes, rplGenes)
genes.RPL_RT.rem <- genes[!(genes %in% (RPL_RT.Genes))]
pseudo_YoshRef <- AggregateExpression(YoshRef.comb, 
    assays = "RNA", 
    return.seurat = T,
    group.by = c("Age_donor", "donor",  "Samp.loc"))
pseudo_YoshRef$SampLoc_Age = paste(pseudo_YoshRef$Samp.loc, "_", pseudo_YoshRef$Age_donor, sep = "")
allMarkers <- FindMarkers(pseudo_YoshRef, 
    logfc.threshold=0.25, 
    ident.1 = "Nasal", 
    ident.2 = "Bronchial", 
    test.use="wilcox_limma",
    assay="RNA",
    group.by = "Samp.loc",
    features = genes.RPL_RT.rem)
write.csv(allMarkers, file.path(outPath.Epithelial.Yoshida, paste("Nasal_vs_Bronchi_Trachea.AllMarkers.Aggregrated.mod.csv")))
        
allMarkers <- FindMarkers(pseudo_YoshRef, 
    logfc.threshold=0.25, 
    ident.1 = "Nasal_Adolescent", 
    ident.2 = "Bronchial_Adolescent", 
    test.use="wilcox_limma",
    assay="RNA",
    group.by = "SampLoc_Age",
    features = genes.RPL_RT.rem)
write.csv(allMarkers, file.path(outPath.Epithelial.Yoshida, paste("Nasal_vs_Bronchi_Trachea.AllMarkers.Adolescent.mod.csv")))
allMarkers <- FindMarkers(pseudo_YoshRef, 
    logfc.threshold=0.25, 
    ident.1 = "Nasal_Neonate", 
    ident.2 = "Bronchial_Neonate", 
    test.use="wilcox_limma",
    assay="RNA",
    group.by = "SampLoc_Age",
    features = genes.RPL_RT.rem)
write.csv(allMarkers, file.path(outPath.Epithelial.Yoshida, paste("Nasal_vs_Bronchi_Trachea.AllMarkers.Neonate.mod.csv")))
allMarkers <- FindMarkers(pseudo_YoshRef, 
    logfc.threshold=0.25, 
    ident.1 = "Nasal_Infant", 
    ident.2 = "Bronchial_Infant", 
    test.use="wilcox_limma",
    assay="RNA",
    group.by = "SampLoc_Age",
    features = genes.RPL_RT.rem)
write.csv(allMarkers, file.path(outPath.Epithelial.Yoshida, paste("Nasal_vs_Bronchi_Trachea.AllMarkers.Infant.mod.csv")))
allMarkers <- FindMarkers(pseudo_YoshRef, 
    logfc.threshold=0.25, 
    ident.1 = "Nasal_Young child", 
    ident.2 = "Bronchial_Young child", 
    test.use="wilcox_limma",
    assay="RNA",
    group.by = "SampLoc_Age",
    features = genes.RPL_RT.rem)
write.csv(allMarkers, file.path(outPath.Epithelial.Yoshida, paste("Nasal_vs_Bronchi_Trachea.AllMarkers.YC.mod.csv")))
allMarkers <- FindMarkers(pseudo_YoshRef, 
    logfc.threshold=0.25, 
    ident.1 = "Nasal_Child", 
    ident.2 = "Bronchial_Child", 
    test.use="wilcox_limma",
    assay="RNA",
    group.by = "SampLoc_Age",
    features = genes.RPL_RT.rem)
write.csv(allMarkers, file.path(outPath.Epithelial.Yoshida, paste("Nasal_vs_Bronchi_Trachea.AllMarkers.Child.mod.csv")))


allMarkers <- FindMarkers(pseudo_YoshRef, 
    logfc.threshold=0.25, 
    ident.1 = "Nasal_Adolescent", 
    ident.2 = "Bronchial_Adolescent", 
    test.use="wilcox_limma",
    assay="RNA",
    group.by = "SampLoc_Age",
    features = genes.RPL_RT.rem)
write.csv(allMarkers, file.path(outPath.Epithelial.Yoshida, paste("Nasal_vs_Bronchi_Trachea.AllMarkers.Adolescent.mod.csv")))
allMarkers <- FindMarkers(pseudo_YoshRef, 
    logfc.threshold=0.25, 
    ident.1 = "Nasal_Neonate", 
    ident.2 = "Bronchial_Neonate", 
    test.use="wilcox_limma",
    assay="RNA",
    group.by = "SampLoc_Age",
    features = genes.RPL_RT.rem)
write.csv(allMarkers, file.path(outPath.Epithelial.Yoshida, paste("Nasal_vs_Bronchi_Trachea.AllMarkers.Neonate.mod.csv")))
allMarkers <- FindMarkers(pseudo_YoshRef, 
    logfc.threshold=0.25, 
    ident.1 = "Nasal_Infant", 
    ident.2 = "Bronchial_Infant", 
    test.use="wilcox_limma",
    assay="RNA",
    group.by = "SampLoc_Age",
    features = genes.RPL_RT.rem)
write.csv(allMarkers, file.path(outPath.Epithelial.Yoshida, paste("Nasal_vs_Bronchi_Trachea.AllMarkers.Infant.mod.csv")))
allMarkers <- FindMarkers(pseudo_YoshRef, 
    logfc.threshold=0.25, 
    ident.1 = "Nasal_Young child", 
    ident.2 = "Bronchial_Young child", 
    test.use="wilcox_limma",
    assay="RNA",
    group.by = "SampLoc_Age",
    features = genes.RPL_RT.rem)
write.csv(allMarkers, file.path(outPath.Epithelial.Yoshida, paste("Nasal_vs_Bronchi_Trachea.AllMarkers.YC.mod.csv")))
allMarkers <- FindMarkers(pseudo_YoshRef, 
    logfc.threshold=0.25, 
    ident.1 = "Nasal_Child", 
    ident.2 = "Bronchial_Child", 
    test.use="wilcox_limma",
    assay="RNA",
    group.by = "SampLoc_Age",
    features = genes.RPL_RT.rem)
write.csv(allMarkers, file.path(outPath.Epithelial.Yoshida, paste("Nasal_vs_Bronchi_Trachea.AllMarkers.Child.mod.csv")))

```
### GSEA data

```{r}
inPath = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
outPath.Epithelial.Yoshida = inPath
outFolderName = "Nasal_vs_Bronchial"
datFinal <- read.csv(file.path(inPath, "Nasal_vs_Bronchi_Trachea.AllMarkers.mod.csv"))
reference= "/home/sbhattach2/reference/hg38/msigdb_v2023.2.Hs_files_to_download_locally/msigdb_v2023.2.Hs_files_to_download_locally/msigdb_v2023.2.Hs_GMTs"
reference_Hallmark = file.path(reference, "h.all.v2023.2.Hs.symbols.gmt")
pathways.hallmark <- gmtPathways(reference_Hallmark)
enrichr.hallmark <- read.gmt(reference_Hallmark)
markers <- datFinal
print("Filtering")
markers <- markers[which(markers$p_val_adj <= 0.1),]
markers_sort <- markers[order(-markers$avg_log2FC, markers$p_val_adj),]
markers_sort.rank <- data.frame(genes = markers_sort$X, stat = markers_sort$avg_log2FC)
markers_sort.rank.pos <- markers_sort[which(markers_sort$avg_log2FC >=1),]
markers_sort.rank.neg <- markers_sort[which(markers_sort$avg_log2FC <=-1),]
print(paste("Positive genes:", nrow(markers_sort.rank.pos)))
print(paste("Negative genes:", nrow(markers_sort.rank.neg)))
ranks <- deframe(markers_sort.rank)
print("GO")
print(paste("Ranks:", length(ranks)))
enrichr.unadjusted <- GSEA(ranks, TERM2GENE=enrichr.hallmark, verbose=TRUE, pvalueCutoff = 1)
write.csv(enrichr.unadjusted@result, file.path(outPath.Epithelial.Yoshida, paste(outFolderName, "_unadjusted.HM.csv",sep = "")))
enrichr.adjusted <- GSEA(ranks, TERM2GENE=enrichr.hallmark, verbose=TRUE)
write.csv(enrichr.adjusted@result, file.path(outPath.Epithelial.Yoshida, paste(outFolderName, "_adjusted.HM.csv", sep = "")))
```

### BP data

```{r}
reference= "/home/sbhattach2/reference/hg38/msigdb_v2023.2.Hs_files_to_download_locally/msigdb_v2023.2.Hs_files_to_download_locally/msigdb_v2023.2.Hs_GMTs"
reference_BP = file.path(reference, "c5.go.bp.v2023.2.Hs.symbols.gmt")
pathways.BP <- gmtPathways(reference_BP)
enrichr.BP <- read.gmt(reference_BP)
markers <- datFinal
print("Filtering")
markers <- markers[which(markers$p_val_adj <= 0.1),]
markers_sort <- markers[order(-markers$avg_log2FC, markers$p_val_adj),]
markers_sort.rank <- data.frame(genes = markers_sort$X, stat = markers_sort$avg_log2FC)
markers_sort.rank.pos <- markers_sort[which(markers_sort$avg_log2FC >=1),]
markers_sort.rank.neg <- markers_sort[which(markers_sort$avg_log2FC <=-1),]
print(paste("Positive genes:", nrow(markers_sort.rank.pos)))
print(paste("Negative genes:", nrow(markers_sort.rank.neg)))
ranks <- deframe(markers_sort.rank)
print("GO")
print(paste("Ranks:", length(ranks)))
enrichr.unadjusted <- GSEA(ranks, TERM2GENE=enrichr.BP, verbose=TRUE, pvalueCutoff = 1)
write.csv(enrichr.unadjusted@result, file.path(outPath.Epithelial.Yoshida, paste(outFolderName, "_unadjusted.BP.csv",sep = "")))
enrichr.adjusted <- GSEA(ranks, TERM2GENE=enrichr.BP, verbose=TRUE)
write.csv(enrichr.adjusted@result, file.path(outPath.Epithelial.Yoshida, paste(outFolderName, "_adjusted.BP.csv", sep = "")))
```

### Reactome data

```{r}
reference= "/home/sbhattach2/reference/hg38/msigdb_v2023.2.Hs_files_to_download_locally/msigdb_v2023.2.Hs_files_to_download_locally/msigdb_v2023.2.Hs_GMTs"
reference_Reactome = file.path(reference, "c2.cp.reactome.v2023.2.Hs.symbols.gmt")
pathways.Reactome <- gmtPathways(reference_Reactome)
enrichr.Reactome <- read.gmt(reference_Reactome)
markers <- datFinal
print("Filtering")
markers <- markers[which(markers$p_val_adj <= 0.1),]
markers_sort <- markers[order(-markers$avg_log2FC, markers$p_val_adj),]
markers_sort.rank <- data.frame(genes = markers_sort$X, stat = markers_sort$avg_log2FC)
markers_sort.rank.pos <- markers_sort[which(markers_sort$avg_log2FC >=1),]
markers_sort.rank.neg <- markers_sort[which(markers_sort$avg_log2FC <=-1),]
print(paste("Positive genes:", nrow(markers_sort.rank.pos)))
print(paste("Negative genes:", nrow(markers_sort.rank.neg)))
ranks <- deframe(markers_sort.rank)
print("GO")
print(paste("Ranks:", length(ranks)))
enrichr.unadjusted <- GSEA(ranks, TERM2GENE=enrichr.Reactome, verbose=TRUE, pvalueCutoff = 1)
write.csv(enrichr.unadjusted@result, file.path(outPath.Epithelial.Yoshida, paste(outFolderName, "_unadjusted.Reactome.csv",sep = "")))
enrichr.adjusted <- GSEA(ranks, TERM2GENE=enrichr.Reactome, verbose=TRUE)
write.csv(enrichr.adjusted@result, file.path(outPath.Epithelial.Yoshida, paste(outFolderName, "_adjusted.Reactome.csv", sep = "")))
```

### All Samples

```{r AllAgeGroup_IFNScore} 
#inPath = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples/"
#YoshRef.comb <- readRDS(file.path(inPath, "YoshRef.control.norm.AllSamplesres1.annotated.rds"))
YoshidaBasalMarkers <- c("KRT5", "KRT15", "DLK2", "DAPL1", "NOTCH1", "MKI67", "TOP2A", "KRT6A", "KRT13")
YoshidaSecGobMarkers <- c("CAPN13", "RARRES1", "SCGB3A1", "SCGB1A1", "MUC5AC", "TFF1", "BPIFA2", "PLAU")
YoshidaCilMarkers <- c("DEUP1", "FOXN4", "CDC20B", "PIFO","OMG", "CFAP54", "CCDC40")
YoshidaRareMarkers <- c("FOXI1", "ASCL3", "BMX", "RGS13", "BEX1", "PCSK1N", "PMEL")

#YoshRef.Epithelial.Infant.annotated <- subset(YoshRef.Epithelial.annotated, subset = Age_donor == "Young_infant")

#IFN.Core <-  IFN.Core[!IFN.Core %in% c("HCP5", "H2BC21", "H2AC6", "SHFL", "KLHDC7B-DT", "ENSG00000288587", "H2BC4", "ENSG00000282988", "LRATD1", "PLAAT4", "ENSG00000288825", "H2BC5")]
YoshidaBasalMarkers <- list(YoshidaBasalMarkers)
###YoshRef_Infant Mod Score
YoshRef.comb.modScore3 <- AddModuleScore(YoshRef.comb.modScore3, features = YoshidaBasalMarkers, assay = "RNA", name = "YoshidaBasalMarkers")
###IFN.Lambda
#IFN.Lambda <-  IFN.Lambda[!IFN.Lambda %in% c("ENSG00000272821", "H2BC12", "H4C8", "LOC100507516", "LNCAROD", "PLAAT2")]
YoshidaSecGobMarkers <- list(YoshidaSecGobMarkers)
YoshRef.comb.modScore3 <- AddModuleScore(YoshRef.comb.modScore3, features = YoshidaSecGobMarkers, assay = "RNA", name = "YoshidaSecGobMarkers")
###IFN.Beta
#immg1 <-  immg1[!immg1 %in% c("HCP5", "BISPR", "CLCA3P", "KLHDC7B-DT", "PSMB8-AS1", "GBP1P1", "LOC100507516")]
#IFN.Beta <-  IFN.Beta[!IFN.Beta %in% c("ENSG00000197536", "CHROMR", "ENSG00000225101")]
YoshidaCilMarkers <- list(YoshidaCilMarkers)
YoshRef.comb.modScore3 <- AddModuleScore(YoshRef.comb.modScore3, features = YoshidaCilMarkers, assay = "RNA", name = "YoshidaCilMarkers")
###InterferonAlpha
#immg1 <-  immg1[!immg1 %in% c("HCP5", "BISPR", "CLCA3P", "KLHDC7B-DT", "PSMB8-AS1", "GBP1P1", "LOC100507516")]
#IFN.Alpha <-  IFN.Alpha[!IFN.Alpha %in% c("WARS1")]
YoshidaRareMarkers <- list(YoshidaRareMarkers)
YoshRef.comb.modScore3 <- AddModuleScore(YoshRef.comb.modScore3, features = YoshidaRareMarkers, assay = "RNA", name = "YoshidaRareMarkers")
```

```{r Basal}
###Neonate
YoshRef.comb.modScore3.BasalPos.Neonate.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    YoshidaBasalMarkers1 > 0))
YoshRef.comb.modScore3.BasalNeg.Neonate.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    YoshidaBasalMarkers1 <= 0))
YoshRef.comb.modScore3.BasalPos.Neonate.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    YoshidaBasalMarkers1 > 0))
YoshRef.comb.modScore3.BasalNeg.Neonate.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    YoshidaBasalMarkers1 <= 0))
###Infant
YoshRef.comb.modScore3.BasalPos.Infant.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    YoshidaBasalMarkers1 > 0))
YoshRef.comb.modScore3.BasalNeg.Infant.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    YoshidaBasalMarkers1 <= 0))
YoshRef.comb.modScore3.BasalPos.Infant.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    YoshidaBasalMarkers1 > 0))
YoshRef.comb.modScore3.BasalNeg.Infant.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    YoshidaBasalMarkers1 <= 0))
###YC
YoshRef.comb.modScore3.BasalPos.YC.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    YoshidaBasalMarkers1 > 0))
YoshRef.comb.modScore3.BasalNeg.YC.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    YoshidaBasalMarkers1 <= 0))
YoshRef.comb.modScore3.BasalPos.YC.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    YoshidaBasalMarkers1 > 0))
YoshRef.comb.modScore3.BasalNeg.YC.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    YoshidaBasalMarkers1 <= 0))
###Child
YoshRef.comb.modScore3.BasalPos.Child.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    YoshidaBasalMarkers1 > 0))
YoshRef.comb.modScore3.BasalNeg.Child.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    YoshidaBasalMarkers1 <= 0))
YoshRef.comb.modScore3.BasalPos.Child.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    YoshidaBasalMarkers1 > 0))
YoshRef.comb.modScore3.BasalNeg.Child.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    YoshidaBasalMarkers1 <= 0))
###Adolescent
YoshRef.comb.modScore3.BasalPos.Adolescent.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    YoshidaBasalMarkers1 > 0))
YoshRef.comb.modScore3.BasalNeg.Adolescent.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    YoshidaBasalMarkers1 <= 0))
YoshRef.comb.modScore3.BasalPos.Adolescent.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    YoshidaBasalMarkers1 > 0))
YoshRef.comb.modScore3.BasalNeg.Adolescent.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    YoshidaBasalMarkers1 <= 0))
```

```{r SecGob}
###Neonate
YoshRef.comb.modScore3.SecGobPos.Neonate.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    YoshidaSecGobMarkers1 > 0))
YoshRef.comb.modScore3.SecGobNeg.Neonate.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    YoshidaSecGobMarkers1 <= 0))
YoshRef.comb.modScore3.SecGobPos.Neonate.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    YoshidaSecGobMarkers1 > 0))
YoshRef.comb.modScore3.SecGobNeg.Neonate.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    YoshidaSecGobMarkers1 <= 0))
###Infant
YoshRef.comb.modScore3.SecGobPos.Infant.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    YoshidaSecGobMarkers1 > 0))
YoshRef.comb.modScore3.SecGobNeg.Infant.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    YoshidaSecGobMarkers1 <= 0))
YoshRef.comb.modScore3.SecGobPos.Infant.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    YoshidaSecGobMarkers1 > 0))
YoshRef.comb.modScore3.SecGobNeg.Infant.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    YoshidaSecGobMarkers1 <= 0))
###YC
YoshRef.comb.modScore3.SecGobPos.YC.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    YoshidaSecGobMarkers1 > 0))
YoshRef.comb.modScore3.SecGobNeg.YC.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    YoshidaSecGobMarkers1 <= 0))
YoshRef.comb.modScore3.SecGobPos.YC.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    YoshidaSecGobMarkers1 > 0))
YoshRef.comb.modScore3.SecGobNeg.YC.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    YoshidaSecGobMarkers1 <= 0))
###Child
YoshRef.comb.modScore3.SecGobPos.Child.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    YoshidaSecGobMarkers1 > 0))
YoshRef.comb.modScore3.SecGobNeg.Child.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    YoshidaSecGobMarkers1 <= 0))
YoshRef.comb.modScore3.SecGobPos.Child.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    YoshidaSecGobMarkers1 > 0))
YoshRef.comb.modScore3.SecGobNeg.Child.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    YoshidaSecGobMarkers1 <= 0))
###Adolescent
YoshRef.comb.modScore3.SecGobPos.Adolescent.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    YoshidaSecGobMarkers1 > 0))
YoshRef.comb.modScore3.SecGobNeg.Adolescent.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    YoshidaSecGobMarkers1 <= 0))
YoshRef.comb.modScore3.SecGobPos.Adolescent.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    YoshidaSecGobMarkers1 > 0))
YoshRef.comb.modScore3.SecGobNeg.Adolescent.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    YoshidaSecGobMarkers1 <= 0))
```


```{r Ciliated}
###Neonate
YoshRef.comb.modScore3.CiliatedPos.Neonate.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    YoshidaCilMarkers1 > 0))
YoshRef.comb.modScore3.CiliatedNeg.Neonate.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    YoshidaCilMarkers1 <= 0))
YoshRef.comb.modScore3.CiliatedPos.Neonate.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    YoshidaCilMarkers1 > 0))
YoshRef.comb.modScore3.CiliatedNeg.Neonate.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    YoshidaCilMarkers1 <= 0))
###Infant
YoshRef.comb.modScore3.CiliatedPos.Infant.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    YoshidaCilMarkers1 > 0))
YoshRef.comb.modScore3.CiliatedNeg.Infant.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    YoshidaCilMarkers1 <= 0))
YoshRef.comb.modScore3.CiliatedPos.Infant.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    YoshidaCilMarkers1 > 0))
YoshRef.comb.modScore3.CiliatedNeg.Infant.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    YoshidaCilMarkers1 <= 0))
###YC
YoshRef.comb.modScore3.CiliatedPos.YC.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    YoshidaCilMarkers1 > 0))
YoshRef.comb.modScore3.CiliatedNeg.YC.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    YoshidaCilMarkers1 <= 0))
YoshRef.comb.modScore3.CiliatedPos.YC.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    YoshidaCilMarkers1 > 0))
YoshRef.comb.modScore3.CiliatedNeg.YC.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    YoshidaCilMarkers1 <= 0))
###Child
YoshRef.comb.modScore3.CiliatedPos.Child.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    YoshidaCilMarkers1 > 0))
YoshRef.comb.modScore3.CiliatedNeg.Child.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    YoshidaCilMarkers1 <= 0))
YoshRef.comb.modScore3.CiliatedPos.Child.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    YoshidaCilMarkers1 > 0))
YoshRef.comb.modScore3.CiliatedNeg.Child.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    YoshidaCilMarkers1 <= 0))
###Adolescent
YoshRef.comb.modScore3.CiliatedPos.Adolescent.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    YoshidaCilMarkers1 > 0))
YoshRef.comb.modScore3.CiliatedNeg.Adolescent.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    YoshidaCilMarkers1 <= 0))
YoshRef.comb.modScore3.CiliatedPos.Adolescent.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    YoshidaCilMarkers1 > 0))
YoshRef.comb.modScore3.CiliatedNeg.Adolescent.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    YoshidaCilMarkers1 <= 0))
```


```{r GobNetwork1}
###Neonate
YoshRef.comb.modScore3.GobNetworkPos.Neonate.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    GobNetwork1 > 0))
YoshRef.comb.modScore3.GobNetworkNeg.Neonate.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    GobNetwork1 <= 0))
YoshRef.comb.modScore3.GobNetworkPos.Neonate.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    GobNetwork1 > 0))
YoshRef.comb.modScore3.GobNetworkNeg.Neonate.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    GobNetwork1 <= 0))
###Infant
YoshRef.comb.modScore3.GobNetworkPos.Infant.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    GobNetwork1 > 0))
YoshRef.comb.modScore3.GobNetworkNeg.Infant.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    GobNetwork1 <= 0))
YoshRef.comb.modScore3.GobNetworkPos.Infant.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    GobNetwork1 > 0))
YoshRef.comb.modScore3.GobNetworkNeg.Infant.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    GobNetwork1 <= 0))
###YC
YoshRef.comb.modScore3.GobNetworkPos.YC.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    GobNetwork1 > 0))
YoshRef.comb.modScore3.GobNetworkNeg.YC.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    GobNetwork1 <= 0))
YoshRef.comb.modScore3.GobNetworkPos.YC.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    GobNetwork1 > 0))
YoshRef.comb.modScore3.GobNetworkNeg.YC.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    GobNetwork1 <= 0))
###Child
YoshRef.comb.modScore3.GobNetworkPos.Child.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    GobNetwork1 > 0))
YoshRef.comb.modScore3.GobNetworkNeg.Child.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    GobNetwork1 <= 0))
YoshRef.comb.modScore3.GobNetworkPos.Child.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    GobNetwork1 > 0))
YoshRef.comb.modScore3.GobNetworkNeg.Child.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    GobNetwork1 <= 0))
###Adolescent
YoshRef.comb.modScore3.GobNetworkPos.Adolescent.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    GobNetwork1 > 0))
YoshRef.comb.modScore3.GobNetworkNeg.Adolescent.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    GobNetwork1 <= 0))
YoshRef.comb.modScore3.GobNetworkPos.Adolescent.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    GobNetwork1 > 0))
YoshRef.comb.modScore3.GobNetworkNeg.Adolescent.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    GobNetwork1 <= 0))
```

```{r GobNetwork1}
###Neonate
YoshRef.comb.modScore3.IFN.CorePos.Neonate.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    IFN.Core1 > 0))
YoshRef.comb.modScore3.IFN.CoreNeg.Neonate.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    IFN.Core1 <= 0))
YoshRef.comb.modScore3.IFN.CorePos.Neonate.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    IFN.Core1 > 0))
YoshRef.comb.modScore3.IFN.CoreNeg.Neonate.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    IFN.Core1 <= 0))
###Infant
YoshRef.comb.modScore3.IFN.CorePos.Infant.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    IFN.Core1 > 0))
YoshRef.comb.modScore3.IFN.CoreNeg.Infant.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    IFN.Core1 <= 0))
YoshRef.comb.modScore3.IFN.CorePos.Infant.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    IFN.Core1 > 0))
YoshRef.comb.modScore3.IFN.CoreNeg.Infant.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    IFN.Core1 <= 0))
###YC
YoshRef.comb.modScore3.IFN.CorePos.YC.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    IFN.Core1 > 0))
YoshRef.comb.modScore3.IFN.CoreNeg.YC.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    IFN.Core1 <= 0))
YoshRef.comb.modScore3.IFN.CorePos.YC.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    IFN.Core1 > 0))
YoshRef.comb.modScore3.IFN.CoreNeg.YC.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    IFN.Core1 <= 0))
###Child
YoshRef.comb.modScore3.IFN.CorePos.Child.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    IFN.Core1 > 0))
YoshRef.comb.modScore3.IFN.CoreNeg.Child.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    IFN.Core1 <= 0))
YoshRef.comb.modScore3.IFN.CorePos.Child.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    IFN.Core1 > 0))
YoshRef.comb.modScore3.IFN.CoreNeg.Child.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    IFN.Core1 <= 0))
###Adolescent
YoshRef.comb.modScore3.IFN.CorePos.Adolescent.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    IFN.Core1 > 0))
YoshRef.comb.modScore3.IFN.CoreNeg.Adolescent.Nasal = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    IFN.Core1 <= 0))
YoshRef.comb.modScore3.IFN.CorePos.Adolescent.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    IFN.Core1 > 0))
YoshRef.comb.modScore3.IFN.CoreNeg.Adolescent.Bronchial = subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    IFN.Core1 <= 0))
```

```{r Percentage_composition.SecGob}
inPath = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
SecGob.ModScore <- read.csv(file.path(inPath, "SecGob.ModScore.Nasal_vs_Bronchial.csv"))
SecGob.Pos <- SecGob.ModScore[which(SecGob.ModScore$SecGobType == "SecGob.Pos"),]
#sampInfo.SecGob <- sampInfo[which(sampInfo$celltype == "SecGob"),]
SecGob.Pos$AgeGroup <- factor(SecGob.Pos$AgeGroup,
    levels = c("Neonate", "Infant", "Young child", "Child", "Adolescent"))
SecGob.Pos$SampleLocation <- factor(SecGob.Pos$SampleLocation,
    levels = c("Nasal", "Bronchial"))
cols_plot = c(
    "Nasal" = "coral1", 
    "Bronchial" = "blue")
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(SecGob.Pos, aes(x = AgeGroup, 
    y = PercentofCells_per_SampLoc, group = SampleLocation, 
        color = SampleLocation)) + 
    scale_colour_manual (values = cols_plot) + 
    geom_line(aes(group = SampleLocation), linewidth = 2) + 
    geom_point(aes(group = SampleLocation), size = 5) +
    ylab("% SecGob +tive \n cells per Location") +
    theme(axis.title.x = element_text(size = 30, face = "bold"),
        axis.title.y = element_text(size = 30, face = "bold",),
        axis.text.x = element_text(size = 25, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 25,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 20, face = "bold")) 
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.SecGobModScore.linePlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 14, height = 7, dpi = 600)
```

```{r Percentage_composition.Ciliated}
inPath = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
Ciliated.ModScore <- read.csv(file.path(inPath, "Ciliated.ModScore.Nasal_vs_Bronchial.csv"))
Ciliated.Pos <- Ciliated.ModScore[which(Ciliated.ModScore$CiliatedType == "Ciliated.Pos"),]
#sampInfo.Ciliated <- sampInfo[which(sampInfo$celltype == "Ciliated"),]
Ciliated.Pos$AgeGroup <- factor(Ciliated.Pos$AgeGroup,
    levels = c("Neonate", "Infant", "Young child", "Child", "Adolescent"))
Ciliated.Pos$SampleLocation <- factor(Ciliated.Pos$SampleLocation,
    levels = c("Nasal", "Bronchial"))
cols_plot = c(
    "Nasal" = "coral1", 
    "Bronchial" = "blue")
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(Ciliated.Pos, aes(x = AgeGroup, 
    y = PercentofCells_per_SampLoc, group = SampleLocation, 
        color = SampleLocation)) + 
    scale_colour_manual (values = cols_plot) +
    geom_line(aes(group = SampleLocation), linewidth = 2) + 
    geom_point(aes(group = SampleLocation), size = 5) +
    ylab("% Ciliated +tive \n cells per Location") +
    theme(axis.title.x = element_text(size = 30, face = "bold"),
        axis.title.y = element_text(size = 30, face = "bold",),
        axis.text.x = element_text(size = 25, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 25,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 20, face = "bold")) 
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.CiliatedModScore.linePlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 14, height = 7, dpi = 600)
```

```{r Percentage_composition.Basal}
inPath = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
Basal.ModScore <- read.csv(file.path(inPath, "Basal.ModScore.Nasal_vs_Bronchial.csv"))
Basal.Pos <- Basal.ModScore[which(Basal.ModScore$BasalType == "Basal.Pos"),]
#sampInfo.Basal <- sampInfo[which(sampInfo$celltype == "Basal"),]
Basal.Pos$AgeGroup <- factor(Basal.Pos$AgeGroup,
    levels = c("Neonate", "Infant", "Young child", "Child", "Adolescent"))
Basal.Pos$SampleLocation <- factor(Basal.Pos$SampleLocation,
    levels = c("Nasal", "Bronchial"))
cols_plot = c(
    "Nasal" = "coral1", 
    "Bronchial" = "blue")
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(Basal.Pos, aes(x = AgeGroup, 
    y = PercentofCells_per_SampLoc, group = SampleLocation, 
        color = SampleLocation)) + 
    scale_colour_manual (values = cols_plot) + 
    geom_line(aes(group = SampleLocation), linewidth = 2) + 
    geom_point(aes(group = SampleLocation), size = 5) +
    ylab("% Basal +tive \n cells per Location") +
    theme(axis.title.x = element_text(size = 30, face = "bold"),
        axis.title.y = element_text(size = 30, face = "bold",),
        axis.text.x = element_text(size = 25, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 25,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 20, face = "bold")) 
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.BasalModScore.linePlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 14, height = 7, dpi = 600)
```

```{r Percentage_composition.IFNCore}
inPath = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
IFNCore.ModScore <- read.csv(file.path(inPath, "IFNCore.ModScore.Nasal_vs_Bronchial.csv"))
IFNCore.Pos <- IFNCore.ModScore[which(IFNCore.ModScore$IFNCoreType == "IFNCore.Pos"),]
#sampInfo.IFNCore <- sampInfo[which(sampInfo$celltype == "IFNCore"),]
IFNCore.Pos$AgeGroup <- factor(IFNCore.Pos$AgeGroup,
    levels = c("Neonate", "Infant", "Young child", "Child", "Adolescent"))
IFNCore.Pos$SampleLocation <- factor(IFNCore.Pos$SampleLocation,
    levels = c("Nasal", "Bronchial"))
cols_plot = c(
    "Nasal" = "coral1", 
    "Bronchial" = "blue")
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(IFNCore.Pos, aes(x = AgeGroup, 
    y = PercentofCells_per_SampLoc, group = SampleLocation, 
        color = SampleLocation)) + 
    scale_colour_manual (values = cols_plot) + 
    geom_line(aes(group = SampleLocation), linewidth = 2) + 
    geom_point(aes(group = SampleLocation), size = 5) +
    ylab("% IFNCore +tive \n cells per Location") +
    theme(axis.title.x = element_text(size = 30, face = "bold"),
        axis.title.y = element_text(size = 30, face = "bold",),
        axis.text.x = element_text(size = 25, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 25,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 20, face = "bold")) 
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.IFNCoreModScore.linePlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 14, height = 7, dpi = 600)
```


```{r Percentage_composition.GobNetwork}
inPath = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
GobNetwork.ModScore <- read.csv(file.path(inPath, "GobNetwork.ModScore.Nasal_vs_Bronchial.csv"))
GobNetwork.Pos <- GobNetwork.ModScore[which(GobNetwork.ModScore$GobNetworkType == "GobNetwork.Pos"),]
#sampInfo.GobNetwork <- sampInfo[which(sampInfo$celltype == "GobNetwork"),]
GobNetwork.Pos$AgeGroup <- factor(GobNetwork.Pos$AgeGroup,
    levels = c("Neonate", "Infant", "Young child", "Child", "Adolescent"))
GobNetwork.Pos$SampleLocation <- factor(GobNetwork.Pos$SampleLocation,
    levels = c("Nasal", "Bronchial"))
cols_plot = c(
    "Nasal" = "coral1", 
    "Bronchial" = "blue")
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(GobNetwork.Pos, aes(x = AgeGroup, 
    y = PercentofCells_per_SampLoc, group = SampleLocation, 
        color = SampleLocation)) + 
    scale_colour_manual (values = cols_plot) +
    geom_line(aes(group = SampleLocation), linewidth = 2) + 
    geom_point(aes(group = SampleLocation), size = 5) +
    ylab("% GobNetwork +tive \n cells per Location") +
    theme(axis.title.x = element_text(size = 30, face = "bold"),
        axis.title.y = element_text(size = 30, face = "bold",),
        axis.text.x = element_text(size = 25, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 25,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 20, face = "bold")) 
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.GobNetworkModScore.linePlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 14, height = 7, dpi = 600)
```
```{r ExtractingModScore}
###Neonate
YoshRef.comb.modScore3.Neonate.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate"))
YoshRef.comb.modScore3.Neonate.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate"))
###Infant
YoshRef.comb.modScore3.Infant.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant"))
YoshRef.comb.modScore3.Infant.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" ))
###YC
YoshRef.comb.modScore3.YC.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child"))
YoshRef.comb.modScore3.YC.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Young child"))
###Child
YoshRef.comb.modScore3.Child.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child"))
YoshRef.comb.modScore3.Child.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Child"))
###Adolescent
YoshRef.comb.modScore3.Adolescent.Nasal <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent"))
YoshRef.comb.modScore3.Adolescent.Bronchial <- subset(YoshRef.comb.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent"))
```
###Basal ModScore
#### Nasal
```{r Basal_Neonate.Nasa.Nasal}
majorCols <- c("Basal" = "red", "SecGob" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
maxScore = max(c(YoshRef.comb.modScore3.Neonate.Nasal@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.Infant.Nasal@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.YC.Nasal@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.Child.Nasal@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.Adolescent.Nasal@meta.data$YoshidaBasalMarkers1)); 
minScore = min(c(YoshRef.comb.modScore3.Neonate.Nasal@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.Infant.Nasal@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.YC.Nasal@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.Child.Nasal@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.Adolescent.Nasal@meta.data$YoshidaBasalMarkers1))
# +   scale_color_distiller(palette = "RdYlBu") +
Idents(YoshRef.comb.modScore3.Neonate.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Neonate.Nasal.modScore3.legend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Neonate.Nasal.modScore3.nolegend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


#### Basal Visualization Infant Major Annotation

```{r Basal_Infant.Nasal}
Idents(YoshRef.comb.modScore3.Infant.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Infant.Nasal.modScore3.legend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Infant.Nasal.modScore3.nolegend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


```{r Basal_YC.Nasal}
Idents(YoshRef.comb.modScore3.YC.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_YC.Nasal.modScore3.legend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.YC.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_YC.Nasal.modScore3.nolegend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.YC.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```
```{r Basal_Child.Nasal}
Idents(YoshRef.comb.modScore3.Child.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Child.Nasal.modScore3.legend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Child.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Child.Nasal.modScore3.nolegend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Child.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

```{r Basal_Adolescent.Nasal}
Idents(YoshRef.comb.modScore3.Adolescent.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Adolescent.Nasal.modScore3.legend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Adolescent.Nasal.modScore3.nolegend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

#### Bronchial
```{r Basal_Neonate.Bronchial}
majorCols <- c("Basal" = "red", "SecGob" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
maxScore = max(c(YoshRef.comb.modScore3.Neonate.Bronchial@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.Infant.Bronchial@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.YC.Bronchial@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.Child.Bronchial@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.Adolescent.Bronchial@meta.data$YoshidaBasalMarkers1)); 
minScore = min(c(YoshRef.comb.modScore3.Neonate.Bronchial@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.Infant.Bronchial@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.YC.Bronchial@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.Child.Bronchial@meta.data$YoshidaBasalMarkers1, 
    YoshRef.comb.modScore3.Adolescent.Bronchial@meta.data$YoshidaBasalMarkers1))
# +   scale_color_distiller(palette = "RdYlBu") +
Idents(YoshRef.comb.modScore3.Neonate.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Neonate.Bronchial.modScore3.legend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Neonate.Bronchial.modScore3.nolegend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


#### Basal Visualization Infant Major Annotation

```{r Basal_Infant.Bronchial}
Idents(YoshRef.comb.modScore3.Infant.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Infant.Bronchial.modScore3.legend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Infant.Bronchial.modScore3.nolegend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


```{r Basal_YC.Bronchial}
Idents(YoshRef.comb.modScore3.YC.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_YC.Bronchial.modScore3.legend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.YC.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_YC.Bronchial.modScore3.nolegend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.YC.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```
```{r Basal_Child.Bronchial}
Idents(YoshRef.comb.modScore3.Child.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Child.Bronchial.modScore3.legend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Child.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Child.Bronchial.modScore3.nolegend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Child.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

```{r Basal_Adolescent.Bronchial}
Idents(YoshRef.comb.modScore3.Adolescent.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Adolescent.Bronchial.modScore3.legend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Adolescent.Bronchial.modScore3.nolegend.IFN.Basal.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaBasalMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```


###SecGob ModScore
#### Nasal
```{r SecGob_Neonate.Nasa.Nasal}
majorCols <- c("Basal" = "red", "SecGob" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
maxScore = max(c(YoshRef.comb.modScore3.Neonate.Nasal@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.Infant.Nasal@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.YC.Nasal@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.Child.Nasal@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.Adolescent.Nasal@meta.data$YoshidaSecGobMarkers1)); 
minScore = min(c(YoshRef.comb.modScore3.Neonate.Nasal@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.Infant.Nasal@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.YC.Nasal@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.Child.Nasal@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.Adolescent.Nasal@meta.data$YoshidaSecGobMarkers1))
# +   scale_color_distiller(palette = "RdYlBu") +
Idents(YoshRef.comb.modScore3.Neonate.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Neonate.Nasal.modScore3.legend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Neonate.Nasal.modScore3.nolegend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


#### SecGob Visualization Infant Major Annotation

```{r SecGob_Infant.Nasal}
Idents(YoshRef.comb.modScore3.Infant.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Infant.Nasal.modScore3.legend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Infant.Nasal.modScore3.nolegend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


```{r SecGob_YC.Nasal}
Idents(YoshRef.comb.modScore3.YC.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_YC.Nasal.modScore3.legend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.YC.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_YC.Nasal.modScore3.nolegend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.YC.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```
```{r SecGob_Child.Nasal}
Idents(YoshRef.comb.modScore3.Child.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Child.Nasal.modScore3.legend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Child.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Child.Nasal.modScore3.nolegend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Child.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

```{r SecGob_Adolescent.Nasal}
Idents(YoshRef.comb.modScore3.Adolescent.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Adolescent.Nasal.modScore3.legend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Adolescent.Nasal.modScore3.nolegend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

#### Bronchial
```{r SecGob_Neonate.Bronchial}
majorCols <- c("SecGob" = "red", "SecGob" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
maxScore = max(c(YoshRef.comb.modScore3.Neonate.Bronchial@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.Infant.Bronchial@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.YC.Bronchial@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.Child.Bronchial@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.Adolescent.Bronchial@meta.data$YoshidaSecGobMarkers1)); 
minScore = min(c(YoshRef.comb.modScore3.Neonate.Bronchial@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.Infant.Bronchial@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.YC.Bronchial@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.Child.Bronchial@meta.data$YoshidaSecGobMarkers1, 
    YoshRef.comb.modScore3.Adolescent.Bronchial@meta.data$YoshidaSecGobMarkers1))
# +   scale_color_distiller(palette = "RdYlBu") +
Idents(YoshRef.comb.modScore3.Neonate.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Neonate.Bronchial.modScore3.legend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Neonate.Bronchial.modScore3.nolegend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


#### SecGob Visualization Infant Major Annotation

```{r SecGob_Infant.Bronchial}
Idents(YoshRef.comb.modScore3.Infant.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Infant.Bronchial.modScore3.legend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Infant.Bronchial.modScore3.nolegend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


```{r SecGob_YC.Bronchial}
Idents(YoshRef.comb.modScore3.YC.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_YC.Bronchial.modScore3.legend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.YC.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_YC.Bronchial.modScore3.nolegend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.YC.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```
```{r SecGob_Child.Bronchial}
Idents(YoshRef.comb.modScore3.Child.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Child.Bronchial.modScore3.legend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Child.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Child.Bronchial.modScore3.nolegend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Child.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

```{r SecGob_Adolescent.Bronchial}
Idents(YoshRef.comb.modScore3.Adolescent.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Adolescent.Bronchial.modScore3.legend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Adolescent.Bronchial.modScore3.nolegend.IFN.SecGob.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaSecGobMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```


###Ciliated ModScore
#### Nasal
```{r Ciliated_Neonate.Nasa.Nasal}
majorCols <- c("Basal" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
maxScore = max(c(YoshRef.comb.modScore3.Neonate.Nasal@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.Infant.Nasal@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.YC.Nasal@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.Child.Nasal@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.Adolescent.Nasal@meta.data$YoshidaCilMarkers1)); 
minScore = min(c(YoshRef.comb.modScore3.Neonate.Nasal@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.Infant.Nasal@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.YC.Nasal@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.Child.Nasal@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.Adolescent.Nasal@meta.data$YoshidaCilMarkers1))
# +   scale_color_distiller(palette = "RdYlBu") +
Idents(YoshRef.comb.modScore3.Neonate.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Neonate.Nasal.modScore3.legend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Neonate.Nasal.modScore3.nolegend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


#### Ciliated Visualization Infant Major Annotation

```{r Ciliated_Infant.Nasal}
Idents(YoshRef.comb.modScore3.Infant.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Infant.Nasal.modScore3.legend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Infant.Nasal.modScore3.nolegend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


```{r Ciliated_YC.Nasal}
Idents(YoshRef.comb.modScore3.YC.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_YC.Nasal.modScore3.legend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.YC.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_YC.Nasal.modScore3.nolegend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.YC.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```
```{r Ciliated_Child.Nasal}
Idents(YoshRef.comb.modScore3.Child.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Child.Nasal.modScore3.legend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Child.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Child.Nasal.modScore3.nolegend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Child.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

```{r Ciliated_Adolescent.Nasal}
Idents(YoshRef.comb.modScore3.Adolescent.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Adolescent.Nasal.modScore3.legend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Adolescent.Nasal.modScore3.nolegend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Nasal, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

#### Bronchial
```{r Ciliated_Neonate.Bronchial}
majorCols <- c("Ciliated" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
maxScore = max(c(YoshRef.comb.modScore3.Neonate.Bronchial@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.Infant.Bronchial@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.YC.Bronchial@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.Child.Bronchial@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.Adolescent.Bronchial@meta.data$YoshidaCilMarkers1)); 
minScore = min(c(YoshRef.comb.modScore3.Neonate.Bronchial@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.Infant.Bronchial@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.YC.Bronchial@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.Child.Bronchial@meta.data$YoshidaCilMarkers1, 
    YoshRef.comb.modScore3.Adolescent.Bronchial@meta.data$YoshidaCilMarkers1))
# +   scale_color_distiller(palette = "RdYlBu") +
Idents(YoshRef.comb.modScore3.Neonate.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Neonate.Bronchial.modScore3.legend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Neonate.Bronchial.modScore3.nolegend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


#### Ciliated Visualization Infant Major Annotation

```{r Ciliated_Infant.Bronchial}
Idents(YoshRef.comb.modScore3.Infant.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Infant.Bronchial.modScore3.legend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Infant.Bronchial.modScore3.nolegend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


```{r Ciliated_YC.Bronchial}
Idents(YoshRef.comb.modScore3.YC.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_YC.Bronchial.modScore3.legend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.YC.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_YC.Bronchial.modScore3.nolegend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.YC.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```
```{r Ciliated_Child.Bronchial}
Idents(YoshRef.comb.modScore3.Child.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Child.Bronchial.modScore3.legend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Child.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Child.Bronchial.modScore3.nolegend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Child.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

```{r Ciliated_Adolescent.Bronchial}
Idents(YoshRef.comb.modScore3.Adolescent.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Adolescent.Bronchial.modScore3.legend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Adolescent.Bronchial.modScore3.nolegend.IFN.Ciliated.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Bronchial, reduction = "umap", pt.size = 2, features = "YoshidaCilMarkers1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```


###IFN.Core ModScore
#### Nasal
```{r IFN.Core_Neonate.Nasa.Nasal}
majorCols <- c("Basal" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
maxScore = max(c(YoshRef.comb.modScore3.Neonate.Nasal@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.Infant.Nasal@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.YC.Nasal@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.Child.Nasal@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.Adolescent.Nasal@meta.data$IFN.Core1)); 
minScore = min(c(YoshRef.comb.modScore3.Neonate.Nasal@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.Infant.Nasal@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.YC.Nasal@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.Child.Nasal@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.Adolescent.Nasal@meta.data$IFN.Core1))
# +   scale_color_distiller(palette = "RdYlBu") +
Idents(YoshRef.comb.modScore3.Neonate.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Neonate.Nasal.modScore3.legend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Nasal, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Neonate.Nasal.modScore3.nolegend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Nasal, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


#### IFN.Core Visualization Infant Major Annotation

```{r IFN.Core_Infant.Nasal}
Idents(YoshRef.comb.modScore3.Infant.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Infant.Nasal.modScore3.legend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Nasal, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Infant.Nasal.modScore3.nolegend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Nasal, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


```{r IFN.Core_YC.Nasal}
Idents(YoshRef.comb.modScore3.YC.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_YC.Nasal.modScore3.legend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.YC.Nasal, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_YC.Nasal.modScore3.nolegend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.YC.Nasal, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```
```{r IFN.Core_Child.Nasal}
Idents(YoshRef.comb.modScore3.Child.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Child.Nasal.modScore3.legend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Child.Nasal, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Child.Nasal.modScore3.nolegend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Child.Nasal, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

```{r IFN.Core_Adolescent.Nasal}
Idents(YoshRef.comb.modScore3.Adolescent.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Adolescent.Nasal.modScore3.legend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Nasal, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Adolescent.Nasal.modScore3.nolegend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Nasal, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

#### Bronchial
```{r IFN.Core_Neonate.Bronchial}
majorCols <- c("IFN.Core" = "red", "IFN.Core" = "purple", "IFN.Core" = "olivedrab1", "RareCellss" = "magenta")
maxScore = max(c(YoshRef.comb.modScore3.Neonate.Bronchial@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.Infant.Bronchial@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.YC.Bronchial@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.Child.Bronchial@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.Adolescent.Bronchial@meta.data$IFN.Core1)); 
minScore = min(c(YoshRef.comb.modScore3.Neonate.Bronchial@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.Infant.Bronchial@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.YC.Bronchial@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.Child.Bronchial@meta.data$IFN.Core1, 
    YoshRef.comb.modScore3.Adolescent.Bronchial@meta.data$IFN.Core1))
# +   scale_color_distiller(palette = "RdYlBu") +
Idents(YoshRef.comb.modScore3.Neonate.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Neonate.Bronchial.modScore3.legend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Bronchial, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Neonate.Bronchial.modScore3.nolegend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Bronchial, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


#### IFN.Core Visualization Infant Major Annotation

```{r IFN.Core_Infant.Bronchial}
Idents(YoshRef.comb.modScore3.Infant.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Infant.Bronchial.modScore3.legend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Bronchial, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Infant.Bronchial.modScore3.nolegend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Bronchial, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


```{r IFN.Core_YC.Bronchial}
Idents(YoshRef.comb.modScore3.YC.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_YC.Bronchial.modScore3.legend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.YC.Bronchial, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_YC.Bronchial.modScore3.nolegend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.YC.Bronchial, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```
```{r IFN.Core_Child.Bronchial}
Idents(YoshRef.comb.modScore3.Child.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Child.Bronchial.modScore3.legend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Child.Bronchial, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Child.Bronchial.modScore3.nolegend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Child.Bronchial, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

```{r IFN.Core_Adolescent.Bronchial}
Idents(YoshRef.comb.modScore3.Adolescent.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Adolescent.Bronchial.modScore3.legend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Bronchial, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Adolescent.Bronchial.modScore3.nolegend.IFN.IFN.Core.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Bronchial, reduction = "umap", pt.size = 2, features = "IFN.Core1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```


###IFN.Core ModScore
#### Nasal
```{r GobNetwork_Neonate.Nasa.Nasal}
majorCols <- c("Basal" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
maxScore = max(c(YoshRef.comb.modScore3.Neonate.Nasal@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.Infant.Nasal@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.YC.Nasal@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.Child.Nasal@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.Adolescent.Nasal@meta.data$GobNetwork1)); 
minScore = min(c(YoshRef.comb.modScore3.Neonate.Nasal@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.Infant.Nasal@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.YC.Nasal@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.Child.Nasal@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.Adolescent.Nasal@meta.data$GobNetwork1))
# +   scale_color_distiller(palette = "RdYlBu") +
Idents(YoshRef.comb.modScore3.Neonate.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Neonate.Nasal.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Nasal, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Neonate.Nasal.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Nasal, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


#### GobNetwork Visualization Infant Major Annotation

```{r GobNetwork_Infant.Nasal}
Idents(YoshRef.comb.modScore3.Infant.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Infant.Nasal.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Nasal, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Infant.Nasal.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Nasal, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


```{r GobNetwork_YC.Nasal}
Idents(YoshRef.comb.modScore3.YC.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_YC.Nasal.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.YC.Nasal, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_YC.Nasal.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.YC.Nasal, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```
```{r GobNetwork_Child.Nasal}
Idents(YoshRef.comb.modScore3.Child.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Child.Nasal.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Child.Nasal, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Child.Nasal.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Child.Nasal, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

```{r GobNetwork_Adolescent.Nasal}
Idents(YoshRef.comb.modScore3.Adolescent.Nasal) <- "majorAnnot"
pas9 <- "YoshRef_Adolescent.Nasal.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Nasal, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Adolescent.Nasal.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Nasal, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

#### Bronchial
```{r GobNetwork_Neonate.Bronchial}
majorCols <- c("GobNetwork" = "red", "GobNetwork" = "purple", "GobNetwork" = "olivedrab1", "RareCellss" = "magenta")
maxScore = max(c(YoshRef.comb.modScore3.Neonate.Bronchial@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.Infant.Bronchial@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.YC.Bronchial@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.Child.Bronchial@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.Adolescent.Bronchial@meta.data$GobNetwork1)); 
minScore = min(c(YoshRef.comb.modScore3.Neonate.Bronchial@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.Infant.Bronchial@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.YC.Bronchial@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.Child.Bronchial@meta.data$GobNetwork1, 
    YoshRef.comb.modScore3.Adolescent.Bronchial@meta.data$GobNetwork1))
# +   scale_color_distiller(palette = "RdYlBu") +
Idents(YoshRef.comb.modScore3.Neonate.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Neonate.Bronchial.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Bronchial, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Neonate.Bronchial.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Neonate.Bronchial, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


#### GobNetwork Visualization Infant Major Annotation

```{r GobNetwork_Infant.Bronchial}
Idents(YoshRef.comb.modScore3.Infant.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Infant.Bronchial.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Bronchial, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Infant.Bronchial.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Infant.Bronchial, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```


```{r GobNetwork_YC.Bronchial}
Idents(YoshRef.comb.modScore3.YC.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_YC.Bronchial.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.YC.Bronchial, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_YC.Bronchial.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.YC.Bronchial, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
```
```{r GobNetwork_Child.Bronchial}
Idents(YoshRef.comb.modScore3.Child.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Child.Bronchial.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Child.Bronchial, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Child.Bronchial.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Child.Bronchial, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

```{r GobNetwork_Adolescent.Bronchial}
Idents(YoshRef.comb.modScore3.Adolescent.Bronchial) <- "majorAnnot"
pas9 <- "YoshRef_Adolescent.Bronchial.modScore3.legend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas9), width =12, height = 8, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Bronchial, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 15)) + guides(color = guide_legend(override.aes = list(size=8))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Adolescent.Bronchial.modScore3.nolegend.GobNetwork.comb.png"
png(file.path(outPath.Epithelial.Yoshida, pas10), width =12, height = 8, units = "in", res = 600)
p2 <- FeaturePlot(YoshRef.comb.modScore3.Adolescent.Bronchial, reduction = "umap", pt.size = 2, features = "GobNetwork1", order = TRUE, label = FALSE) +
  scale_color_distiller(palette = "RdYlBu") + coord_fixed() + theme(axis.title = element_text(face="bold", family = "sans", size = 20), axis.text  = element_text(face="bold", family = "sans", size = 15), legend.text  = element_text(face="bold", family = "sans", size = 0)) + guides(color = guide_legend(override.aes = list(size=0))) + scale_colour_gradientn(colors = turbo(n = 5, direction = -1), limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.5))
print(p2)
dev.off()
###majorAnnot
```

```{r Age.VlnPlot}
Age.Colors =c("Nasal" = "coral1", "Bronchial" = "blue")
YoshRef.comb.modScore3@meta.data$Age_donor = factor(YoshRef.comb.modScore3@meta.data$Age_donor,
    levels = c("Neonate", "Infant", "Young child", "Child", "Adolescent"))
VPfname <- "YoshRef_Basal.ModScore.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 18, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.comb.modScore3, 
    features = "YoshidaBasalMarkers1", 
    group.by = "Age_donor", 
    cols = Age.Colors,
    pt.size = 1,
    split.by = "Samp.loc",
    split.plot = TRUE) +
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text  = element_text(face="bold", family = "sans", size = 40), 
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()

Age.Colors =c("Nasal" = "coral1", "Bronchial" = "blue")
VPfname <- "YoshRef_SecGob.ModScore.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 18, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.comb.modScore3, 
    features = "YoshidaSecGobMarkers1", 
    group.by = "Age_donor", 
    cols = Age.Colors,
    pt.size = 1,
    split.by = "Samp.loc",
    split.plot = TRUE) +
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text  = element_text(face="bold", family = "sans", size = 40), 
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()

Age.Colors =c("Nasal" = "coral1", "Bronchial" = "blue")
VPfname <- "YoshRef_Ciliated.ModScore.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 18, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.comb.modScore3, 
    features = "YoshidaCilMarkers1", 
    group.by = "Age_donor", 
    cols = Age.Colors,
    split.by = "Samp.loc",
    pt.size = 1,
    split.plot = TRUE) +
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text  = element_text(face="bold", family = "sans", size = 40), 
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()

Age.Colors =c("Nasal" = "coral1", "Bronchial" = "blue")
VPfname <- "YoshRef_GobNetwork.ModScore.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 18, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.comb.modScore3, 
    features = "GobNetwork1", 
    group.by = "Age_donor", 
    pt.size = 1,
    cols = Age.Colors,
    split.by = "Samp.loc",
    split.plot = TRUE) +
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text  = element_text(face="bold", family = "sans", size = 40), 
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()

Age.Colors =c("Nasal" = "coral1", "Bronchial" = "blue")
VPfname <- "YoshRef_IFN.Core1.ModScore.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 18, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.comb.modScore3, 
    features = "IFN.Core1", 
    group.by = "Age_donor", 
    pt.size = 1,
    cols = Age.Colors,
    split.by = "Samp.loc",
    split.plot = TRUE) +
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text  = element_text(face="bold", family = "sans", size = 40), 
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
```


```{r DifferentiallyExpressed}
#outPath.Epithelial.Yoshida = inPath
Age.Colors =c("Nasal" = "coral1", "Bronchial" = "blue")
YoshRef.comb.modScore3@meta.data$Age_donor = factor(YoshRef.comb.modScore3@meta.data$Age_donor,
    levels = c("Neonate", "Infant", "Young child", "Child", "Adolescent"))
VPfname <- "YoshRef_Basal.Samp.loc.ModScore.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 18, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.comb.modScore3, 
    features = "YoshidaBasalMarkers1", 
    group.by = "Samp.loc",
    cols = Age.Colors,
    pt.size = 1) +
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text  = element_text(face="bold", family = "sans", size = 40), 
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()

Age.Colors =c("Nasal" = "coral1", "Bronchial" = "blue")
VPfname <- "YoshRef_SecGob.Samp.loc.ModScore.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 18, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.comb.modScore3, 
    features = "YoshidaSecGobMarkers1", 
    group.by = "Samp.loc",
    cols = Age.Colors,
    pt.size = 1) +
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text  = element_text(face="bold", family = "sans", size = 40), 
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()

Age.Colors =c("Nasal" = "coral1", "Bronchial" = "blue")
VPfname <- "YoshRef_Ciliated.Samp.loc.ModScore.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 18, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.comb.modScore3, 
    features = "YoshidaCilMarkers1", 
    group.by = "Samp.loc",
    cols = Age.Colors,
    pt.size = 1) +
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text  = element_text(face="bold", family = "sans", size = 40), 
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()

Age.Colors =c("Nasal" = "coral1", "Bronchial" = "blue")
VPfname <- "YoshRef_GobNetwork.Samp.loc.ModScore.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 18, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.comb.modScore3, 
    features = "GobNetwork1", 
    group.by = "Samp.loc",
    cols = Age.Colors,
    pt.size = 1) +
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text  = element_text(face="bold", family = "sans", size = 40), 
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()

Age.Colors =c("Nasal" = "coral1", "Bronchial" = "blue")
VPfname <- "YoshRef_IFN.Core1.Samp.loc.ModScore.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 18, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.comb.modScore3, 
    features = "IFN.Core1", 
    group.by = "Samp.loc",
    cols = Age.Colors,
    pt.size = 1) +
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text  = element_text(face="bold", family = "sans", size = 40), 
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
```

```{r ExtractingData}
outPath.Epithelial.Yoshida = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
YoshRef.comb <- readRDS(file.path(outPath.Epithelial.Yoshida, paste("YoshRef.control.norm.AllSamplesres1.annotated.rds")))
YoshRef.comb.woImmune = YoshRef.comb
YoshRef.comb.Neonate <- subset(YoshRef.comb, subset = Age_donor == "Neonate")
YoshRef.comb.Infant <- subset(YoshRef.comb, subset = Age_donor == "Infant")
YoshRef.comb.YC <- subset(YoshRef.comb, subset = Age_donor == "Young child")
YoshRef.comb.Child <- subset(YoshRef.comb, subset = Age_donor == "Child")
YoshRef.comb.Adolescent <- subset(YoshRef.comb, subset = Age_donor == "Adolescent")
YoshRef.comb.woImmune.Neonate.Nasal <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Neonate" & Samp.loc == "Nasal")
YoshRef.comb.woImmune.Neonate.Bronchial <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Neonate" & Samp.loc == "Bronchial")
YoshRef.comb.woImmune.Infant.Nasal <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Infant" & Samp.loc == "Nasal")
YoshRef.comb.woImmune.Infant.Bronchial <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Infant" & Samp.loc == "Bronchial")
YoshRef.comb.woImmune.YC.Nasal <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Young child" & Samp.loc == "Nasal")
YoshRef.comb.woImmune.YC.Bronchial <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Young child" & Samp.loc == "Bronchial")
YoshRef.comb.woImmune.Child.Nasal <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Child" & Samp.loc == "Nasal")
YoshRef.comb.woImmune.Child.Bronchial <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Child" & Samp.loc == "Bronchial")
YoshRef.comb.woImmune.Adolescent.Nasal <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Adolescent" & Samp.loc == "Nasal")
YoshRef.comb.woImmune.Adolescent.Bronchial <- subset(YoshRef.comb.woImmune, 
    subset = Age_bin == "Adolescent" & Samp.loc == "Bronchial")
YoshRef.comb.woImmune.Bronchial <- subset(YoshRef.comb.woImmune, 
    subset = Samp.loc == "Bronchial")
YoshRef.comb.woImmune.Nasal <- subset(YoshRef.comb.woImmune, 
    subset = Samp.loc == "Nasal")
```

```{r SecGobRepression} 
'YoshRef.Epi.woImmune.Neonate.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Neonate")
YoshRef.Epi.woImmune.Infant.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Infant")
YoshRef.Epi.woImmune.YC.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Young child")
YoshRef.Epi.woImmune.Child.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Child")
YoshRef.Epi.woImmune.Adolescent.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Adolescent")'
SecGobRepress <- c("NKX2-1", "FOXA2", "FOXA3", "FOXJ1", "PIFO")
SecGobRepress <- list(SecGobRepress)
YoshRef.modScore3 <- AddModuleScore(YoshRef.comb, features = SecGobRepress, assay = "RNA", name = "SecGobRep")
CiliatedRepress <- c("SPDEF", "MUC5AC", "BPIFA2", "TFF1", "TFF2")
CiliatedRepress <- list(CiliatedRepress)
YoshRef.modScore3 <- AddModuleScore(YoshRef.modScore3, features = CiliatedRepress, assay = "RNA", name = "CiliatedRep")
```


```{r SecGobRepression} 
'YoshRef.Epi.woImmune.Neonate.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Neonate")
YoshRef.Epi.woImmune.Infant.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Infant")
YoshRef.Epi.woImmune.YC.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Young child")
YoshRef.Epi.woImmune.Child.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Child")
YoshRef.Epi.woImmune.Adolescent.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Adolescent")'
SecGobRepress <- c("NKX2-1", "FOXA2", "FOXA3", "FOXJ1", "PIFO")
SecGobRepress <- list(SecGobRepress)
###Nasal
YoshRef.Neonate.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Neonate.Nasal, features = SecGobRepress, assay = "RNA", name = "SecGobRep")
YoshRef.Infant.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Infant.Nasal, features = SecGobRepress, assay = "RNA", name = "SecGobRep")
YoshRef.YC.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.YC.Nasal, features = SecGobRepress, assay = "RNA", name = "SecGobRep")
YoshRef.Child.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Child.Nasal, features = SecGobRepress, assay = "RNA", name = "SecGobRep")
YoshRef.Adolescent.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Adolescent.Nasal, features = SecGobRepress, assay = "RNA", name = "SecGobRep")
###Bronchial
YoshRef.Neonate.Bronchial.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Neonate.Bronchial, features = SecGobRepress, assay = "RNA", name = "SecGobRep")
YoshRef.Infant.Bronchial.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Infant.Bronchial, features = SecGobRepress, assay = "RNA", name = "SecGobRep")
YoshRef.YC.Bronchial.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.YC.Bronchial, features = SecGobRepress, assay = "RNA", name = "SecGobRep")
YoshRef.Child.Bronchial.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Child.Bronchial, features = SecGobRepress, assay = "RNA", name = "SecGobRep")
YoshRef.Adolescent.Bronchial.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Adolescent.Bronchial, features = SecGobRepress, assay = "RNA", name = "SecGobRep")
```

```{r CiliatedRepression} 
'YoshRef.Epi.woImmune.Neonate.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Neonate")
YoshRef.Epi.woImmune.Infant.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Infant")
YoshRef.Epi.woImmune.YC.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Young child")
YoshRef.Epi.woImmune.Child.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Child")
YoshRef.Epi.woImmune.Adolescent.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Adolescent")'
CiliatedRepress <- c("SPDEF", "MUC5AC", "BPIFA2", "TFF1", "TFF2")
CiliatedRepress <- list(CiliatedRepress)
###Nasal
YoshRef.Neonate.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Neonate.Nasal, features = CiliatedRepress, assay = "RNA", name = "CiliatedRep")
YoshRef.Infant.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Infant.Nasal, features = CiliatedRepress, assay = "RNA", name = "CiliatedRep")
YoshRef.YC.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.YC.Nasal, features = CiliatedRepress, assay = "RNA", name = "CiliatedRep")
YoshRef.Child.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Child.Nasal, features = CiliatedRepress, assay = "RNA", name = "CiliatedRep")
YoshRef.Adolescent.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Adolescent.Nasal, features = CiliatedRepress, assay = "RNA", name = "CiliatedRep")
###Bronchial
YoshRef.Neonate.Bronchial.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Neonate.Bronchial, features = CiliatedRepress, assay = "RNA", name = "CiliatedRep")
YoshRef.Infant.Bronchial.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Infant.Bronchial, features = CiliatedRepress, assay = "RNA", name = "CiliatedRep")
YoshRef.YC.Bronchial.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.YC.Bronchial, features = CiliatedRepress, assay = "RNA", name = "CiliatedRep")
YoshRef.Child.Bronchial.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Child.Bronchial, features = CiliatedRepress, assay = "RNA", name = "CiliatedRep")
YoshRef.Adolescent.Bronchial.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Adolescent.Bronchial, features = CiliatedRepress, assay = "RNA", name = "CiliatedRep")
```

```{r SecGobRepression}
###Neonate
YoshRef.modScore3@meta.data$SecGobClass <- ifelse(
    YoshRef.modScore3@meta.data$SecGobRep1 <= 0, "SecGobNeg", "SecGobPos")
YoshRef.modScore3@meta.data$CiliatedClass <- ifelse(
    YoshRef.modScore3@meta.data$CiliatedRep1 <= 0, "CiliatedNeg", "CiliatedPos")
dat.SecGobRep <- t(table(YoshRef.modScore3@meta.data$SecGobClass, 
    YoshRef.modScore3@meta.data$sampleLoc_ageDonor))
dat.CiliatedRep <- t(table(YoshRef.modScore3@meta.data$CiliatedClass, 
    YoshRef.modScore3@meta.data$sampleLoc_ageDonor))
write.csv(dat.SecGobRep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.SecGob.Age.csv")))
write.csv(dat.CiliatedRep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.Ciliated.Age.csv")))

```

```{r Percentage_composition.SecGobClass}
inPath = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
SecGobClass.ModScore <- read.csv(file.path(inPath, "YoshRef.SecGob.Age.csv"))
SecGobClass.Pos <- SecGobClass.ModScore[which(SecGobClass.ModScore$SecGobRepressType == "SecGob.Pos"),]
#sampInfo.SecGobClass <- sampInfo[which(sampInfo$celltype == "SecGobClass"),]
SecGobClass.Pos$AgeGroup <- factor(SecGobClass.Pos$AgeGroup,
    levels = c("Neonate", "Infant", "YC", "Child", "Adolescent"))
SecGobClass.Pos$SampleLocation <- factor(SecGobClass.Pos$SampleLocation,
    levels = c("Nasal", "Bronchial"))
cols_plot = c(
    "Nasal" = "coral1", 
    "Bronchial" = "blue")
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(SecGobClass.Pos, aes(x = AgeGroup, 
    y = PercentofCells_per_SampLoc, group = SampleLocation, 
        color = SampleLocation)) + 
    scale_colour_manual (values = cols_plot) +
    geom_line(aes(group = SampleLocation), linewidth = 2) + 
    geom_point(aes(group = SampleLocation), size = 5) +
    ylab("% SecGobClass +tive \n cells per Location") +
    theme(axis.title.x = element_text(size = 30, face = "bold"),
        axis.title.y = element_text(size = 30, face = "bold",),
        axis.text.x = element_text(size = 25, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 25,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 20, face = "bold")) 
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.SecGobClassModScore.linePlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 14, height = 7, dpi = 600)
```


```{r Percentage_composition.CiliatedClass}
inPath = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
CiliatedClass.ModScore <- read.csv(file.path(inPath, "YoshRef.Ciliated.Age.csv"))
CiliatedClass.Pos <- CiliatedClass.ModScore[which(CiliatedClass.ModScore$CiliatedRepressType == "Ciliated.Pos"),]
#sampInfo.CiliatedClass <- sampInfo[which(sampInfo$celltype == "CiliatedClass"),]
CiliatedClass.Pos$AgeGroup <- factor(CiliatedClass.Pos$AgeGroup,
    levels = c("Neonate", "Infant", "YC", "Child", "Adolescent"))
CiliatedClass.Pos$SampleLocation <- factor(CiliatedClass.Pos$SampleLocation,
    levels = c("Nasal", "Bronchial"))
cols_plot = c(
    "Nasal" = "coral1", 
    "Bronchial" = "blue")
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(CiliatedClass.Pos, aes(x = AgeGroup, 
    y = PercentofCells_per_SampLoc, group = SampleLocation, 
        color = SampleLocation)) + 
    scale_colour_manual (values = cols_plot) +
    geom_line(aes(group = SampleLocation), linewidth = 2) + 
    geom_point(aes(group = SampleLocation), size = 5) +
    ylab("% CiliatedClass +tive \n cells per Location") +
    theme(axis.title.x = element_text(size = 30, face = "bold"),
        axis.title.y = element_text(size = 30, face = "bold",),
        axis.text.x = element_text(size = 25, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 25,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 20, face = "bold")) 
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.CiliatedClassModScore.linePlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 14, height = 7, dpi = 600)
```

```{r SecGobRepression} 
'YoshRef.Epi.woImmune.Neonate.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Neonate")
YoshRef.Epi.woImmune.Infant.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Infant")
YoshRef.Epi.woImmune.YC.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Young child")
YoshRef.Epi.woImmune.Child.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Child")
YoshRef.Epi.woImmune.Adolescent.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Adolescent")'

#inPath = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples/"
#YoshRef.comb <- readRDS(file.path(inPath, "YoshRef.control.norm.AllSamplesres1.annotated.rds"))
IL6_JAK_STAT3 <- c("A2M", "ACVR1B", "ACVRL1", "BAK1", "CBL", "CCL7", "CCR1", "CD14", "CD36", "CD38", "CD44", "CD9", "CNTFR", "CRLF2", "CSF1", "CSF2", "CSF2RA", "CSF2RB", "CSF3R", "CXCL1", "CXCL10", "CXCL11", "CXCL13", "CXCL3", "CXCL9", "DNTT", "EBI3", "FAS", "GRB2", "HAX1", "HMOX1", "IFNAR1", "IFNGR1", "IFNGR2", "IL10RB", "IL12RB1", "IL13RA1", "IL15RA", "IL17RA", "IL17RB", "IL18R1", "IL1B", "IL1R1", "IL1R2", "IL2RA", "IL2RG", "IL3RA", "IL4R", "IL6", "IL6ST", "IL7", "IL9R", "INHBE", "IRF1", "IRF9", "ITGA4", "ITGB3", "JUN", "LEPR", "LTB", "LTBR", "MAP3K8", "MYD88", "OSMR", "PDGFC", "PF4", "PIK3R5", "PIM1", "PLA2G2A", "PTPN1", "PTPN11", "PTPN2", "REG1A", "SOCS1", "SOCS3", "STAM2", "STAT1", "STAT2", "STAT3", "TGFB1", "TLR2", "TNF", "TNFRSF12A", "TNFRSF1A", "TNFRSF1B", "TNFRSF21", "TYK2")
InterFeronAlpha <- c("ADAR", "B2M", "BATF2", "BST2", "C1S", "CASP1", "CASP8", "CCRL2", "CD47", "CD74", "CMPK2", "CMTR1", "CNP", "CSF1", "CXCL10", "CXCL11", "DDX60", "DHX58", "EIF2AK2", "ELF1", "EPSTI1", "GBP2", "GBP4", "GMPR", "HELZ2", "HERC6", "HLA-C", "IFI27", "IFI30", "IFI35", "IFI44", "IFI44L", "IFIH1", "IFIT2", "IFIT3", "IFITM1", "IFITM2", "IFITM3", "IL15", "IL4R", "IL7", "IRF1", "IRF2", "IRF7", "IRF9", "ISG15", "ISG20", "LAMP3", "LAP3", "LGALS3BP", "LPAR6", "LY6E", "MOV10", "MVB12A", "MX1", "NCOA7", "NMI", "NUB1", "OAS1", "OASL", "OGFR", "PARP12", "PARP14", "PARP9", "PLSCR1", "PNPT1", "PROCR", "PSMA3", "PSMB8", "PSMB9", "PSME1", "PSME2", "RIPK2", "RNF31", "RSAD2", "RTP4", "SAMD9", "SAMD9L", "SELL", "SLC25A28", "SP110", "STAT2", "TAP1", "TDRD7", "TENT5A", "TMEM140", "TRAFD1", "TRIM14", "TRIM21", "TRIM25", "TRIM26", "TRIM5", "TXNIP", "UBA7", "UBE2L6", "USP18", "WARS1")
#SecGobRepress <- c("NKX2-1", "FOXA2", "FOXA3", "FOXJ1", "PIFO")
IL6_JAK_STAT3 <- list(IL6_JAK_STAT3)
YoshRef.modScore3 <- AddModuleScore(YoshRef.comb, features = IL6_JAK_STAT3, assay = "RNA", name = "IL6_JAK")
#CiliatedRepress <- c("SPDEF", "MUC5AC", "BPIFA2", "TFF1", "TFF2")
InterFeronAlpha <-  InterFeronAlpha[!InterFeronAlpha %in% c("WARS1")]
InterFeronAlpha <- list(InterFeronAlpha)
YoshRef.modScore3 <- AddModuleScore(YoshRef.modScore3, features = InterFeronAlpha, assay = "RNA", name = "InterFeronAlpha")
```

```{r SecGobRepression}
###Neonate
YoshRef.modScore3@meta.data$IL6_JAK_STAT3Class <- ifelse(
    YoshRef.modScore3@meta.data$IL6_JAK1 <= 0, "IL6_JAK_STAT3Neg", "IL6_JAK_STAT3Pos")
YoshRef.modScore3@meta.data$InterFeronAlphaClass <- ifelse(
    YoshRef.modScore3@meta.data$InterFeronAlpha1 <= 0, "InterFeronAlphaNeg", "InterFeronAlphaPos")
dat.IL6_JAK_STAT3Rep <- t(table(YoshRef.modScore3@meta.data$IL6_JAK_STAT3Class, 
    YoshRef.modScore3@meta.data$sampleLoc_ageDonor))
dat.InterFeronAlphaRep <- t(table(YoshRef.modScore3@meta.data$InterFeronAlphaClass, 
    YoshRef.modScore3@meta.data$sampleLoc_ageDonor))
write.csv(dat.IL6_JAK_STAT3Rep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.IL6_JAK_STAT3.Age1.csv")))
write.csv(dat.InterFeronAlphaRep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.InterFeronAlpha.Age1.csv")))
```

```{r Percentage_composition.IL6_JAK_STAT3Class}
inPath = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
IL6_JAK_STAT3Class.ModScore <- read.csv(file.path(inPath, "YoshRef.IL6_JAK_STAT3.Age.csv"))
IL6_JAK_STAT3Class.Pos <- IL6_JAK_STAT3Class.ModScore[which(IL6_JAK_STAT3Class.ModScore$IL6_JAK_STAT3Type == "IL6_JAK_STAT3Pos"),]
#sampInfo.IL6_JAK_STAT3Class <- sampInfo[which(sampInfo$celltype == "IL6_JAK_STAT3Class"),]
IL6_JAK_STAT3Class.Pos$AgeGroup <- factor(IL6_JAK_STAT3Class.Pos$AgeGroup,
    levels = c("Neonate", "Infant", "YC", "Child", "Adolescent"))
IL6_JAK_STAT3Class.Pos$SampleLocation <- factor(IL6_JAK_STAT3Class.Pos$SampleLocation,
    levels = c("Nasal", "Bronchial"))
cols_plot = c(
    "Nasal" = "coral1", 
    "Bronchial" = "blue")
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(IL6_JAK_STAT3Class.Pos, aes(x = AgeGroup, 
    y = PercentofCells_per_SampLoc, group = SampleLocation, 
        color = SampleLocation)) + 
    scale_colour_manual (values = cols_plot) +
    geom_line(aes(group = SampleLocation), linewidth = 2) + 
    geom_point(aes(group = SampleLocation), size = 5) +
    ylab("% IL6_JAK_STAT3Class +tive \n cells per Location") +
    theme(axis.title.x = element_text(size = 30, face = "bold"),
        axis.title.y = element_text(size = 30, face = "bold",),
        axis.text.x = element_text(size = 25, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 25,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 20, face = "bold")) 
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.IL6_JAK_STAT3ClassModScore.linePlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 14, height = 7, dpi = 600)
```


```{r Percentage_composition.InterFeronAlphaClass}
inPath = "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
InterFeronAlphaClass.ModScore <- read.csv(file.path(inPath, "YoshRef.InterFeronAlpha.Age.csv"))
InterFeronAlphaClass.Pos <- InterFeronAlphaClass.ModScore[which(InterFeronAlphaClass.ModScore$InterFeronAlphaType == "InterFeronAlphaPos"),]
#sampInfo.InterFeronAlphaClass <- sampInfo[which(sampInfo$celltype == "InterFeronAlphaClass"),]
InterFeronAlphaClass.Pos$AgeGroup <- factor(InterFeronAlphaClass.Pos$AgeGroup,
    levels = c("Neonate", "Infant", "YC", "Child", "Adolescent"))
InterFeronAlphaClass.Pos$SampleLocation <- factor(InterFeronAlphaClass.Pos$SampleLocation,
    levels = c("Nasal", "Bronchial"))
cols_plot = c(
    "Nasal" = "coral1", 
    "Bronchial" = "blue")
outPath.Epithelium.woImmune.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
plt.barplot <- ggplot(InterFeronAlphaClass.Pos, aes(x = AgeGroup, 
    y = PercentofCells_per_SampLoc, group = SampleLocation, 
        color = SampleLocation)) + 
    scale_colour_manual (values = cols_plot) +
    geom_line(aes(group = SampleLocation), linewidth = 2) + 
    geom_point(aes(group = SampleLocation), size = 5) +
    ylab("% InterFeronAlphaClass +tive \n cells per Location") +
    theme(axis.title.x = element_text(size = 30, face = "bold"),
        axis.title.y = element_text(size = 30, face = "bold",),
        axis.text.x = element_text(size = 25, angle = 45, hjust = 1, face = "bold"),
        axis.text.y = element_text(size = 25,  face = "bold"),
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 15, face = "bold"),
        legend.text = element_text(size = 20, face = "bold")) 
print(plt.barplot)
#dev.off()
output_file_immune_cell <- file.path(outPath.Epithelium.woImmune.Yoshida, "YoshRef.Nasal_Bronchial.InterFeronAlphaClassModScore.linePlot.png")
ggsave(filename = output_file_immune_cell, plot = plt.barplot, width = 14, height = 7, dpi = 600)
```

```{r extractNasal}
#YoshRef.comb.woImmune <- YoshRef.comb1
YoshRef.comb <- subset(YoshRef.comb.woImmune, subset = Samp.loc == "Nasal")
saveRDS(YoshRef.comb, file.path(outPath.Epithelial.Yoshida, "YoshRef.NasalEpithelium.res1.rds"))### Only the nasal epithelium
#outPath.Epithelial.Yoshida <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida/YoshRef.control.norm.leiden/YoshRef.control.norm.leiden.AllSamples"
#YoshRef.comb1 <- readRDS(file.path(outPath.Epithelial.Yoshida, "YoshRef.Nasal_Bronchial.Epithelium.res1.rds"))
YoshRef.comb.woImmune.Neonate.Nasal<- subset(YoshRef.comb, subset = Age_donor == "Neonate")
YoshRef.comb.woImmune.Infant.Nasal <- subset(YoshRef.comb, subset = Age_donor == "Infant")
YoshRef.comb.woImmune.YC.Nasal <- subset(YoshRef.comb, subset = Age_donor == "Young child")
YoshRef.comb.woImmune.Child.Nasal <- subset(YoshRef.comb, subset = Age_donor == "Child")
YoshRef.comb.woImmune.Adolescent.Nasal <- subset(YoshRef.comb, subset = Age_donor == "Adolescent")
YoshRef.comb.woImmune.Adult.Nasal <- subset(YoshRef.comb, subset = Age_donor == "Adult")
```

```{r IL6_JAK_STAT3} 
'YoshRef.Epi.woImmune.Neonate.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Neonate")
YoshRef.Epi.woImmune.Infant.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Infant")
YoshRef.Epi.woImmune.YC.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Young child")
YoshRef.Epi.woImmune.Child.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Child")
YoshRef.Epi.woImmune.Adolescent.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Adolescent")'

IL6_JAK_STAT3 <- c("A2M", "ACVR1B", "ACVRL1", "BAK1", "CBL", "CCL7", "CCR1", "CD14", "CD36", "CD38", "CD44", "CD9", "CNTFR", "CRLF2", "CSF1", "CSF2", "CSF2RA", "CSF2RB", "CSF3R", "CXCL1", "CXCL10", "CXCL11", "CXCL13", "CXCL3", "CXCL9", "DNTT", "EBI3", "FAS", "GRB2", "HAX1", "HMOX1", "IFNAR1", "IFNGR1", "IFNGR2", "IL10RB", "IL12RB1", "IL13RA1", "IL15RA", "IL17RA", "IL17RB", "IL18R1", "IL1B", "IL1R1", "IL1R2", "IL2RA", "IL2RG", "IL3RA", "IL4R", "IL6", "IL6ST", "IL7", "IL9R", "INHBE", "IRF1", "IRF9", "ITGA4", "ITGB3", "JUN", "LEPR", "LTB", "LTBR", "MAP3K8", "MYD88", "OSMR", "PDGFC", "PF4", "PIK3R5", "PIM1", "PLA2G2A", "PTPN1", "PTPN11", "PTPN2", "REG1A", "SOCS1", "SOCS3", "STAM2", "STAT1", "STAT2", "STAT3", "TGFB1", "TLR2", "TNF", "TNFRSF12A", "TNFRSF1A", "TNFRSF1B", "TNFRSF21", "TYK2")

InterFeronAlpha <- c("ADAR", "B2M", "BATF2", "BST2", "C1S", "CASP1", "CASP8", "CCRL2", "CD47", "CD74", "CMPK2", "CMTR1", "CNP", "CSF1", "CXCL10", "CXCL11", "DDX60", "DHX58", "EIF2AK2", "ELF1", "EPSTI1", "GBP2", "GBP4", "GMPR", "HELZ2", "HERC6", "HLA-C", "IFI27", "IFI30", "IFI35", "IFI44", "IFI44L", "IFIH1", "IFIT2", "IFIT3", "IFITM1", "IFITM2", "IFITM3", "IL15", "IL4R", "IL7", "IRF1", "IRF2", "IRF7", "IRF9", "ISG15", "ISG20", "LAMP3", "LAP3", "LGALS3BP", "LPAR6", "LY6E", "MOV10", "MVB12A", "MX1", "NCOA7", "NMI", "NUB1", "OAS1", "OASL", "OGFR", "PARP12", "PARP14", "PARP9", "PLSCR1", "PNPT1", "PROCR", "PSMA3", "PSMB8", "PSMB9", "PSME1", "PSME2", "RIPK2", "RNF31", "RSAD2", "RTP4", "SAMD9", "SAMD9L", "SELL", "SLC25A28", "SP110", "STAT2", "TAP1", "TDRD7", "TENT5A", "TMEM140", "TRAFD1", "TRIM14", "TRIM21", "TRIM25", "TRIM26", "TRIM5", "TXNIP", "UBA7", "UBE2L6", "USP18", "WARS1")
#SecGobRepress <- c("NKX2-1", "FOXA2", "FOXA3", "FOXJ1", "PIFO")
IL6_JAK_STAT3 <- list(IL6_JAK_STAT3)
YoshRef.modScore3 <- AddModuleScore(YoshRef.comb, features = IL6_JAK_STAT3, assay = "RNA", name = "IL6_JAK")
#CiliatedRepress <- c("SPDEF", "MUC5AC", "BPIFA2", "TFF1", "TFF2")
InterFeronAlpha <-  InterFeronAlpha[!InterFeronAlpha %in% c("WARS1")]
InterFeronAlpha <- list(InterFeronAlpha)
YoshRef.modScore3 <- AddModuleScore(YoshRef.modScore3, features = InterFeronAlpha, assay = "RNA", name = "InterFeronAlpha")
```


```{r IL6_JAK_STAT3} 
'YoshRef.Epi.woImmune.Neonate.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Neonate")
YoshRef.Epi.woImmune.Infant.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Infant")
YoshRef.Epi.woImmune.YC.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Young child")
YoshRef.Epi.woImmune.Child.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Child")
YoshRef.Epi.woImmune.Adolescent.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Adolescent")'
IL6_JAK_STAT3 <- c("A2M", "ACVR1B", "ACVRL1", "BAK1", "CBL", "CCL7", "CCR1", "CD14", "CD36", "CD38", "CD44", "CD9", "CNTFR", "CRLF2", "CSF1", "CSF2", "CSF2RA", "CSF2RB", "CSF3R", "CXCL1", "CXCL10", "CXCL11", "CXCL13", "CXCL3", "CXCL9", "DNTT", "EBI3", "FAS", "GRB2", "HAX1", "HMOX1", "IFNAR1", "IFNGR1", "IFNGR2", "IL10RB", "IL12RB1", "IL13RA1", "IL15RA", "IL17RA", "IL17RB", "IL18R1", "IL1B", "IL1R1", "IL1R2", "IL2RA", "IL2RG", "IL3RA", "IL4R", "IL6", "IL6ST", "IL7", "IL9R", "INHBE", "IRF1", "IRF9", "ITGA4", "ITGB3", "JUN", "LEPR", "LTB", "LTBR", "MAP3K8", "MYD88", "OSMR", "PDGFC", "PF4", "PIK3R5", "PIM1", "PLA2G2A", "PTPN1", "PTPN11", "PTPN2", "REG1A", "SOCS1", "SOCS3", "STAM2", "STAT1", "STAT2", "STAT3", "TGFB1", "TLR2", "TNF", "TNFRSF12A", "TNFRSF1A", "TNFRSF1B", "TNFRSF21", "TYK2")
IL6_JAK_STAT3 <- list(IL6_JAK_STAT3)

###Nasal
YoshRef.Neonate.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Neonate.Nasal, features = IL6_JAK_STAT3, assay = "RNA", name = "IL6_JAK")
YoshRef.Infant.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Infant.Nasal, features = IL6_JAK_STAT3, assay = "RNA", name = "IL6_JAK")
YoshRef.YC.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.YC.Nasal, features = IL6_JAK_STAT3, assay = "RNA", name = "IL6_JAK")
YoshRef.Child.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Child.Nasal, features = IL6_JAK_STAT3, assay = "RNA", name = "IL6_JAK")
YoshRef.Adolescent.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Adolescent.Nasal, features = IL6_JAK_STAT3, assay = "RNA", name = "IL6_JAK")
YoshRef.Adolescent.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Adolescent.Nasal, features = IL6_JAK_STAT3, assay = "RNA", name = "IL6_JAK")
YoshRef.Adult.Nasal.modScore3 <- AddModuleScore(YoshRef.comb.woImmune.Adult.Nasal, features = IL6_JAK_STAT3, assay = "RNA", name = "IL6_JAK")
```

```{r InterFeronAlpha} 
'YoshRef.Epi.woImmune.Neonate.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Neonate")
YoshRef.Epi.woImmune.Infant.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Infant")
YoshRef.Epi.woImmune.YC.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Young child")
YoshRef.Epi.woImmune.Child.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Child")
YoshRef.Epi.woImmune.Adolescent.Bronchi <- subset(YoshRef.comb.woImmune.Bronchi, subset = Age_donor == "Adolescent")'
InterFeronAlpha <- c("ADAR", "B2M", "BATF2", "BST2", "C1S", "CASP1", "CASP8", "CCRL2", "CD47", "CD74", "CMPK2", "CMTR1", "CNP", "CSF1", "CXCL10", "CXCL11", "DDX60", "DHX58", "EIF2AK2", "ELF1", "EPSTI1", "GBP2", "GBP4", "GMPR", "HELZ2", "HERC6", "HLA-C", "IFI27", "IFI30", "IFI35", "IFI44", "IFI44L", "IFIH1", "IFIT2", "IFIT3", "IFITM1", "IFITM2", "IFITM3", "IL15", "IL4R", "IL7", "IRF1", "IRF2", "IRF7", "IRF9", "ISG15", "ISG20", "LAMP3", "LAP3", "LGALS3BP", "LPAR6", "LY6E", "MOV10", "MVB12A", "MX1", "NCOA7", "NMI", "NUB1", "OAS1", "OASL", "OGFR", "PARP12", "PARP14", "PARP9", "PLSCR1", "PNPT1", "PROCR", "PSMA3", "PSMB8", "PSMB9", "PSME1", "PSME2", "RIPK2", "RNF31", "RSAD2", "RTP4", "SAMD9", "SAMD9L", "SELL", "SLC25A28", "SP110", "STAT2", "TAP1", "TDRD7", "TENT5A", "TMEM140", "TRAFD1", "TRIM14", "TRIM21", "TRIM25", "TRIM26", "TRIM5", "TXNIP", "UBA7", "UBE2L6", "USP18", "WARS1")
InterFeronAlpha <-  InterFeronAlpha[!InterFeronAlpha %in% c("WARS1")]
InterFeronAlpha <- list(InterFeronAlpha)
""
###Nasal

YoshRef.Neonate.Nasal.modScore3 <- AddModuleScore(YoshRef.Neonate.Nasal.modScore3, features = InterFeronAlpha, assay = "RNA", name = "InterFeronAlpha")
YoshRef.Infant.Nasal.modScore3 <- AddModuleScore(YoshRef.Infant.Nasal.modScore3, features = InterFeronAlpha, assay = "RNA", name = "InterFeronAlpha")
YoshRef.YC.Nasal.modScore3 <- AddModuleScore(YoshRef.YC.Nasal.modScore3, features = InterFeronAlpha, assay = "RNA", name = "InterFeronAlpha")
YoshRef.Child.Nasal.modScore3 <- AddModuleScore(YoshRef.Child.Nasal.modScore3, features = InterFeronAlpha, assay = "RNA", name = "InterFeronAlpha")
YoshRef.Adolescent.Nasal.modScore3 <- AddModuleScore(YoshRef.Adolescent.Nasal.modScore3, features = InterFeronAlpha, assay = "RNA", name = "InterFeronAlpha")
YoshRef.Adult.Nasal.modScore3 <- AddModuleScore(YoshRef.Adult.Nasal.modScore3, features = InterFeronAlpha, assay = "RNA", name = "InterFeronAlpha")
```

```{r IL6_JAK_STAT3.Annotation}
###Annotating IL6_JAK_STAT3
YoshRef.Neonate.Nasal.modScore3@meta.data$IL6_JAK_STAT3Class <- ifelse(
    YoshRef.Neonate.Nasal.modScore3@meta.data$IL6_JAK1 <= 0, "IL6_JAK_STAT3Neg", "IL6_JAK_STAT3Pos")
YoshRef.Infant.Nasal.modScore3@meta.data$IL6_JAK_STAT3Class <- ifelse(
    YoshRef.Infant.Nasal.modScore3@meta.data$IL6_JAK1 <= 0, "IL6_JAK_STAT3Neg", "IL6_JAK_STAT3Pos")
YoshRef.YC.Nasal.modScore3@meta.data$IL6_JAK_STAT3Class <- ifelse(
    YoshRef.YC.Nasal.modScore3@meta.data$IL6_JAK1 <= 0, "IL6_JAK_STAT3Neg", "IL6_JAK_STAT3Pos")
YoshRef.Child.Nasal.modScore3@meta.data$IL6_JAK_STAT3Class <- ifelse(
    YoshRef.Child.Nasal.modScore3@meta.data$IL6_JAK1 <= 0, "IL6_JAK_STAT3Neg", "IL6_JAK_STAT3Pos")
YoshRef.Adolescent.Nasal.modScore3@meta.data$IL6_JAK_STAT3Class <- ifelse(
    YoshRef.Adolescent.Nasal.modScore3@meta.data$IL6_JAK1 <= 0, "IL6_JAK_STAT3Neg", "IL6_JAK_STAT3Pos")
YoshRef.Adult.Nasal.modScore3@meta.data$IL6_JAK_STAT3Class <- ifelse(
    YoshRef.Adult.Nasal.modScore3@meta.data$IL6_JAK1 <= 0, "IL6_JAK_STAT3Neg", "IL6_JAK_STAT3Pos")
###Frequency IL6_JAK_STAT3
dat.Neonate.IL6_JAK_STAT3Rep <- t(table(YoshRef.Neonate.Nasal.modScore3@meta.data$IL6_JAK_STAT3Class, 
    YoshRef.Neonate.Nasal.modScore3@meta.data$majorAnnot))
dat.Infant.IL6_JAK_STAT3Rep <- t(table(YoshRef.Infant.Nasal.modScore3@meta.data$IL6_JAK_STAT3Class, 
    YoshRef.Infant.Nasal.modScore3@meta.data$majorAnnot))
dat.YC.IL6_JAK_STAT3Rep <- t(table(YoshRef.YC.Nasal.modScore3@meta.data$IL6_JAK_STAT3Class, 
    YoshRef.YC.Nasal.modScore3@meta.data$majorAnnot))
dat.Child.IL6_JAK_STAT3Rep <- t(table(YoshRef.Child.Nasal.modScore3@meta.data$IL6_JAK_STAT3Class, 
    YoshRef.Child.Nasal.modScore3@meta.data$majorAnnot))
dat.Adolescent.IL6_JAK_STAT3Rep <- t(table(YoshRef.Adolescent.Nasal.modScore3@meta.data$IL6_JAK_STAT3Class, 
    YoshRef.Adolescent.Nasal.modScore3@meta.data$majorAnnot))
dat.Adult.IL6_JAK_STAT3Rep <- t(table(YoshRef.Adult.Nasal.modScore3@meta.data$IL6_JAK_STAT3Class, 
    YoshRef.Adult.Nasal.modScore3@meta.data$majorAnnot))
###Saving the data
write.csv(dat.Neonate.IL6_JAK_STAT3Rep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.Neonate.IL6_JAK_STAT3.Annotation.csv")))
write.csv(dat.Infant.IL6_JAK_STAT3Rep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.Infant.IL6_JAK_STAT3.Annotation.csv")))
write.csv(dat.YC.IL6_JAK_STAT3Rep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.YC.IL6_JAK_STAT3.Annotation.csv")))
write.csv(dat.Child.IL6_JAK_STAT3Rep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.Child.IL6_JAK_STAT3.Annotation.csv")))
write.csv(dat.Adolescent.IL6_JAK_STAT3Rep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.Adolescent.IL6_JAK_STAT3.Annotation.csv")))
write.csv(dat.Adult.IL6_JAK_STAT3Rep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.Adult.IL6_JAK_STAT3.Annotation.csv")))
YoshRef.modScore3@meta.data$IL6_JAK_STAT3Class <- ifelse(
    YoshRef.modScore3@meta.data$IL6_JAK1 <= 0, "IL6_JAK_STAT3Neg", "IL6_JAK_STAT3Pos")
dat.IL6_JAK_STAT3Rep <- t(table(YoshRef.modScore3@meta.data$IL6_JAK_STAT3Class, 
    YoshRef.modScore3@meta.data$Age_donor))
write.csv(dat.IL6_JAK_STAT3Rep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.IL6_JAK_STAT3.AgeRange.csv")))
```

```{r InterFeronAlpha.Annotation}
###Annotating InterFeronAlpha1
YoshRef.Neonate.Nasal.modScore3@meta.data$InterFeronAlphaClass <- ifelse(
    YoshRef.Neonate.Nasal.modScore3@meta.data$InterFeronAlpha1 <= 0, "InterFeronAlphaNeg", "InterFeronAlphaPos")
YoshRef.Infant.Nasal.modScore3@meta.data$InterFeronAlphaClass <- ifelse(
    YoshRef.Infant.Nasal.modScore3@meta.data$InterFeronAlpha1 <= 0, "InterFeronAlphaNeg", "InterFeronAlphaPos")
YoshRef.YC.Nasal.modScore3@meta.data$InterFeronAlphaClass <- ifelse(
    YoshRef.YC.Nasal.modScore3@meta.data$InterFeronAlpha1 <= 0, "InterFeronAlphaNeg", "InterFeronAlphaPos")
YoshRef.Child.Nasal.modScore3@meta.data$InterFeronAlphaClass <- ifelse(
    YoshRef.Child.Nasal.modScore3@meta.data$InterFeronAlpha1 <= 0, "InterFeronAlphaNeg", "InterFeronAlphaPos")
YoshRef.Adolescent.Nasal.modScore3@meta.data$InterFeronAlphaClass <- ifelse(
    YoshRef.Adolescent.Nasal.modScore3@meta.data$InterFeronAlpha1 <= 0, "InterFeronAlphaNeg", "InterFeronAlphaPos")
YoshRef.Adult.Nasal.modScore3@meta.data$InterFeronAlphaClass <- ifelse(
    YoshRef.Adult.Nasal.modScore3@meta.data$InterFeronAlpha1 <= 0, "InterFeronAlphaNeg", "InterFeronAlphaPos")
###Frequency InterFeronAlpha1
dat.Neonate.InterFeronAlpha1Rep <- t(table(YoshRef.Neonate.Nasal.modScore3@meta.data$InterFeronAlphaClass, 
    YoshRef.Neonate.Nasal.modScore3@meta.data$majorAnnot))
dat.Infant.InterFeronAlpha1Rep <- t(table(YoshRef.Infant.Nasal.modScore3@meta.data$InterFeronAlphaClass, 
    YoshRef.Infant.Nasal.modScore3@meta.data$majorAnnot))
dat.YC.InterFeronAlpha1Rep <- t(table(YoshRef.YC.Nasal.modScore3@meta.data$InterFeronAlphaClass, 
    YoshRef.YC.Nasal.modScore3@meta.data$majorAnnot))
dat.Child.InterFeronAlpha1Rep <- t(table(YoshRef.Child.Nasal.modScore3@meta.data$InterFeronAlphaClass, 
    YoshRef.Child.Nasal.modScore3@meta.data$majorAnnot))
dat.Adolescent.InterFeronAlpha1Rep <- t(table(YoshRef.Adolescent.Nasal.modScore3@meta.data$InterFeronAlphaClass, 
    YoshRef.Adolescent.Nasal.modScore3@meta.data$majorAnnot))
dat.Adult.InterFeronAlpha1Rep <- t(table(YoshRef.Adult.Nasal.modScore3@meta.data$InterFeronAlphaClass, 
    YoshRef.Adult.Nasal.modScore3@meta.data$majorAnnot))
###Saving the data
write.csv(dat.Neonate.InterFeronAlpha1Rep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.Neonate.InterFeronAlpha1.Annotation.csv")))
write.csv(dat.Infant.InterFeronAlpha1Rep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.Infant.InterFeronAlpha1.Annotation.csv")))
write.csv(dat.YC.InterFeronAlpha1Rep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.YC.InterFeronAlpha1.Annotation.csv")))
write.csv(dat.Child.InterFeronAlpha1Rep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.Child.InterFeronAlpha1.Annotation.csv")))
write.csv(dat.Adolescent.InterFeronAlpha1Rep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.Adolescent.InterFeronAlpha1.Annotation.csv")))
write.csv(dat.Adult.InterFeronAlpha1Rep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.Adult.InterFeronAlpha1.Annotation.csv")))
YoshRef.modScore3@meta.data$InterFeronAlphaClass <- ifelse(
    YoshRef.modScore3@meta.data$InterFeronAlpha1 <= 0, "InterFeronAlphaNeg", "InterFeronAlphaPos")
dat.InterFeronAlphaClassRep <- t(table(YoshRef.modScore3@meta.data$InterFeronAlphaClass, 
    YoshRef.modScore3@meta.data$Age_donor))
write.csv(dat.InterFeronAlphaClassRep, file.path(outPath.Epithelial.Yoshida, 
    paste("YoshRef.nterFeronAlpha.AgeRange.csv")))
```


```{r InterFeronAlpha}
'cols_plot = c("Neonate" = "dodgerblue4", "Young_infant" = "seagreen", 
              "Infant" = "darkolivegreen", "Young_child" = "blue", 
              "Child" = "hotpink", "Adolescent" = "magenta", 
              "Adult" = "darkolivegreen")'
# +   scale_color_distiller(palette = "RdYlBu") +
Idents(YoshRef.modScore3) <- "Age_donor"
pas9 <- "YoshRef.Epithelial.InterFeronAlpha.Age_donor.comb.Legend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.modScore3, reduction = "umap", pt.size = 2, 
    features = "InterFeronAlpha1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=8))) 
print(p1)
dev.off()
pas10 <- "YoshRef.Epithelial.InterFeronAlpha.Age_donor.comb.noLegend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p2 <- FeaturePlot(YoshRef.modScore3, reduction = "umap", pt.size = 2, 
    features = "InterFeronAlpha1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=0))) 
print(p2)
dev.off()
###majorAnnot
#
ageCols = c("Neonate" = "blue4", "Infant" = "deepskyblue", "Young child" = "cyan",
    "Child" = "darkolivegreen1", "Adolescent" = "darkseagreen4", "Adult" = "forestgreen")
YoshRef.modScore3$Age_donor = factor(YoshRef.modScore3$Age_donor, c("Neonate", "Infant", 
"Young child", "Child", "Adolescent", "Adult"))

VPfname <- "YoshRef.Epithelial.InterFeronAlpha.Age_donor.VP.emf"
emf(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
vln1 <- VlnPlot(YoshRef.modScore3, features = "InterFeronAlpha1", 
   group.by = "Age_donor", cols = ageCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(vln1)
dev.off()
RPfname <- "YoshRef.Epithelial.InterFeronAlpha.Age_donor.RP.emf"
emf(file.path(outPath.Epithelial.Yoshida, RPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
rdg1 <- RidgePlot(YoshRef.modScore3, features = "InterFeronAlpha1", 
   group.by = "Age_donor", cols = ageCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(rdg1)
dev.off()
```


# +   scale_color_distiller(palette = "RdYlBu") +
```{r IL6_JAK}
'cols_plot = c("Neonate" = "dodgerblue4", "Young_infant" = "seagreen", 
              "Infant" = "darkolivegreen", "Young_child" = "blue", 
              "Child" = "hotpink", "Adolescent" = "magenta", 
              "Adult" = "darkolivegreen")'
# +   scale_color_distiller(palette = "RdYlBu") +
Idents(YoshRef.Epithelial.modScore3) <- "Age_donor"
pas9 <- "YoshRef.Epithelial.IL6_JAK.Age_donor.comb.Legend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.modScore3, reduction = "umap", pt.size = 2, 
    features = "IL6_JAK1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=8))) 
print(p1)
dev.off()
pas10 <- "YoshRef.Epithelial.IL6_JAK.Age_donor.comb.noLegend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p2 <- FeaturePlot(YoshRef.modScore3, reduction = "umap", pt.size = 2, 
    features = "IL6_JAK1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=0))) 
print(p2)
dev.off()
###majorAnnot
#YoshRef.modScore3.temp <-YoshRef.modScore3
ageCols = c("Neonate" = "blue4", "Infant" = "deepskyblue", "Young child" = "cyan",
    "Child" = "darkolivegreen1", "Adolescent" = "darkseagreen4", "Adult" = "forestgreen")
YoshRef.modScore3$Age_donor = factor(YoshRef.modScore3$Age_donor, c("Neonate", "Infant", 
"Young child", "Child", "Adolescent", "Adult"))
VPfname <- "YoshRef.Epithelial.IL6_JAK.Age_donor.VP.emf"
emf(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
vln1 <- VlnPlot(YoshRef.modScore3, features = "IL6_JAK1", 
   group.by = "Age_donor", cols = ageCols, pt.size = 2) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(vln1)
dev.off()
RPfname <- "YoshRef.Epithelial.IL6_JAK.Age_donor.RP.emf"
emf(file.path(outPath.Epithelial.Yoshida, RPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
rdg1 <- RidgePlot(YoshRef.modScore3, features = "IL6_JAK1", 
   group.by = "Age_donor", cols = ageCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(rdg1)
dev.off()
```

#### InterFeronAlpha1_Neonate
```{r InterFeronAlpha1_Neonate.Nasa.Nasal}
majorCols <- c("Basal" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
maxScore = max(c(YoshRef.Neonate.Nasal.modScore3@meta.data$InterFeronAlpha1, 
    YoshRef.Infant.Nasal.modScore3@meta.data$InterFeronAlpha1, 
    YoshRef.YC.Nasal.modScore3@meta.data$InterFeronAlpha1, 
    YoshRef.Child.Nasal.modScore3@meta.data$InterFeronAlpha1, 
    YoshRef.Adolescent.Nasal.modScore3@meta.data$InterFeronAlpha1,
    YoshRef.Adult.Nasal.modScore3@meta.data$InterFeronAlpha1)); 
minScore = min(c(YoshRef.Neonate.Nasal.modScore3@meta.data$InterFeronAlpha1, 
    YoshRef.Infant.Nasal.modScore3@meta.data$InterFeronAlpha1, 
    YoshRef.YC.Nasal.modScore3@meta.data$InterFeronAlpha1, 
    YoshRef.Child.Nasal.modScore3@meta.data$InterFeronAlpha1, 
    YoshRef.Adolescent.Nasal.modScore3@meta.data$InterFeronAlpha1,
    YoshRef.Adult.Nasal.modScore3@meta.data$InterFeronAlpha1))
# +   scale_color_distiller(palette = "RdYlBu") +
Idents(YoshRef.Neonate.Nasal.modScore3) <- "majorAnnot"
pas9 <- "YoshRef_Neonate.Nasal.InterFeronAlpha1.Legend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Neonate.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "InterFeronAlpha1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=8))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Neonate.Nasal.InterFeronAlpha1.noLegend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas10), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Neonate.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "InterFeronAlpha1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=0))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()


majorCols <- c("Basal" = "red", "Ciliated" = "purple", 
    "SecGob" = "olivedrab1", "RareCells" = "magenta")
YoshRef.modScore3$majorAnnot = factor(YoshRef.modScore3$majorAnnot, c("Basal", "SecGob", 
"Ciliated", "RareCells"))
VPfname <- "YoshRef.Neonate.Epithelial.InterFeronAlpha.VP.emf"
emf(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
vln1 <- VlnPlot(YoshRef.Neonate.Nasal.modScore3, features = "InterFeronAlpha1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(vln1)
dev.off()
RPfname <- "YoshRef.Neonate.Epithelial.InterFeronAlpha.RP.emf"
emf(file.path(outPath.Epithelial.Yoshida, RPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
rdg1 <- RidgePlot(YoshRef.Neonate.Nasal.modScore3, features = "InterFeronAlpha1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(rdg1)
dev.off()
```

#### InterFeronAlpha1_Infant
```{r InterFeronAlpha1_Infant.Nasa.Nasal}
majorCols <- c("Basal" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
Idents(YoshRef.Infant.Nasal.modScore3) <- "majorAnnot"
pas9 <- "YoshRef_Infant.Nasal.InterFeronAlpha1.Legend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Infant.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "InterFeronAlpha1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=8))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Infant.Nasal.InterFeronAlpha1.noLegend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas10), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Infant.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "InterFeronAlpha1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=0))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()


majorCols <- c("Basal" = "red", "Ciliated" = "purple", 
    "SecGob" = "olivedrab1", "RareCells" = "magenta")
YoshRef.modScore3$majorAnnot = factor(YoshRef.modScore3$majorAnnot, c("Basal", "SecGob", 
"Ciliated", "RareCells"))
VPfname <- "YoshRef.Infant.Epithelial.InterFeronAlpha.VP.emf"
emf(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
vln1 <- VlnPlot(YoshRef.Infant.Nasal.modScore3, features = "InterFeronAlpha1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(vln1)
dev.off()
RPfname <- "YoshRef.Infant.Epithelial.InterFeronAlpha.RP.emf"
emf(file.path(outPath.Epithelial.Yoshida, RPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
rdg1 <- RidgePlot(YoshRef.Infant.Nasal.modScore3, features = "InterFeronAlpha1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(rdg1)
dev.off()
```


#### InterFeronAlpha1_YC
```{r InterFeronAlpha1_YC.Nasa.Nasal}
majorCols <- c("Basal" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
Idents(YoshRef.YC.Nasal.modScore3) <- "majorAnnot"
pas9 <- "YoshRef_YC.Nasal.InterFeronAlpha1.Legend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.YC.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "InterFeronAlpha1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=8))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_YC.Nasal.InterFeronAlpha1.noLegend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas10), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.YC.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "InterFeronAlpha1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=0))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()


majorCols <- c("Basal" = "red", "Ciliated" = "purple", 
    "SecGob" = "olivedrab1", "RareCells" = "magenta")
YoshRef.modScore3$majorAnnot = factor(YoshRef.modScore3$majorAnnot, c("Basal", "SecGob", 
"Ciliated", "RareCells"))
VPfname <- "YoshRef.YC.Epithelial.InterFeronAlpha.VP.emf"
emf(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
vln1 <- VlnPlot(YoshRef.YC.Nasal.modScore3, features = "InterFeronAlpha1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(vln1)
dev.off()
RPfname <- "YoshRef.YC.Epithelial.InterFeronAlpha.RP.emf"
emf(file.path(outPath.Epithelial.Yoshida, RPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
rdg1 <- RidgePlot(YoshRef.YC.Nasal.modScore3, features = "InterFeronAlpha1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(rdg1)
dev.off()
```


#### InterFeronAlpha1_Child
```{r InterFeronAlpha1_Child.Nasa.Nasal}
majorCols <- c("Basal" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
Idents(YoshRef.Child.Nasal.modScore3) <- "majorAnnot"
pas9 <- "YoshRef_Child.Nasal.InterFeronAlpha1.Legend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Child.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "InterFeronAlpha1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=8))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Child.Nasal.InterFeronAlpha1.noLegend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas10), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Child.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "InterFeronAlpha1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=0))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()


majorCols <- c("Basal" = "red", "Ciliated" = "purple", 
    "SecGob" = "olivedrab1", "RareCells" = "magenta")
YoshRef.modScore3$majorAnnot = factor(YoshRef.modScore3$majorAnnot, c("Basal", "SecGob", 
"Ciliated", "RareCells"))
VPfname <- "YoshRef.Child.Epithelial.InterFeronAlpha.VP.emf"
emf(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
vln1 <- VlnPlot(YoshRef.Child.Nasal.modScore3, features = "InterFeronAlpha1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(vln1)
dev.off()
RPfname <- "YoshRef.Child.Epithelial.InterFeronAlpha.RP.emf"
emf(file.path(outPath.Epithelial.Yoshida, RPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
rdg1 <- RidgePlot(YoshRef.Child.Nasal.modScore3, features = "InterFeronAlpha1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(rdg1)
dev.off()
```

#### InterFeronAlpha1_Adolescent
```{r InterFeronAlpha1_Adolescent.Nasa.Nasal}
majorCols <- c("Basal" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
Idents(YoshRef.Adolescent.Nasal.modScore3) <- "majorAnnot"
pas9 <- "YoshRef_Adolescent.Nasal.InterFeronAlpha1.Legend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Adolescent.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "InterFeronAlpha1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=8))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Adolescent.Nasal.InterFeronAlpha1.noLegend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas10), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Adolescent.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "InterFeronAlpha1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=0))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()


majorCols <- c("Basal" = "red", "Ciliated" = "purple", 
    "SecGob" = "olivedrab1", "RareCells" = "magenta")
YoshRef.modScore3$majorAnnot = factor(YoshRef.modScore3$majorAnnot, c("Basal", "SecGob", 
"Ciliated", "RareCells"))
VPfname <- "YoshRef.Adolescent.Epithelial.InterFeronAlpha.VP.emf"
emf(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
vln1 <- VlnPlot(YoshRef.Adolescent.Nasal.modScore3, features = "InterFeronAlpha1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(vln1)
dev.off()
RPfname <- "YoshRef.Adolescent.Epithelial.InterFeronAlpha.RP.emf"
emf(file.path(outPath.Epithelial.Yoshida, RPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
rdg1 <- RidgePlot(YoshRef.Adolescent.Nasal.modScore3, features = "InterFeronAlpha1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(rdg1)
dev.off()
```

#### InterFeronAlpha1_Adult
```{r InterFeronAlpha1_Adult.Nasa.Nasal}
majorCols <- c("Basal" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
Idents(YoshRef.Adult.Nasal.modScore3) <- "majorAnnot"
pas9 <- "YoshRef_Adult.Nasal.InterFeronAlpha1.Legend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Adult.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "InterFeronAlpha1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=8))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Adult.Nasal.InterFeronAlpha1.noLegend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas10), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Adult.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "InterFeronAlpha1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=0))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()


majorCols <- c("Basal" = "red", "Ciliated" = "purple", 
    "SecGob" = "olivedrab1", "RareCells" = "magenta")
YoshRef.modScore3$majorAnnot = factor(YoshRef.modScore3$majorAnnot, c("Basal", "SecGob", 
"Ciliated", "RareCells"))
VPfname <- "YoshRef.Adult.Epithelial.InterFeronAlpha.VP.emf"
emf(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
vln1 <- VlnPlot(YoshRef.Adult.Nasal.modScore3, features = "InterFeronAlpha1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(vln1)
dev.off()
RPfname <- "YoshRef.Adult.Epithelial.InterFeronAlpha.RP.emf"
emf(file.path(outPath.Epithelial.Yoshida, RPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
rdg1 <- RidgePlot(YoshRef.Adult.Nasal.modScore3, features = "InterFeronAlpha1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(rdg1)
dev.off()
```



#### IL6_JAK11_Neonate
#### IL6_JAK_Neonate
```{r IL6_JAK1_Neonate.Nasa.Nasal}
majorCols <- c("Basal" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
maxScore = max(c(YoshRef.Neonate.Nasal.modScore3@meta.data$IL6_JAK1, 
    YoshRef.Infant.Nasal.modScore3@meta.data$IL6_JAK1, 
    YoshRef.YC.Nasal.modScore3@meta.data$IL6_JAK1, 
    YoshRef.Child.Nasal.modScore3@meta.data$IL6_JAK1, 
    YoshRef.Adolescent.Nasal.modScore3@meta.data$IL6_JAK1,
    YoshRef.Adult.Nasal.modScore3@meta.data$IL6_JAK1)); 
minScore = min(c(YoshRef.Neonate.Nasal.modScore3@meta.data$IL6_JAK1, 
    YoshRef.Infant.Nasal.modScore3@meta.data$IL6_JAK1, 
    YoshRef.YC.Nasal.modScore3@meta.data$IL6_JAK1, 
    YoshRef.Child.Nasal.modScore3@meta.data$IL6_JAK1, 
    YoshRef.Adolescent.Nasal.modScore3@meta.data$IL6_JAK1,
    YoshRef.Adult.Nasal.modScore3@meta.data$IL6_JAK1))
# +   scale_color_distiller(palette = "RdYlBu") +
Idents(YoshRef.Neonate.Nasal.modScore3) <- "majorAnnot"
pas9 <- "YoshRef_Neonate.Nasal.IL6_JAK1.Legend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Neonate.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "IL6_JAK1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=8))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Neonate.Nasal.IL6_JAK1.noLegend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas10), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Neonate.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "IL6_JAK1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=0))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()


majorCols <- c("Basal" = "red", "Ciliated" = "purple", 
    "SecGob" = "olivedrab1", "RareCells" = "magenta")
YoshRef.modScore3$majorAnnot = factor(YoshRef.modScore3$majorAnnot, c("Basal", "SecGob", 
"Ciliated", "RareCells"))
VPfname <- "YoshRef.Neonate.Epithelial.IL6_JAK.VP.emf"
emf(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
vln1 <- VlnPlot(YoshRef.Neonate.Nasal.modScore3, features = "IL6_JAK1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(vln1)
dev.off()
RPfname <- "YoshRef.Neonate.Epithelial.IL6_JAK.RP.emf"
emf(file.path(outPath.Epithelial.Yoshida, RPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
rdg1 <- RidgePlot(YoshRef.Neonate.Nasal.modScore3, features = "IL6_JAK1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(rdg1)
dev.off()
```

#### IL6_JAK1_Infant
```{r IL6_JAK1_Infant.Nasa.Nasal}
majorCols <- c("Basal" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
Idents(YoshRef.Infant.Nasal.modScore3) <- "majorAnnot"
pas9 <- "YoshRef_Infant.Nasal.IL6_JAK1.Legend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Infant.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "IL6_JAK1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=8))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Infant.Nasal.IL6_JAK1.noLegend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas10), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Infant.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "IL6_JAK1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=0))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()


majorCols <- c("Basal" = "red", "Ciliated" = "purple", 
    "SecGob" = "olivedrab1", "RareCells" = "magenta")
YoshRef.modScore3$majorAnnot = factor(YoshRef.modScore3$majorAnnot, c("Basal", "SecGob", 
"Ciliated", "RareCells"))
VPfname <- "YoshRef.Infant.Epithelial.IL6_JAK.VP.emf"
emf(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
vln1 <- VlnPlot(YoshRef.Infant.Nasal.modScore3, features = "IL6_JAK1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(vln1)
dev.off()
RPfname <- "YoshRef.Infant.Epithelial.IL6_JAK.RP.emf"
emf(file.path(outPath.Epithelial.Yoshida, RPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
rdg1 <- RidgePlot(YoshRef.Infant.Nasal.modScore3, features = "IL6_JAK1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(rdg1)
dev.off()
```


#### IL6_JAK1_YC
```{r IL6_JAK1_YC.Nasa.Nasal}
majorCols <- c("Basal" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
Idents(YoshRef.YC.Nasal.modScore3) <- "majorAnnot"
pas9 <- "YoshRef_YC.Nasal.IL6_JAK1.Legend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.YC.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "IL6_JAK1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=8))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_YC.Nasal.IL6_JAK1.noLegend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas10), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.YC.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "IL6_JAK1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=0))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()


majorCols <- c("Basal" = "red", "Ciliated" = "purple", 
    "SecGob" = "olivedrab1", "RareCells" = "magenta")
YoshRef.modScore3$majorAnnot = factor(YoshRef.modScore3$majorAnnot, c("Basal", "SecGob", 
"Ciliated", "RareCells"))
VPfname <- "YoshRef.YC.Epithelial.IL6_JAK.VP.emf"
emf(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
vln1 <- VlnPlot(YoshRef.YC.Nasal.modScore3, features = "IL6_JAK1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(vln1)
dev.off()
RPfname <- "YoshRef.YC.Epithelial.IL6_JAK.RP.emf"
emf(file.path(outPath.Epithelial.Yoshida, RPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
rdg1 <- RidgePlot(YoshRef.YC.Nasal.modScore3, features = "IL6_JAK1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(rdg1)
dev.off()
```


#### IL6_JAK1_Child
```{r IL6_JAK1_Child.Nasa.Nasal}
majorCols <- c("Basal" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
Idents(YoshRef.Child.Nasal.modScore3) <- "majorAnnot"
pas9 <- "YoshRef_Child.Nasal.IL6_JAK1.Legend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Child.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "IL6_JAK1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=8))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Child.Nasal.IL6_JAK1.noLegend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas10), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Child.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "IL6_JAK1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=0))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()


majorCols <- c("Basal" = "red", "Ciliated" = "purple", 
    "SecGob" = "olivedrab1", "RareCells" = "magenta")
YoshRef.modScore3$majorAnnot = factor(YoshRef.modScore3$majorAnnot, c("Basal", "SecGob", 
"Ciliated", "RareCells"))
VPfname <- "YoshRef.Child.Epithelial.IL6_JAK.VP.emf"
emf(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
vln1 <- VlnPlot(YoshRef.Child.Nasal.modScore3, features = "IL6_JAK1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(vln1)
dev.off()
RPfname <- "YoshRef.Child.Epithelial.IL6_JAK.RP.emf"
emf(file.path(outPath.Epithelial.Yoshida, RPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
rdg1 <- RidgePlot(YoshRef.Child.Nasal.modScore3, features = "IL6_JAK1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(rdg1)
dev.off()
```

#### IL6_JAK1_Adolescent
```{r IL6_JAK1_Adolescent.Nasa.Nasal}
majorCols <- c("Basal" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
Idents(YoshRef.Adolescent.Nasal.modScore3) <- "majorAnnot"
pas9 <- "YoshRef_Adolescent.Nasal.IL6_JAK1.Legend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Adolescent.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "IL6_JAK1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=8))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Adolescent.Nasal.IL6_JAK1.noLegend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas10), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Adolescent.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "IL6_JAK1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=0))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()


majorCols <- c("Basal" = "red", "Ciliated" = "purple", 
    "SecGob" = "olivedrab1", "RareCells" = "magenta")
YoshRef.modScore3$majorAnnot = factor(YoshRef.modScore3$majorAnnot, c("Basal", "SecGob", 
"Ciliated", "RareCells"))
VPfname <- "YoshRef.Adolescent.Epithelial.IL6_JAK.VP.emf"
emf(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
vln1 <- VlnPlot(YoshRef.Adolescent.Nasal.modScore3, features = "IL6_JAK1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(vln1)
dev.off()
RPfname <- "YoshRef.Adolescent.Epithelial.IL6_JAK.RP.emf"
emf(file.path(outPath.Epithelial.Yoshida, RPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
rdg1 <- RidgePlot(YoshRef.Adolescent.Nasal.modScore3, features = "IL6_JAK1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(rdg1)
dev.off()
```

#### IL6_JAK1_Adult
```{r IL6_JAK1_Adult.Nasa.Nasal}
majorCols <- c("Basal" = "red", "Ciliated" = "purple", "Ciliated" = "olivedrab1", "RareCellss" = "magenta")
Idents(YoshRef.Adult.Nasal.modScore3) <- "majorAnnot"
pas9 <- "YoshRef_Adult.Nasal.IL6_JAK1.Legend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas9), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Adult.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "IL6_JAK1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=8))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()
pas10 <- "YoshRef_Adult.Nasal.IL6_JAK1.noLegend.emf"
emf(file.path(outPath.Epithelial.Yoshida, pas10), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
p1 <- FeaturePlot(YoshRef.Adult.Nasal.modScore3, reduction = "umap", pt.size = 1.5, 
    features = "IL6_JAK1", order = TRUE, label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", size = 20), 
    axis.text  = element_text(face="bold", size = 15), 
    legend.text  = element_text(face="bold", size = 15)) +
    guides(color = guide_legend(override.aes = list(size=0))) + 
    scale_colour_gradientn(colors = turbo(n = 5, direction = -1), 
    limits = c(minScore, maxScore), breaks = seq(from=minScore, to=maxScore, by = 0.2))
print(p1)
dev.off()


majorCols <- c("Basal" = "red", "Ciliated" = "purple", 
    "SecGob" = "olivedrab1", "RareCells" = "magenta")
YoshRef.modScore3$majorAnnot = factor(YoshRef.modScore3$majorAnnot, c("Basal", "SecGob", 
"Ciliated", "RareCells"))
VPfname <- "YoshRef.Adult.Epithelial.IL6_JAK.VP.emf"
emf(file.path(outPath.Epithelial.Yoshida, VPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
vln1 <- VlnPlot(YoshRef.Adult.Nasal.modScore3, features = "IL6_JAK1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(vln1)
dev.off()
RPfname <- "YoshRef.Adult.Epithelial.IL6_JAK.RP.emf"
emf(file.path(outPath.Epithelial.Yoshida, RPfname), width = 12, height = 8, 
    units = "in", pointsize = 12, family = "Helvetica", coordDPI = 600, 
    emfPlus=TRUE)
rdg1 <- RidgePlot(YoshRef.Adult.Nasal.modScore3, features = "IL6_JAK1", 
   group.by = "majorAnnot", cols = majorCols) + 
   theme(axis.title = element_text(face="bold", size = 40), 
   axis.text.y  = element_text(face="bold", size = 35), 
   axis.text.x  = element_text(face="bold", size = 35), 
   legend.text  = element_text(face="bold", size = 25))
print(rdg1)
dev.off()
```
#### Bronchi
### Annotated Immune Cells- by Age_bin: Infant _ Figure 1e
```{r}

plot_woImmune_cell <- DimPlot(YoshRef.modScore3, group.by = "majorAnnot", raster = FALSE) + 
    ggtitle("Nasal Epithelium")

# Get unique woImmune cell types

majorCols <- c("Basal" = "red", 
    "SecGob" = "purple", 
    "Ciliated" = "olivedrab1", 
    "RareCells" = "magenta")

# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use custom_colors here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 14),   # Enlarge legend text
    legend.title = element_text(size = 16)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Infant.Nose.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
# Apply the custom colors to the plot
plot_woImmune_cell <- plot_woImmune_cell + 
  scale_color_manual(values = majorCols) +  # use custom_colors here
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 20, face = "bold"),
    legend.text = element_text(size = 0),   # Enlarge legend text
    legend.title = element_text(size = 0)   # Enlarge legend title
  )

# Print the plot
print(plot_woImmune_cell)

# Save the plot
output_file_woImmune_cell <- file.path(outPath.BCells.woImmune.Yoshida, "DimPlot_woImmune_Cell.Infant.noLegend.Bronchi.png")
ggsave(filename = output_file_woImmune_cell, plot = plot_woImmune_cell, width = 6, height = 4, dpi = 600)
```

```{r MakingDotPlots.Nasal}
inPath <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida"
outPath = inPath
outPath.Epithelial.Yoshida <- file.path(outPath, "YoshRef.control.norm.leiden", "YoshRef.control.norm.leiden.AllSamples")
dir.create(file.path(outPath.Epithelial.Yoshida))
YoshRef.NasalEpithelium <- readRDS(file.path(outPath.Epithelial.Yoshida, "YoshRef.NasalEpithelium.res1.rds"))
SeuratObj = YoshRef.NasalEpithelium
Idents(SeuratObj) <- "majorAnnot"; DefaultAssay(SeuratObj) <- "RNA"
SeuratObj@active.ident <- factor(SeuratObj@active.ident, levels = c("Neonate",
    "Infant", 
    "Young child", 
    "Child",
    "Adolescent")
png(file.path(outPath.Epithelial.Yoshida, "SecGobRepressor.Nasal.DP.majorAnnot.png"), width = 20, height = 18, units = "in", res = 600)
#YoshidaMarkers <- c(mitoticBasal1, mitoticBasal2)
seGobRepress <- c("NKX2-1", "FOXA2", "SPDEF", "FOXA3", "MUC5AC")
#DP <- DotPlot(SeuratObj, features = YoshidaMarkers, cols = c("blue", "red"), dot.scale = 8) + RotatedAxis()
DP <- DotPlot(SeuratObj, features = seGobRepress, cols = c("blue", "red"), dot.scale = 25, scale = FALSE) + RotatedAxis()  + theme(axis.title = element_text(face="bold", family = "sans", size = 40), axis.text  = element_text(face="bold", family = "sans", size = 40))
print(DP)
dev.off()

Idents(SeuratObj) <- "Age_donor"; DefaultAssay(SeuratObj) <- "RNA"
SeuratObj@active.ident <- factor(SeuratObj@active.ident, levels = c("Neonate",
    "Infant", 
    "Young child", 
    "Child",
    "Adolescent",
    "Adult"))
png(file.path(outPath.Epithelial.Yoshida, "SecGobRepressor.Nasal.DP.Age_donor.png"), width = 20, height = 18, units = "in", res = 600)
#YoshidaMarkers <- c(mitoticBasal1, mitoticBasal2)
seGobRepress <- c("NKX2-1", "FOXA2", "SPDEF", "FOXA3", "MUC5AC")
#DP <- DotPlot(SeuratObj, features = YoshidaMarkers, cols = c("blue", "red"), dot.scale = 8) + RotatedAxis()
DP <- DotPlot(SeuratObj, features = seGobRepress, cols = c("blue", "red"), dot.scale = 25, scale = FALSE) + RotatedAxis()  + theme(axis.title = element_text(face="bold", family = "sans", size = 40), axis.text  = element_text(face="bold", family = "sans", size = 40))
print(DP)
dev.off()
```


```{r MakingDotPlots.Bronchial}
inPath <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida"
outPath = inPath
outPath.Epithelial.Yoshida <- file.path(outPath, "YoshRef.control.norm.leiden", "YoshRef.control.norm.leiden.AllSamples")
dir.create(file.path(outPath.Epithelial.Yoshida))
YoshRef.NasalEpithelium <- readRDS(file.path(outPath.Epithelial.Yoshida, "YoshRef.Nasal_Bronchial.Epithelium.res1.rds"))
YoshRef.BronchialEpithelium <- subset(YoshRef.NasalEpithelium, subset = Samp.loc == "Bronchial")
SeuratObj = YoshRef.BronchialEpithelium

Idents(SeuratObj) <- "majorAnnot"; DefaultAssay(SeuratObj) <- "RNA"
png(file.path(outPath.Epithelial.Yoshida, "SecGobRepressor.Bronchial.DP.majorAnnot.png"), width = 20, height = 18, units = "in", res = 600)
#YoshidaMarkers <- c(mitoticBasal1, mitoticBasal2)
seGobRepress <- c("NKX2-1", "FOXA2", "SPDEF", "FOXA3", "MUC5AC")
#DP <- DotPlot(SeuratObj, features = YoshidaMarkers, cols = c("blue", "red"), dot.scale = 8) + RotatedAxis()
DP <- DotPlot(SeuratObj, features = seGobRepress, cols = c("blue", "red"), dot.scale = 25, scale = FALSE) + RotatedAxis()  + theme(axis.title = element_text(face="bold", family = "sans", size = 40), axis.text  = element_text(face="bold", family = "sans", size = 40))
print(DP)
dev.off()

Idents(SeuratObj) <- "Age_donor"; DefaultAssay(SeuratObj) <- "RNA"
png(file.path(outPath.Epithelial.Yoshida, "SecGobRepressor.Bronchial.DP.Age_donor.png"), width = 20, height = 18, units = "in", res = 600)
#YoshidaMarkers <- c(mitoticBasal1, mitoticBasal2)
seGobRepress <- c("NKX2-1", "FOXA2", "SPDEF", "FOXA3", "MUC5AC")
SeuratObj@active.ident <- factor(SeuratObj@active.ident, levels = c("Neonate",
    "Infant", 
    "Young child", 
    "Child",
    "Adolescent"))
#DP <- DotPlot(SeuratObj, features = YoshidaMarkers, cols = c("blue", "red"), dot.scale = 8) + RotatedAxis()
DP <- DotPlot(SeuratObj, features = seGobRepress, cols = c("blue", "red"), dot.scale = 25, scale = FALSE) + RotatedAxis()  + theme(axis.title = element_text(face="bold", family = "sans", size = 40), axis.text  = element_text(face="bold", family = "sans", size = 40))
print(DP)
dev.off()
```
```{r MakingDotPlots.Bronchial}
YoshRef.Nasal_Bronchial.Epithelium <- readRDS(file.path(outPath.Epithelial.Yoshida, 
    "YoshRef.Nasal_Bronchial.Epithelium.res1.rds"))
YoshRef.Nasal_Bronchial.Epithelium.Basal <- subset(YoshRef.Nasal_Bronchial.Epithelium,
    majorAnnot == "Basal")
YoshRef.Nasal_Bronchial.Epithelium.Basal@meta.data$minorAnnot <- gsub(
    "CyclingHillock", "MitoticBasal", 
    YoshRef.Nasal_Bronchial.Epithelium.Basal@meta.data$minorAnnot
)
Idents(YoshRef.Nasal_Bronchial.Epithelium.Basal) <- "minorAnnot"; 
DefaultAssay(YoshRef.Nasal_Bronchial.Epithelium.Basal) <- "RNA"
IL6_JAK_STAT3 <- c("A2M", "ACVR1B", "ACVRL1", "BAK1", "CBL", "CCL7", "CCR1", "CD14", "CD36", "CD38", "CD44", "CD9", "CNTFR", "CRLF2", "CSF1", "CSF2", "CSF2RA", "CSF2RB", "CSF3R", "CXCL1", "CXCL10", "CXCL11", "CXCL13", "CXCL3", "CXCL9", "DNTT", "EBI3", "FAS", "GRB2", "HAX1", "HMOX1", "IFNAR1", "IFNGR1", "IFNGR2", "IL10RB", "IL12RB1", "IL13RA1", "IL15RA", "IL17RA", "IL17RB", "IL18R1", "IL1B", "IL1R1", "IL1R2", "IL2RA", "IL2RG", "IL3RA", "IL4R", "IL6", "IL6ST", "IL7", "IL9R", "INHBE", "IRF1", "IRF9", "ITGA4", "ITGB3", "JUN", "LEPR", "LTB", "LTBR", "MAP3K8", "MYD88", "OSMR", "PDGFC", "PF4", "PIK3R5", "PIM1", "PLA2G2A", "PTPN1", "PTPN11", "PTPN2", "REG1A", "SOCS1", "SOCS3", "STAM2", "STAT1", "STAT2", "STAT3", "TGFB1", "TLR2", "TNF", "TNFRSF12A", "TNFRSF1A", "TNFRSF1B", "TNFRSF21", "TYK2")
#IL6_JAK_STAT3 <-  IL6_JAK_STAT3[!(IL6_JAK_STAT3 %in% c("A2M", "ACVRL1", "CCL7", "CCR1", "CNTFR", "CRLF2", "CSF2", "CSF2RB", "CSF3R", "CXCL13", "CXCL9", "DNTT", "EBI3", "IL12RB1", "IL2RA", "IL6", "IL9R", "INHBE", "LTB", "PF4", "PIK3R5", "PLA2G2A", "TNFRSF1B"))]
IL6_JAK_STAT3 <- list(IL6_JAK_STAT3)
InterFeronAlpha <- c("ADAR", "B2M", "BATF2", "BST2", "C1S", "CASP1", "CASP8", "CCRL2", "CD47", "CD74", "CMPK2", "CMTR1", "CNP", "CSF1", "CXCL10", "CXCL11", "DDX60", "DHX58", "EIF2AK2", "ELF1", "EPSTI1", "GBP2", "GBP4", "GMPR", "HELZ2", "HERC6", "HLA-C", "IFI27", "IFI30", "IFI35", "IFI44", "IFI44L", "IFIH1", "IFIT2", "IFIT3", "IFITM1", "IFITM2", "IFITM3", "IL15", "IL4R", "IL7", "IRF1", "IRF2", "IRF7", "IRF9", "ISG15", "ISG20", "LAMP3", "LAP3", "LGALS3BP", "LPAR6", "LY6E", "MOV10", "MVB12A", "MX1", "NCOA7", "NMI", "NUB1", "OAS1", "OASL", "OGFR", "PARP12", "PARP14", "PARP9", "PLSCR1", "PNPT1", "PROCR", "PSMA3", "PSMB8", "PSMB9", "PSME1", "PSME2", "RIPK2", "RNF31", "RSAD2", "RTP4", "SAMD9", "SAMD9L", "SELL", "SLC25A28", "SP110", "STAT2", "TAP1", "TDRD7", "TENT5A", "TMEM140", "TRAFD1", "TRIM14", "TRIM21", "TRIM25", "TRIM26", "TRIM5", "TXNIP", "UBA7", "UBE2L6", "USP18", "WARS1")
InterFeronAlpha <-  InterFeronAlpha[!InterFeronAlpha %in% c("WARS1")]
InterFeronAlpha <- list(InterFeronAlpha)

'adultBaby_Nasal_Bronchia.modScore3@meta.data$minorAnnot <- ifelse(
    adultBaby_Nasal_Bronchia.modScore3@meta.data$minorAnnot == "B'
###Nasal
adultBaby_Nasal_Bronchia.modScore3 <- AddModuleScore(YoshRef.Nasal_Bronchial.Epithelium.Basal, 
    features = IL6_JAK_STAT3, 
    assay = "RNA", 
    name = "IL6_JAK")
adultBaby_Nasal_Bronchia.modScore3 <- AddModuleScore(adultBaby_Nasal_Bronchia.modScore3,
    features = InterFeronAlpha, 
    assay = "RNA", 
    name = "InterFeronAlpha")
saveRDS(adultBaby_Nasal_Bronchia.modScore3,
    file.path(outPath.Epithelial.Yoshida, 
    "YoshRef.Nasal_Bronchial.Epithelium.res1.rds"))
```

```{r InterFeronAlpha_Basal1}
adultBaby_Nasal_Bronchia.modScore3@meta.data$sampleLoc_ageDonor = paste(
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Samp.loc, "_",
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Age_donor,
    sep = "")
###Neonate Basal1
YoshRef.InterFeronAlpha.Neonate.Nasal_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlpha.Neonate.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate"))
YoshRef.InterFeronAlphaPos.Neonate.Nasal_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlphaNeg.Neonate.Nasal_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal1"))
###Bronchial
YoshRef.InterFeronAlpha.Neonate.Nasal_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlpha.Neonate.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate"))

YoshRef.InterFeronAlphaPos.Neonate.Bronchial_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlphaNeg.Neonate.Bronchial_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal1"))
###Infant Basal1
##Nasal
YoshRef.InterFeronAlpha.Infant.Nasal_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
      minorAnnot == "Basal1"))
YoshRef.InterFeronAlpha.Infant.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant"))
YoshRef.InterFeronAlphaPos.Infant.Nasal_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlphaNeg.Infant.Nasal_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal1"))
###Bronchial
YoshRef.InterFeronAlpha.Infant.Bronchial_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
     minorAnnot == "Basal1"))
YoshRef.InterFeronAlpha.Infant.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant"))

YoshRef.InterFeronAlphaPos.Infant.Bronchial_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlphaNeg.Infant.Bronchial_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal1"))
###YC Basal1
###Nasal
YoshRef.InterFeronAlpha.YC.Nasal_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlpha.YC.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child"))
YoshRef.InterFeronAlphaPos.YC.Nasal_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlphaNeg.YC.Nasal_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal1"))
###Bronchial
YoshRef.InterFeronAlpha.YC.Bronchial_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlpha.YC.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child"))
YoshRef.InterFeronAlphaPos.YC.Bronchial_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlphaNeg.YC.Bronchial_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal1"))
###Child Basal1
###Nasal
YoshRef.InterFeronAlpha.Child.Nasal_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlpha.Child.Nasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child"))
YoshRef.InterFeronAlphaPos.Child.Nasal_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlphaNeg.Child.Nasal_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal1"))
###Bronchial
YoshRef.InterFeronAlpha.Child.Bronchial_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlpha.Child.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child"))
YoshRef.InterFeronAlphaPos.Child.Bronchial_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlphaNeg.Child.Bronchial_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal1"))

###Adolescent Basal1
###Nasal
YoshRef.InterFeronAlpha.Adolescent.Nasal_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlpha.Adolescent.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent"))
YoshRef.InterFeronAlphaPos.Adolescent.Nasal_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlphaNeg.Adolescent.Nasal_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal1"))
###Bronchial
YoshRef.InterFeronAlpha.Adolescent.Bronchial_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlpha.Adolescent.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent"))
YoshRef.InterFeronAlphaPos.Adolescent.Bronchial_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.InterFeronAlphaNeg.Adolescent.Bronchial_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal1"))

```


```{r InterFeronAlpha_Basal2}
adultBaby_Nasal_Bronchia.modScore3@meta.data$sampleLoc_ageDonor = paste(
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Samp.loc, "_",
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Age_donor,
    sep = "")
###Neonate Basal2
###Nasal
YoshRef.InterFeronAlpha.Neonate.Nasal_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlpha.Neonate.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate"))
YoshRef.InterFeronAlphaPos.Neonate.Nasal_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlphaNeg.Neonate.Nasal_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal2"))
###Bronchial
YoshRef.InterFeronAlpha.Neonate.Bronchial_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlpha.Neonate.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate"))

YoshRef.InterFeronAlphaPos.Neonate.Bronchial_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlphaNeg.Neonate.Bronchial_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal2"))
###Infant Basal2
##Nasal
YoshRef.InterFeronAlpha.Infant.Nasal_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
      minorAnnot == "Basal2"))
YoshRef.InterFeronAlpha.Infant.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant"))
YoshRef.InterFeronAlphaPos.Infant.Nasal_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlphaNeg.Infant.Nasal_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal2"))
###Bronchial
YoshRef.InterFeronAlpha.Infant.Bronchial_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
     minorAnnot == "Basal2"))
YoshRef.InterFeronAlpha.Infant.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant"))

YoshRef.InterFeronAlphaPos.Infant.Bronchial_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlphaNeg.Infant.Bronchial_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal2"))
###YC Basal2
###Nasal
YoshRef.InterFeronAlpha.YC.Nasal_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlpha.YC.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child"))
YoshRef.InterFeronAlphaPos.YC.Nasal_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlphaNeg.YC.Nasal_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal2"))
###Bronchial
YoshRef.InterFeronAlpha.YC.Bronchial_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlpha.YC.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child"))
YoshRef.InterFeronAlphaPos.YC.Bronchial_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlphaNeg.YC.Bronchial_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal2"))
###Child Basal2
###Nasal
YoshRef.InterFeronAlpha.Child.Nasal_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlpha.Child.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child"))
YoshRef.InterFeronAlphaPos.Child.Nasal_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlphaNeg.Child.Nasal_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal2"))
###Bronchial
YoshRef.InterFeronAlpha.Child.Bronchial_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlpha.Child.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child"))
YoshRef.InterFeronAlphaPos.Child.Bronchial_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlphaNeg.Child.Bronchial_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal2"))

###Adolescent Basal2
###Nasal
YoshRef.InterFeronAlpha.Adolescent.Nasal_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlpha.Adolescent.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent"))
YoshRef.InterFeronAlphaPos.Adolescent.Nasal_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlphaNeg.Adolescent.Nasal_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal2"))
###Bronchial
YoshRef.InterFeronAlpha.Adolescent.Bronchial_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlpha.Adolescent.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent"))
YoshRef.InterFeronAlphaPos.Adolescent.Bronchial_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.InterFeronAlphaNeg.Adolescent.Bronchial_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Basal2"))

```



```{r InterFeronAlpha_Hillock}
adultBaby_Nasal_Bronchia.modScore3@meta.data$sampleLoc_ageDonor = paste(
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Samp.loc, "_",
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Age_donor,
    sep = "")
###Neonate Hillock
###Nasal
YoshRef.InterFeronAlpha.Neonate.Nasal_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlpha.Neonate.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate"))
YoshRef.InterFeronAlphaPos.Neonate.Nasal_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlphaNeg.Neonate.Nasal_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Hillock"))
###Bronchial
YoshRef.InterFeronAlpha.Neonate.Bronchial_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlpha.Neonate.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate"))

YoshRef.InterFeronAlphaPos.Neonate.Bronchial_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlphaNeg.Neonate.Bronchial_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Hillock"))
###Infant Hillock
##Nasal
YoshRef.InterFeronAlpha.Infant.Nasal_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
      minorAnnot == "Hillock"))
YoshRef.InterFeronAlpha.Infant.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant"))
YoshRef.InterFeronAlphaPos.Infant.Nasal_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlphaNeg.Infant.Nasal_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Hillock"))
###Bronchial
YoshRef.InterFeronAlpha.Infant.Bronchial_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
     minorAnnot == "Hillock"))
YoshRef.InterFeronAlpha.Infant.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant"))

YoshRef.InterFeronAlphaPos.Infant.Bronchial_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlphaNeg.Infant.Bronchial_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Hillock"))
###YC Hillock
###Nasal
YoshRef.InterFeronAlpha.YC.Nasal_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlpha.YC.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child"))
YoshRef.InterFeronAlphaPos.YC.Nasal_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlphaNeg.YC.Nasal_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Hillock"))
###Bronchial
YoshRef.InterFeronAlpha.YC.Bronchial_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlpha.YC.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child"))
YoshRef.InterFeronAlphaPos.YC.Bronchial_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlphaNeg.YC.Bronchial_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Hillock"))
###Child Hillock
###Nasal
YoshRef.InterFeronAlpha.Child.Nasal_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlpha.Child.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child"))
YoshRef.InterFeronAlphaPos.Child.Nasal_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlphaNeg.Child.Nasal_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Hillock"))
###Bronchial
YoshRef.InterFeronAlpha.Child.Bronchial_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlpha.Child.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child"))
YoshRef.InterFeronAlphaPos.Child.Bronchial_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlphaNeg.Child.Bronchial_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Hillock"))

###Adolescent Hillock
###Nasal
YoshRef.InterFeronAlpha.Adolescent.Nasal_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlpha.Adolescent.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent"))
YoshRef.InterFeronAlphaPos.Adolescent.Nasal_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlphaNeg.Adolescent.Nasal_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Hillock"))
###Bronchial
YoshRef.InterFeronAlpha.Adolescent.Bronchial_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlpha.Adolescent.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent"))
YoshRef.InterFeronAlphaPos.Adolescent.Bronchial_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.InterFeronAlphaNeg.Adolescent.Bronchial_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "Hillock"))

```

```{r InterFeronAlpha_MitoticBasal}
adultBaby_Nasal_Bronchia.modScore3@meta.data$sampleLoc_ageDonor = paste(
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Samp.loc, "_",
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Age_donor,
    sep = "")
###Neonate MitoticBasal
###Nasal
YoshRef.InterFeronAlpha.Neonate.Nasal_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlpha.Neonate.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate"))
YoshRef.InterFeronAlphaPos.Neonate.Nasal_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlphaNeg.Neonate.Nasal_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "MitoticBasal"))
###Bronchial
YoshRef.InterFeronAlpha.Neonate.Bronchial_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlpha.Neonate.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate"))

YoshRef.InterFeronAlphaPos.Neonate.Bronchial_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlphaNeg.Neonate.Bronchial_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "MitoticBasal"))
###Infant MitoticBasal
##Nasal
YoshRef.InterFeronAlpha.Infant.Nasal_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
      minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlpha.Infant.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant"))
YoshRef.InterFeronAlphaPos.Infant.Nasal_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlphaNeg.Infant.Nasal_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "MitoticBasal"))
###Bronchial
YoshRef.InterFeronAlpha.Infant.Bronchial_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
     minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlpha.Infant.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant"))

YoshRef.InterFeronAlphaPos.Infant.Bronchial_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlphaNeg.Infant.Bronchial_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "MitoticBasal"))
###YC MitoticBasal
###Nasal
YoshRef.InterFeronAlpha.YC.Nasal_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlpha.YC.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child"))
YoshRef.InterFeronAlphaPos.YC.Nasal_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlphaNeg.YC.Nasal_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "MitoticBasal"))
###Bronchial
YoshRef.InterFeronAlpha.YC.Bronchial_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlpha.YC.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child"))
YoshRef.InterFeronAlphaPos.YC.Bronchial_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlphaNeg.YC.Bronchial_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "MitoticBasal"))
###Child MitoticBasal
###Nasal
YoshRef.InterFeronAlpha.Child.Nasal_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlpha.Child.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child"))
YoshRef.InterFeronAlphaPos.Child.Nasal_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlphaNeg.Child.Nasal_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "MitoticBasal"))
###Bronchial
YoshRef.InterFeronAlpha.Child.Bronchial_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlpha.Child.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child"))
YoshRef.InterFeronAlphaPos.Child.Bronchial_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlphaNeg.Child.Bronchial_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "MitoticBasal"))

###Adolescent MitoticBasal
###Nasal
YoshRef.InterFeronAlpha.Adolescent.Nasal_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlpha.Adolescent.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent"))
YoshRef.InterFeronAlphaPos.Adolescent.Nasal_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlphaNeg.Adolescent.Nasal_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "MitoticBasal"))
###Bronchial
YoshRef.InterFeronAlpha.Adolescent.Bronchial_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlpha.Adolescent.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent"))
YoshRef.InterFeronAlphaPos.Adolescent.Bronchial_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    InterFeronAlpha1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.InterFeronAlphaNeg.Adolescent.Bronchial_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    InterFeronAlpha1 <= 0 &
    minorAnnot == "MitoticBasal"))

```

### IL6_JAK1
### Basal1 
```{r IL6_JAK1_Basal1}
adultBaby_Nasal_Bronchia.modScore3@meta.data$sampleLoc_ageDonor = paste(
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Samp.loc, "_",
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Age_donor,
    sep = "")
###Neonate Basal1
YoshRef.IL6_JAK1.Neonate.Nasal_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1.Neonate.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate"))
YoshRef.IL6_JAK1Pos.Neonate.Nasal_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1Neg.Neonate.Nasal_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal1"))
###Bronchial
YoshRef.IL6_JAK1.Neonate.Nasal_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1.Neonate.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate"))

YoshRef.IL6_JAK1Pos.Neonate.Bronchial_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1Neg.Neonate.Bronchial_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal1"))
###Infant Basal1
##Nasal
YoshRef.IL6_JAK1.Infant.Nasal_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
      minorAnnot == "Basal1"))
YoshRef.IL6_JAK1.Infant.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant"))
YoshRef.IL6_JAK1Pos.Infant.Nasal_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1Neg.Infant.Nasal_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal1"))
###Bronchial
YoshRef.IL6_JAK1.Infant.Bronchial_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
     minorAnnot == "Basal1"))
YoshRef.IL6_JAK1.Infant.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant"))
YoshRef.IL6_JAK1Pos.Infant.Bronchial_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1Neg.Infant.Bronchial_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal1"))
###YC Basal1
###Nasal
YoshRef.IL6_JAK1.YC.Nasal_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1.YC.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child"))
YoshRef.IL6_JAK1Pos.YC.Nasal_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1Neg.YC.Nasal_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal1"))
###Bronchial
YoshRef.IL6_JAK1.YC.Bronchial_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1.YC.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child"))
YoshRef.IL6_JAK1Pos.YC.Bronchial_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1Neg.YC.Bronchial_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal1"))
###Child Basal1
###Nasal
YoshRef.IL6_JAK1.Child.Nasal_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1.Child.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child"))
YoshRef.IL6_JAK1Pos.Child.Nasal_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1Neg.Child.Nasal_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal1"))
###Bronchial
YoshRef.IL6_JAK1.Child.Bronchial_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1.Child.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child"))
YoshRef.IL6_JAK1Pos.Child.Bronchial_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1Neg.Child.Bronchial_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal1"))

###Adolescent Basal1
###Nasal
YoshRef.IL6_JAK1.Adolescent.Nasal_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1.Adolescent.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent"))
YoshRef.IL6_JAK1Pos.Adolescent.Nasal_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1Neg.Adolescent.Nasal_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal1"))
###Bronchial
YoshRef.IL6_JAK1.Adolescent.Bronchial_Basal1_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1.Adolescent.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent"))
YoshRef.IL6_JAK1Pos.Adolescent.Bronchial_Basal1 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal1"))
YoshRef.IL6_JAK1Neg.Adolescent.Bronchial_Basal1 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal1"))

```


```{r IL6_JAK1_Basal2}
adultBaby_Nasal_Bronchia.modScore3@meta.data$sampleLoc_ageDonor = paste(
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Samp.loc, "_",
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Age_donor,
    sep = "")
###Neonate Basal2
###Nasal
YoshRef.IL6_JAK1.Neonate.Nasal_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1.Neonate.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate"))
YoshRef.IL6_JAK1Pos.Neonate.Nasal_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1Neg.Neonate.Nasal_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal2"))
###Bronchial
YoshRef.IL6_JAK1.Neonate.Bronchial_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1.Neonate.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate"))

YoshRef.IL6_JAK1Pos.Neonate.Bronchial_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1Neg.Neonate.Bronchial_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal2"))
###Infant Basal2
##Nasal
YoshRef.IL6_JAK1.Infant.Nasal_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
      minorAnnot == "Basal2"))
YoshRef.IL6_JAK1.Infant.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant"))
YoshRef.IL6_JAK1Pos.Infant.Nasal_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1Neg.Infant.Nasal_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal2"))
###Bronchial
YoshRef.IL6_JAK1.Infant.Bronchial_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
     minorAnnot == "Basal2"))
YoshRef.IL6_JAK1.Infant.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant"))

YoshRef.IL6_JAK1Pos.Infant.Bronchial_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1Neg.Infant.Bronchial_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal2"))
###YC Basal2
###Nasal
YoshRef.IL6_JAK1.YC.Nasal_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1.YC.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child"))
YoshRef.IL6_JAK1Pos.YC.Nasal_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1Neg.YC.Nasal_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal2"))
###Bronchial
YoshRef.IL6_JAK1.YC.Bronchial_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1.YC.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child"))
YoshRef.IL6_JAK1Pos.YC.Bronchial_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1Neg.YC.Bronchial_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal2"))
###Child Basal2
###Nasal
YoshRef.IL6_JAK1.Child.Nasal_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1.Child.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child"))
YoshRef.IL6_JAK1Pos.Child.Nasal_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1Neg.Child.Nasal_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal2"))
###Bronchial
YoshRef.IL6_JAK1.Child.Bronchial_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1.Child.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child"))
YoshRef.IL6_JAK1Pos.Child.Bronchial_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1Neg.Child.Bronchial_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal2"))

###Adolescent Basal2
###Nasal
YoshRef.IL6_JAK1.Adolescent.Nasal_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1.Adolescent.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent"))
YoshRef.IL6_JAK1Pos.Adolescent.Nasal_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1Neg.Adolescent.Nasal_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal2"))
###Bronchial
YoshRef.IL6_JAK1.Adolescent.Bronchial_Basal2_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1.Adolescent.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent"))
YoshRef.IL6_JAK1Pos.Adolescent.Bronchial_Basal2 <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    IL6_JAK1 > 0 &
    minorAnnot == "Basal2"))
YoshRef.IL6_JAK1Neg.Adolescent.Bronchial_Basal2 = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Basal2"))

```



```{r IL6_JAK1_Hillock}
adultBaby_Nasal_Bronchia.modScore3@meta.data$sampleLoc_ageDonor = paste(
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Samp.loc, "_",
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Age_donor,
    sep = "")
###Neonate Hillock
###Nasal
YoshRef.IL6_JAK1.Neonate.Nasal_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1.Neonate.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate"))
YoshRef.IL6_JAK1Pos.Neonate.Nasal_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    IL6_JAK1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1Neg.Neonate.Nasal_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Hillock"))
###Bronchial
YoshRef.IL6_JAK1.Neonate.Bronchial_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1.Neonate.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate"))

YoshRef.IL6_JAK1Pos.Neonate.Bronchial_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    IL6_JAK1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1Neg.Neonate.Bronchial_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Hillock"))
###Infant Hillock
##Nasal
YoshRef.IL6_JAK1.Infant.Nasal_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
      minorAnnot == "Hillock"))
YoshRef.IL6_JAK1.Infant.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant"))
YoshRef.IL6_JAK1Pos.Infant.Nasal_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    IL6_JAK1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1Neg.Infant.Nasal_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Hillock"))
###Bronchial
YoshRef.IL6_JAK1.Infant.Bronchial_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
     minorAnnot == "Hillock"))
YoshRef.IL6_JAK1.Infant.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant"))

YoshRef.IL6_JAK1Pos.Infant.Bronchial_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    IL6_JAK1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1Neg.Infant.Bronchial_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Hillock"))
###YC Hillock
###Nasal
YoshRef.IL6_JAK1.YC.Nasal_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1.YC.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child"))
YoshRef.IL6_JAK1Pos.YC.Nasal_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    IL6_JAK1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1Neg.YC.Nasal_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Hillock"))
###Bronchial
YoshRef.IL6_JAK1.YC.Bronchial_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1.YC.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child"))
YoshRef.IL6_JAK1Pos.YC.Bronchial_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    IL6_JAK1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1Neg.YC.Bronchial_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Hillock"))
###Child Hillock
###Nasal
YoshRef.IL6_JAK1.Child.Nasal_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1.Child.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child"))
YoshRef.IL6_JAK1Pos.Child.Nasal_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    IL6_JAK1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1Neg.Child.Nasal_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Hillock"))
###Bronchial
YoshRef.IL6_JAK1.Child.Bronchial_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1.Child.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child"))
YoshRef.IL6_JAK1Pos.Child.Bronchial_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    IL6_JAK1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1Neg.Child.Bronchial_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Hillock"))

###Adolescent Hillock
###Nasal
YoshRef.IL6_JAK1.Adolescent.Nasal_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1.Adolescent.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent"))
YoshRef.IL6_JAK1Pos.Adolescent.Nasal_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    IL6_JAK1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1Neg.Adolescent.Nasal_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Hillock"))
###Bronchial
YoshRef.IL6_JAK1.Adolescent.Bronchial_Hillock_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1.Adolescent.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent"))
YoshRef.IL6_JAK1Pos.Adolescent.Bronchial_Hillock <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    IL6_JAK1 > 0 &
    minorAnnot == "Hillock"))
YoshRef.IL6_JAK1Neg.Adolescent.Bronchial_Hillock = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    IL6_JAK1 <= 0 &
    minorAnnot == "Hillock"))

```

```{r IL6_JAK1_MitoticBasal}
adultBaby_Nasal_Bronchia.modScore3@meta.data$sampleLoc_ageDonor = paste(
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Samp.loc, "_",
    adultBaby_Nasal_Bronchia.modScore3@meta.data$Age_donor,
    sep = "")
###Neonate MitoticBasal
###Nasal
YoshRef.IL6_JAK1.Neonate.Nasal_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1.Neonate.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate"))
YoshRef.IL6_JAK1Pos.Neonate.Nasal_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    IL6_JAK1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1Neg.Neonate.Nasal_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Neonate" &
    IL6_JAK1 <= 0 &
    minorAnnot == "MitoticBasal"))
###Bronchial
YoshRef.IL6_JAK1.Neonate.Bronchial_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1.Neonate.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate"))

YoshRef.IL6_JAK1Pos.Neonate.Bronchial_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    IL6_JAK1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1Neg.Neonate.Bronchial_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Neonate" &
    IL6_JAK1 <= 0 &
    minorAnnot == "MitoticBasal"))
###Infant MitoticBasal
##Nasal
YoshRef.IL6_JAK1.Infant.Nasal_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
      minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1.Infant.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Infant"))
YoshRef.IL6_JAK1Pos.Infant.Nasal_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    IL6_JAK1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1Neg.Infant.Nasal_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Infant" &
    IL6_JAK1 <= 0 &
    minorAnnot == "MitoticBasal"))
###Bronchial
YoshRef.IL6_JAK1.Infant.Bronchial_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
     minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1.Infant.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant"))

YoshRef.IL6_JAK1Pos.Infant.Bronchial_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    IL6_JAK1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1Neg.Infant.Bronchial_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Infant" &
    IL6_JAK1 <= 0 &
    minorAnnot == "MitoticBasal"))
###YC MitoticBasal
###Nasal
YoshRef.IL6_JAK1.YC.Nasal_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1.YC.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child"))
YoshRef.IL6_JAK1Pos.YC.Nasal_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    IL6_JAK1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1Neg.YC.Nasal_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Young child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "MitoticBasal"))
###Bronchial
YoshRef.IL6_JAK1.YC.Bronchial_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1.YC.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child"))
YoshRef.IL6_JAK1Pos.YC.Bronchial_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    IL6_JAK1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1Neg.YC.Bronchial_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Young child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "MitoticBasal"))
###Child MitoticBasal
###Nasal
YoshRef.IL6_JAK1.Child.Nasal_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1.Child.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child"))
YoshRef.IL6_JAK1Pos.Child.Nasal_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    IL6_JAK1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1Neg.Child.Nasal_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "MitoticBasal"))
###Bronchial
YoshRef.IL6_JAK1.Child.Bronchial_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1.Child.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child"))
YoshRef.IL6_JAK1Pos.Child.Bronchial_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    IL6_JAK1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1Neg.Child.Bronchial_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Child" &
    IL6_JAK1 <= 0 &
    minorAnnot == "MitoticBasal"))

###Adolescent MitoticBasal
###Nasal
YoshRef.IL6_JAK1.Adolescent.Nasal_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1.Adolescent.Nasal_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent"))
YoshRef.IL6_JAK1Pos.Adolescent.Nasal_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3, 
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    IL6_JAK1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1Neg.Adolescent.Nasal_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Nasal_Adolescent" &
    IL6_JAK1 <= 0 &
    minorAnnot == "MitoticBasal"))
###Bronchial
YoshRef.IL6_JAK1.Adolescent.Bronchial_MitoticBasal_TotalCells <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1.Adolescent.Bronchial_Basal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent"))
YoshRef.IL6_JAK1Pos.Adolescent.Bronchial_MitoticBasal <- subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    IL6_JAK1 > 0 &
    minorAnnot == "MitoticBasal"))
YoshRef.IL6_JAK1Neg.Adolescent.Bronchial_MitoticBasal = subset(adultBaby_Nasal_Bronchia.modScore3,
    subset = (sampleLoc_ageDonor == "Bronchial_Adolescent" &
    IL6_JAK1 <= 0 &
    minorAnnot == "MitoticBasal"))

```

#Nasal Basal Epithelium
```{r Basal_Extraction}

inPath <- "/scratch/sbhattach2/SingleCell/Nino/scRNAseq/outdir_07142022/Refernce/Yoshida"
outPath = inPath
outPath.Epithelial.Yoshida <- file.path(outPath, "YoshRef.control.norm.leiden", "YoshRef.control.norm.leiden.AllSamples")
dir.create(file.path(outPath.Epithelial.Yoshida))
YoshRef.NasalEpithelium <- readRDS(file.path(outPath.Epithelial.Yoshida, "YoshRef.Nasal_Bronchial.Epithelium.res1.rds"))
YoshRef.NasalEpithelium <- subset(YoshRef.NasalEpithelium, subset = Samp.loc == "Nasal")
YoshRef.NasalEpithelium.Basal <- subset(YoshRef.NasalEpithelium, 
    subset = majorAnnot == "Basal")
```
#Nasal Basal KRT15 Expression
```{r Basal_KRT15}
minorCols <- c("Basal1" = "blue1", 
    "Basal2" = "lightblue1", 
    "Hillock" = "deepskyblue3",
    "MitoticBasal" = "sienna")
Idents(YoshRef.NasalEpithelium.Basal) <- "minorAnnot"

png(file.path(outPath.Epithelial.Yoshida,"YoshRef.NasalEpithelium.Basal.majorAnnot.Legend.Size2.png"), width = 11, height = 9, units = "in", res = 600)
p1 <- DimPlot(YoshRef.NasalEpithelium.Basal, 
    reduction = "umap", 
    label = FALSE, 
    repel = TRUE, 
    pt.size = 3, 
    cols = minorCols) + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 24),
    axis.text  = element_text(face="bold", family = "sans", size = 20), 
    legend.text  = element_text(face="bold", family = "sans", size = 22)) +
    guides(color = guide_legend(override.aes = list(size=8)))
#p2 <- DimPlot(CL_vs_CS_woIntegration.combined.Cluster, reduction = "umap", label = TRUE, repel = TRUE)
p1
dev.off()

png(file.path(outPath.Epithelial.Yoshida, 
    "YoshRef.NasalEpithelium.Basal.majorAnnot.noLegend.Size2.png"),
    width = 11, height = 9, units = "in", res = 600)
p1 <- DimPlot(YoshRef.NasalEpithelium.Basal, 
    reduction = "umap", 
    label = FALSE, 
    repel = TRUE, 
    pt.size = 3, 
    cols = minorCols) + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 24),
    axis.text  = element_text(face="bold", family = "sans", size = 20), 
    legend.text  = element_text(face="bold", family = "sans", size = 0)) +
    guides(color = guide_legend(override.aes = list(size = 0)))
#p2 <- DimPlot(CL_vs_CS_woIntegration.combined.Cluster, reduction = "umap", label = TRUE, repel = TRUE)
p1
dev.off()
cols_plot = c("Neonate" = "dodgerblue4", 
            "Infant" = "blue", 
            "Young child" = "cyan", 
            "Child" = "darkolivegreen4",
            "Adolescent" = "forestgreen", 
            "Adult" = "chartreuse")
YoshRef.NasalEpithelium.Basal@meta.data$Age_donor <- factor(
    YoshRef.NasalEpithelium.Basal@meta.data$Age_donor, 
    levels = c(
        "Neonate", 
        "Infant", 
        "Young child", 
        "Child",
        "Adolescent",
        "Adult"))
VPfname <- "YoshRef_Epithelial.VP.IFN.Basal.minorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.NasalEpithelium.Basal, 
    features = "KRT15", 
    group.by = "Age_donor", 
    cols = cols_plot) + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text.y  = element_text(face="bold", family = "sans", size = 25), 
    axis.text.x  = element_text(face="bold", family = "sans", size = 30),
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
```

## Extracting Basal Age Donors
```{r ExtractingBasal}
YoshRef.Nasal.Basal.Neonate <- subset(YoshRef.NasalEpithelium.Basal,
    subset = Age_donor == "Neonate")
YoshRef.Nasal.Basal.Infant <- subset(YoshRef.NasalEpithelium.Basal,
    subset = Age_donor == "Infant")
YoshRef.Nasal.Basal.YC <- subset(YoshRef.NasalEpithelium.Basal,
    subset = Age_donor == "Young child")
YoshRef.Nasal.Basal.Child <- subset(YoshRef.NasalEpithelium.Basal,
    subset = Age_donor == "Child")
YoshRef.Nasal.Basal.Adolescent <- subset(YoshRef.NasalEpithelium.Basal,
    subset = Age_donor == "Adolescent")
YoshRef.Nasal.Basal.Adult <- subset(YoshRef.NasalEpithelium.Basal,
    subset = Age_donor == "Adult")
```

#Nasal Basal KRT15 Expression: Neonate
```{r Basal_KRT15_Neonate}
minorCols <- c("Basal1" = "blue1", 
    "Basal2" = "lightblue1", 
    "Hillock" = "deepskyblue3",
    "MitoticBasal" = "sienna")
Idents(YoshRef.Nasal.Basal.Neonate) <- "minorAnnot"
YoshRef.Nasal.Basal.Neonate@meta.data$minorAnnot <- factor(
    YoshRef.Nasal.Basal.Neonate@meta.data$minorAnnot, 
    levels = c("Basal1", 
        "Basal2", 
        "Hillock", 
        "MitoticBasal"))
png(file.path(outPath.Epithelial.Yoshida,
    "YoshRef.NasalEpithelium.Basal.Neonate.majorAnnot.Legend.Size2.png"), 
    width = 15, height = 12, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Nasal.Basal.Neonate, 
    reduction = "umap", 
    pt.size = 2, 
    features = "KRT15", 
    order = TRUE, 
    label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 24),
    axis.text  = element_text(face="bold", family = "sans", size = 20), 
    legend.text  = element_text(face="bold", family = "sans", size = 22)) +
    guides(color = guide_legend(override.aes = list(size=8)))
#p2 <- DimPlot(CL_vs_CS_woIntegration.combined.Cluster, reduction = "umap", label = TRUE, repel = TRUE)
p1
dev.off()

png(file.path(outPath.Epithelial.Yoshida, 
    "YoshRef.Nasal.Basal.Neonate.majorAnnot.noLegend.Size2.png"),
    width = 15, height = 12, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Nasal.Basal.Neonate, 
    reduction = "umap", 
    pt.size = 2, 
    features = "KRT15", 
    order = TRUE, 
    label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 24),
    axis.text  = element_text(face="bold", family = "sans", size = 20), 
    legend.text  = element_text(face="bold", family = "sans", size = 0)) +
    guides(color = guide_legend(override.aes = list(size = 0)))
#p2 <- DimPlot(CL_vs_CS_woIntegration.combined.Cluster, reduction = "umap", label = TRUE, repel = TRUE)
p1
dev.off()

minorCols <- c("Basal1" = "blue1", 
    "Basal2" = "lightblue1", 
    "Hillock" = "deepskyblue3",
    "MitoticBasal" = "sienna")
Idents(YoshRef.Nasal.Basal.Neonate) <- "minorAnnot"
YoshRef.Nasal.Basal.Neonate@meta.data$minorAnnot <- factor(
    YoshRef.Nasal.Basal.Neonate@meta.data$minorAnnot, 
    levels = c("Basal1", 
        "Basal2", 
        "Hillock", 
        "MitoticBasal"))
VPfname <- "YoshRef_Epithelial.VP.IFN.Basal.Neonate.minorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.Nasal.Basal.Neonate, 
    features = "KRT15", 
    group.by = "minorAnnot", 
    cols = minorCols) + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text.y  = element_text(face="bold", family = "sans", size = 25), 
    axis.text.x  = element_text(face="bold", family = "sans", size = 30),
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
```

#Nasal Basal KRT15 Expression: Infant
```{r Basal_KRT15_Infant}
minorCols <- c("Basal1" = "blue1", 
    "Basal2" = "lightblue1", 
    "Hillock" = "deepskyblue3",
    "MitoticBasal" = "sienna")
Idents(YoshRef.Nasal.Basal.Infant) <- "minorAnnot"
YoshRef.Nasal.Basal.Infant@meta.data$minorAnnot <- factor(
    YoshRef.Nasal.Basal.Infant@meta.data$minorAnnot, 
    levels = c("Basal1", 
        "Basal2", 
        "Hillock", 
        "MitoticBasal"))
png(file.path(outPath.Epithelial.Yoshida,
    "YoshRef.NasalEpithelium.Basal.Infant.majorAnnot.Legend.Size2.png"), 
    width = 15, height = 12, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Nasal.Basal.Infant, 
    reduction = "umap", 
    pt.size = 2, 
    features = "KRT15", 
    order = TRUE, 
    label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 24),
    axis.text  = element_text(face="bold", family = "sans", size = 20), 
    legend.text  = element_text(face="bold", family = "sans", size = 22)) +
    guides(color = guide_legend(override.aes = list(size=8)))
#p2 <- DimPlot(CL_vs_CS_woIntegration.combined.Cluster, reduction = "umap", label = TRUE, repel = TRUE)
p1
dev.off()

png(file.path(outPath.Epithelial.Yoshida, 
    "YoshRef.Nasal.Basal.Infant.majorAnnot.noLegend.Size2.png"),
    width = 15, height = 12, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Nasal.Basal.Infant, 
    reduction = "umap", 
    pt.size = 2, 
    features = "KRT15", 
    order = TRUE, 
    label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 24),
    axis.text  = element_text(face="bold", family = "sans", size = 20), 
    legend.text  = element_text(face="bold", family = "sans", size = 0)) +
    guides(color = guide_legend(override.aes = list(size = 0)))
#p2 <- DimPlot(CL_vs_CS_woIntegration.combined.Cluster, reduction = "umap", label = TRUE, repel = TRUE)
p1
dev.off()

minorCols <- c("Basal1" = "blue1", 
    "Basal2" = "lightblue1", 
    "Hillock" = "deepskyblue3",
    "MitoticBasal" = "sienna")
Idents(YoshRef.Nasal.Basal.Infant) <- "minorAnnot"
YoshRef.Nasal.Basal.Infant@meta.data$minorAnnot <- factor(
    YoshRef.Nasal.Basal.Infant@meta.data$minorAnnot, 
    levels = c("Basal1", 
        "Basal2", 
        "Hillock", 
        "MitoticBasal"))
VPfname <- "YoshRef_Epithelial.VP.IFN.Basal.Infant.minorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.Nasal.Basal.Infant, 
    features = "KRT15", 
    group.by = "minorAnnot", 
    cols = minorCols) + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text.y  = element_text(face="bold", family = "sans", size = 25), 
    axis.text.x  = element_text(face="bold", family = "sans", size = 30),
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
```


#Nasal Basal KRT15 Expression: YC
```{r Basal_KRT15_YC}
minorCols <- c("Basal1" = "blue1", 
    "Basal2" = "lightblue1", 
    "Hillock" = "deepskyblue3",
    "MitoticBasal" = "sienna")
Idents(YoshRef.Nasal.Basal.YC) <- "minorAnnot"
YoshRef.Nasal.Basal.Young child@meta.data$minorAnnot <- factor(
    YoshRef.Nasal.Basal.Young child@meta.data$minorAnnot, 
    levels = c("Basal1", 
        "Basal2", 
        "Hillock", 
        "MitoticBasal"))
png(file.path(outPath.Epithelial.Yoshida,
    "YoshRef.NasalEpithelium.Basal.YC.majorAnnot.Legend.Size2.png"), 
    width = 15, height = 12, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Nasal.Basal.YC, 
    reduction = "umap", 
    pt.size = 2, 
    features = "KRT15", 
    order = TRUE, 
    label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 24),
    axis.text  = element_text(face="bold", family = "sans", size = 20), 
    legend.text  = element_text(face="bold", family = "sans", size = 22)) +
    guides(color = guide_legend(override.aes = list(size=8)))
#p2 <- DimPlot(CL_vs_CS_woIntegration.combined.Cluster, reduction = "umap", label = TRUE, repel = TRUE)
p1
dev.off()

png(file.path(outPath.Epithelial.Yoshida, 
    "YoshRef.Nasal.Basal.YC.majorAnnot.noLegend.Size2.png"),
    width = 15, height = 12, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Nasal.Basal.YC, 
    reduction = "umap", 
    pt.size = 2, 
    features = "KRT15", 
    order = TRUE, 
    label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 24),
    axis.text  = element_text(face="bold", family = "sans", size = 20), 
    legend.text  = element_text(face="bold", family = "sans", size = 0)) +
    guides(color = guide_legend(override.aes = list(size = 0)))
#p2 <- DimPlot(CL_vs_CS_woIntegration.combined.Cluster, reduction = "umap", label = TRUE, repel = TRUE)
p1
dev.off()

minorCols <- c("Basal1" = "blue1", 
    "Basal2" = "lightblue1", 
    "Hillock" = "deepskyblue3",
    "MitoticBasal" = "sienna")
Idents(YoshRef.Nasal.Basal.YC) <- "minorAnnot"
YoshRef.Nasal.Basal.YC@meta.data$minorAnnot <- factor(
    YoshRef.Nasal.Basal.YC@meta.data$minorAnnot, 
    levels = c("Basal1", 
        "Basal2", 
        "Hillock", 
        "MitoticBasal"))
VPfname <- "YoshRef_Epithelial.VP.IFN.Basal.YC.minorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.Nasal.Basal.YC, 
    features = "KRT15", 
    group.by = "minorAnnot", 
    cols = minorCols) + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text.y  = element_text(face="bold", family = "sans", size = 25), 
    axis.text.x  = element_text(face="bold", family = "sans", size = 30),
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
```

#Nasal Basal KRT15 Expression: Child
```{r Basal_KRT15_Child}
minorCols <- c("Basal1" = "blue1", 
    "Basal2" = "lightblue1", 
    "Hillock" = "deepskyblue3",
    "MitoticBasal" = "sienna")
Idents(YoshRef.Nasal.Basal.Child) <- "minorAnnot"
YoshRef.Nasal.Basal.Young child@meta.data$minorAnnot <- factor(
    YoshRef.Nasal.Basal.Young child@meta.data$minorAnnot, 
    levels = c("Basal1", 
        "Basal2", 
        "Hillock", 
        "MitoticBasal"))
png(file.path(outPath.Epithelial.Yoshida,
    "YoshRef.NasalEpithelium.Basal.Child.majorAnnot.Legend.Size2.png"), 
    width = 15, height = 12, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Nasal.Basal.Child, 
    reduction = "umap", 
    pt.size = 2, 
    features = "KRT15", 
    order = TRUE, 
    label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 24),
    axis.text  = element_text(face="bold", family = "sans", size = 20), 
    legend.text  = element_text(face="bold", family = "sans", size = 22)) +
    guides(color = guide_legend(override.aes = list(size=8)))
#p2 <- DimPlot(CL_vs_CS_woIntegration.combined.Cluster, reduction = "umap", label = TRUE, repel = TRUE)
p1
dev.off()

png(file.path(outPath.Epithelial.Yoshida, 
    "YoshRef.Nasal.Basal.Child.majorAnnot.noLegend.Size2.png"),
    width = 15, height = 12, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Nasal.Basal.Child, 
    reduction = "umap", 
    pt.size = 2, 
    features = "KRT15", 
    order = TRUE, 
    label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 24),
    axis.text  = element_text(face="bold", family = "sans", size = 20), 
    legend.text  = element_text(face="bold", family = "sans", size = 0)) +
    guides(color = guide_legend(override.aes = list(size = 0)))
#p2 <- DimPlot(CL_vs_CS_woIntegration.combined.Cluster, reduction = "umap", label = TRUE, repel = TRUE)
p1
dev.off()

minorCols <- c("Basal1" = "blue1", 
    "Basal2" = "lightblue1", 
    "Hillock" = "deepskyblue3",
    "MitoticBasal" = "sienna")
Idents(YoshRef.Nasal.Basal.Child) <- "minorAnnot"
YoshRef.Nasal.Basal.Child@meta.data$minorAnnot <- factor(
    YoshRef.Nasal.Basal.Child@meta.data$minorAnnot, 
    levels = c("Basal1", 
        "Basal2", 
        "Hillock", 
        "MitoticBasal"))
VPfname <- "YoshRef_Epithelial.VP.IFN.Basal.Child.minorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.Nasal.Basal.Child, 
    features = "KRT15", 
    group.by = "minorAnnot", 
    cols = minorCols) + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text.y  = element_text(face="bold", family = "sans", size = 25), 
    axis.text.x  = element_text(face="bold", family = "sans", size = 30),
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
```

#Nasal Basal KRT15 Expression: Adolescent
```{r Basal_KRT15_Adolescent}
minorCols <- c("Basal1" = "blue1", 
    "Basal2" = "lightblue1", 
    "Hillock" = "deepskyblue3",
    "MitoticBasal" = "sienna")
Idents(YoshRef.Nasal.Basal.Adolescent) <- "minorAnnot"
YoshRef.Nasal.Basal.Young Adolescent@meta.data$minorAnnot <- factor(
    YoshRef.Nasal.Basal.Young Adolescent@meta.data$minorAnnot, 
    levels = c("Basal1", 
        "Basal2", 
        "Hillock", 
        "MitoticBasal"))
png(file.path(outPath.Epithelial.Yoshida,
    "YoshRef.NasalEpithelium.Basal.Adolescent.majorAnnot.Legend.Size2.png"), 
    width = 15, height = 12, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Nasal.Basal.Adolescent, 
    reduction = "umap", 
    pt.size = 2, 
    features = "KRT15", 
    order = TRUE, 
    label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 24),
    axis.text  = element_text(face="bold", family = "sans", size = 20), 
    legend.text  = element_text(face="bold", family = "sans", size = 22)) +
    guides(color = guide_legend(override.aes = list(size=8)))
#p2 <- DimPlot(CL_vs_CS_woIntegration.combined.Cluster, reduction = "umap", label = TRUE, repel = TRUE)
p1
dev.off()

png(file.path(outPath.Epithelial.Yoshida, 
    "YoshRef.Nasal.Basal.Adolescent.majorAnnot.noLegend.Size2.png"),
    width = 15, height = 12, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Nasal.Basal.Adolescent, 
    reduction = "umap", 
    pt.size = 2, 
    features = "KRT15", 
    order = TRUE, 
    label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 24),
    axis.text  = element_text(face="bold", family = "sans", size = 20), 
    legend.text  = element_text(face="bold", family = "sans", size = 0)) +
    guides(color = guide_legend(override.aes = list(size = 0)))
#p2 <- DimPlot(CL_vs_CS_woIntegration.combined.Cluster, reduction = "umap", label = TRUE, repel = TRUE)
p1
dev.off()

minorCols <- c("Basal1" = "blue1", 
    "Basal2" = "lightblue1", 
    "Hillock" = "deepskyblue3",
    "MitoticBasal" = "sienna")
Idents(YoshRef.Nasal.Basal.Adolescent) <- "minorAnnot"
YoshRef.Nasal.Basal.Adolescent@meta.data$minorAnnot <- factor(
    YoshRef.Nasal.Basal.Adolescent@meta.data$minorAnnot, 
    levels = c("Basal1", 
        "Basal2", 
        "Hillock", 
        "MitoticBasal"))
VPfname <- "YoshRef_Epithelial.VP.IFN.Basal.Adolescent.minorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.Nasal.Basal.Adolescent, 
    features = "KRT15", 
    group.by = "minorAnnot", 
    cols = minorCols) + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text.y  = element_text(face="bold", family = "sans", size = 25), 
    axis.text.x  = element_text(face="bold", family = "sans", size = 30),
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
```

#Nasal Basal KRT15 Expression: Adult
```{r Basal_KRT15_Adult}
minorCols <- c("Basal1" = "blue1", 
    "Basal2" = "lightblue1", 
    "Hillock" = "deepskyblue3",
    "MitoticBasal" = "sienna")
Idents(YoshRef.Nasal.Basal.Adult) <- "minorAnnot"
YoshRef.Nasal.Basal.Young Adult@meta.data$minorAnnot <- factor(
    YoshRef.Nasal.Basal.Young Adult@meta.data$minorAnnot, 
    levels = c("Basal1", 
        "Basal2", 
        "Hillock", 
        "MitoticBasal"))
png(file.path(outPath.Epithelial.Yoshida,
    "YoshRef.NasalEpithelium.Basal.Adult.majorAnnot.Legend.Size2.png"), 
    width = 15, height = 12, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Nasal.Basal.Adult, 
    reduction = "umap", 
    pt.size = 2, 
    features = "KRT15", 
    order = TRUE, 
    label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 24),
    axis.text  = element_text(face="bold", family = "sans", size = 20), 
    legend.text  = element_text(face="bold", family = "sans", size = 22)) +
    guides(color = guide_legend(override.aes = list(size=8)))
#p2 <- DimPlot(CL_vs_CS_woIntegration.combined.Cluster, reduction = "umap", label = TRUE, repel = TRUE)
p1
dev.off()

png(file.path(outPath.Epithelial.Yoshida, 
    "YoshRef.Nasal.Basal.Adult.majorAnnot.noLegend.Size2.png"),
    width = 15, height = 12, units = "in", res = 600)
p1 <- FeaturePlot(YoshRef.Nasal.Basal.Adult, 
    reduction = "umap", 
    pt.size = 2, 
    features = "KRT15", 
    order = TRUE, 
    label = FALSE) + 
    coord_fixed() + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 24),
    axis.text  = element_text(face="bold", family = "sans", size = 20), 
    legend.text  = element_text(face="bold", family = "sans", size = 0)) +
    guides(color = guide_legend(override.aes = list(size = 0)))
#p2 <- DimPlot(CL_vs_CS_woIntegration.combined.Cluster, reduction = "umap", label = TRUE, repel = TRUE)
p1
dev.off()

minorCols <- c("Basal1" = "blue1", 
    "Basal2" = "lightblue1", 
    "Hillock" = "deepskyblue3",
    "MitoticBasal" = "sienna")
Idents(YoshRef.Nasal.Basal.Adult) <- "minorAnnot"
YoshRef.Nasal.Basal.Adult@meta.data$minorAnnot <- factor(
    YoshRef.Nasal.Basal.Adult@meta.data$minorAnnot, 
    levels = c("Basal1", 
        "Basal2", 
        "Hillock", 
        "MitoticBasal"))
VPfname <- "YoshRef_Epithelial.VP.IFN.Basal.Adult.minorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, VPfname), width = 11, height = 10, units = "in", res = 600)
vln1 <- VlnPlot(YoshRef.Nasal.Basal.Adult, 
    features = "KRT15", 
    group.by = "minorAnnot", 
    cols = minorCols) + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
    axis.text.y  = element_text(face="bold", family = "sans", size = 25), 
    axis.text.x  = element_text(face="bold", family = "sans", size = 30),
    legend.text  = element_text(face="bold", family = "sans", size = 8))
print(vln1)
dev.off()
```
## Dotplot Viz
```{r Basal_minoAnnot_viz}
SeuratObj <- YoshRef.NasalEpithelium.Basal
YoshidaBasalMarkers <- c("KRT5", 
    "KRT15", 
    "DLK2", 
    "DAPL1", 
    "NOTCH1", 
    "MKI67", 
    "TOP2A", 
    "KRT6A", 
    "KRT13")
DefaultAssay(SeuratObj) <- "RNA"
Idents(SeuratObj) <- "minorAnnot"
print("Yoshida_Basal")
#DPfname <- paste(pasfname, ".DP.YoshidaBasalMarkers", ".", Age_Range, ".", res, "_clusters.pdf", sep = "")
#DPfname <- paste(pasfname, ".DP.YoshidaBasalMarkers_clusters.res1.png", sep = "")
DPfname <- "YoshRef_Epithelial.DP.IFN.Basal.Adult.minorAnnot.png"
png(file.path(outPath.Epithelial.Yoshida, DPfname), width = 14, height = 10, units = "in", res = 600)
#YoshidaMarkers <- c(mitoticBasal1, mitoticBasal2)
#DP <- DotPlot(SeuratObj, features = YoshidaMarkers, cols = c("blue", "red"), dot.scale = 8) + RotatedAxis()
DP <- DotPlot(SeuratObj, 
        features = YoshidaBasalMarkers, 
        cols = c("blue", "red"), 
        dot.scale = 25, 
        assay = "RNA", 
        group.by = "minorAnnot") + 
    RotatedAxis() + 
    theme(axis.title = element_text(face="bold", family = "sans", size = 25), 
        axis.text.y  = element_text(face="bold", family = "sans", size = 25), 
        axis.text.x  = element_text(face="bold", family = "sans", size = 30),
        legend.text  = element_text(face="bold", family = "sans", size = 8))
#DP <- DotPlot(SeuratObj, features = YoshidaBasalMarkers, cols = c("blue", "red"), dot.scale = 25, assay = "RNA", group.by = "integrated_snn_res.0.9") + RotatedAxis()
print(DP)
dev.off()
```

```{r SessionInfo}
sessionInfo()
```
